<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=" ffmpeg使用教程 安装 ffmpeg windows 安装 ffmpeg 下载页面：https://ffmpeg.org/download.html\n查看设备列表 Windows查看设备列表 1 ffmpeg -list_devices true -f dshow -i dummy 查看设备列表结果 像我的主机上只有audio相关设备，没有video相关设备\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ffmpeg -list_devices true -f dshow -i dummy ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 0000025ec2e24e80] &#34;OBS Virtual Camera&#34; (video) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_sw_{860BB310-5D01-11D0-BD3B-00A0C911CE86}\\{A3FCE0F5-3493-419F-958A-ABA1250EC20B}&#34; [dshow @ 0000025ec2e24e80] &#34;麦克风 (Realtek(R) Audio)&#34; (audio) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\\wave_{8E507121-E2A9-415D-9EC9-B975D91463F7}&#34; [dshow @ 0000025ec2e24e80] &#34;立体声混音 (Realtek(R) Audio)&#34; (audio) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\\wave_{56D3F882-71A2-4A0B-BF2A-404379259FF8}&#34; [in#0 @ 0000025ec2e1f4c0] Error opening input: Immediate exit requested Error opening input file dummy. 查看视频录制的可选参数 1 ffmpeg -f dshow -list_options true -i video=&#34;OBS Virtual Camera&#34; 查看视频录制的可选参数结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ ffmpeg -f dshow -list_options true -i video=&#34;OBS Virtual Camera&#34; ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 000002a9577d4180] DirectShow video device options (from video devices) [dshow @ 000002a9577d4180] Pin &#34;Video Output&#34; (alternative pin name &#34;Output Pin&#34;) [dshow @ 000002a9577d4180] pixel_format=nv12 min s=1920x1080 fps=30 max s=1920x1080 fps=30 [dshow @ 000002a9577d4180] pixel_format=yuv420p min s=1920x1080 fps=30 max s=1920x1080 fps=30 [dshow @ 000002a9577d4180] pixel_format=yuyv422 min s=1920x1080 fps=30 max s=1920x1080 fps=30 [in#0 @ 000002a9577ce5c0] Error opening input: Immediate exit requested Error opening input file video=OBS Virtual Camera. 查看音频录制的可选参数 1 ffmpeg -f dshow -list_options true -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; 查看音频录制的可选参数结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 $ ffmpeg -f dshow -list_options true -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 000001a1c5a65e00] DirectShow audio only device options (from audio devices) [dshow @ 000001a1c5a65e00] Pin &#34;Capture&#34; (alternative pin name &#34;Capture&#34;) [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 44100 Last message repeated 1 times [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 32000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 32000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 48000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 48000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 96000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 96000 [in#0 @ 000001a1c5a5bd00] Error opening input: Immediate exit requested Error opening input file audio=麦克风 (Realtek(R) Audio). Linux查看设备列表 1 ffmpeg -devices true -f dshow -i dummy 查看设备列表结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ubt@ubt:~/ts/debug$ ffmpeg -devices true -f dshow -i dummy ffmpeg version 4.3.1 Copyright (c) 2000-2020 the FFmpeg developers built with gcc 9 (Ubuntu 9.4.0-1ubuntu1~20.04.2) configuration: --enable-gpl --enable-libass --enable-libfdk-aac --enable-libfreetype --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265 --enable-nonfree libavutil 56. 51.100 / 56. 51.100 libavcodec 58. 91.100 / 58. 91.100 libavformat 58. 45.100 / 58. 45.100 libavdevice 58. 10.100 / 58. 10.100 libavfilter 7. 85.100 / 7. 85.100 libswscale 5. 7.100 / 5. 7.100 libswresample 3. 7.100 / 3. 7.100 libpostproc 55. 7.100 / 55. 7.100 Devices: D. = Demuxing supported .E = Muxing supported -- DE alsa ALSA audio output DE fbdev Linux framebuffer D lavfi Libavfilter virtual input device DE oss OSS (Open Sound System) playback E sdl,sdl2 SDL2 output device DE sndio sndio audio playback DE video4linux2,v4l2 Video4Linux2 output device D x11grab X11 screen capture, using XCB E xv XV (XVideo) output device 屏幕录制 Windows下操作 只录制画面，没有声音 1 ffmpeg -f gdigrab -i desktop -f mp4 out.mp4 播放视频 1 ffplay out.mp4 只录制声音，没有画面 1 ffmpeg -f dshow -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; -f mp3 out.mp3 -y 播放音频 1 ffplay out.mp3 同时录制声音和画面-1 1 ffmpeg -f dshow -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; -f gdigrab -i desktop -f mp4 -y out.mp4 以下是录制命令的说明： -f gdigrab 使用 FFmpeg 内置的 Windows 屏幕录制命令gdigrab，录制对象可为全屏、指定范围和指定程序。MacOS 录屏方法为AVFoundation，Linux 录屏方法为x11grab。\n">
<title>ffmpeg 教程</title>

<link rel='canonical' href='https://ynhugo.github.io/p/ffmpeg-%E6%95%99%E7%A8%8B/'>

<link rel="stylesheet" href="/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css"><meta property='og:title' content="ffmpeg 教程">
<meta property='og:description' content=" ffmpeg使用教程 安装 ffmpeg windows 安装 ffmpeg 下载页面：https://ffmpeg.org/download.html\n查看设备列表 Windows查看设备列表 1 ffmpeg -list_devices true -f dshow -i dummy 查看设备列表结果 像我的主机上只有audio相关设备，没有video相关设备\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ffmpeg -list_devices true -f dshow -i dummy ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 0000025ec2e24e80] &#34;OBS Virtual Camera&#34; (video) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_sw_{860BB310-5D01-11D0-BD3B-00A0C911CE86}\\{A3FCE0F5-3493-419F-958A-ABA1250EC20B}&#34; [dshow @ 0000025ec2e24e80] &#34;麦克风 (Realtek(R) Audio)&#34; (audio) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\\wave_{8E507121-E2A9-415D-9EC9-B975D91463F7}&#34; [dshow @ 0000025ec2e24e80] &#34;立体声混音 (Realtek(R) Audio)&#34; (audio) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\\wave_{56D3F882-71A2-4A0B-BF2A-404379259FF8}&#34; [in#0 @ 0000025ec2e1f4c0] Error opening input: Immediate exit requested Error opening input file dummy. 查看视频录制的可选参数 1 ffmpeg -f dshow -list_options true -i video=&#34;OBS Virtual Camera&#34; 查看视频录制的可选参数结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ ffmpeg -f dshow -list_options true -i video=&#34;OBS Virtual Camera&#34; ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 000002a9577d4180] DirectShow video device options (from video devices) [dshow @ 000002a9577d4180] Pin &#34;Video Output&#34; (alternative pin name &#34;Output Pin&#34;) [dshow @ 000002a9577d4180] pixel_format=nv12 min s=1920x1080 fps=30 max s=1920x1080 fps=30 [dshow @ 000002a9577d4180] pixel_format=yuv420p min s=1920x1080 fps=30 max s=1920x1080 fps=30 [dshow @ 000002a9577d4180] pixel_format=yuyv422 min s=1920x1080 fps=30 max s=1920x1080 fps=30 [in#0 @ 000002a9577ce5c0] Error opening input: Immediate exit requested Error opening input file video=OBS Virtual Camera. 查看音频录制的可选参数 1 ffmpeg -f dshow -list_options true -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; 查看音频录制的可选参数结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 $ ffmpeg -f dshow -list_options true -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 000001a1c5a65e00] DirectShow audio only device options (from audio devices) [dshow @ 000001a1c5a65e00] Pin &#34;Capture&#34; (alternative pin name &#34;Capture&#34;) [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 44100 Last message repeated 1 times [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 32000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 32000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 48000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 48000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 96000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 96000 [in#0 @ 000001a1c5a5bd00] Error opening input: Immediate exit requested Error opening input file audio=麦克风 (Realtek(R) Audio). Linux查看设备列表 1 ffmpeg -devices true -f dshow -i dummy 查看设备列表结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ubt@ubt:~/ts/debug$ ffmpeg -devices true -f dshow -i dummy ffmpeg version 4.3.1 Copyright (c) 2000-2020 the FFmpeg developers built with gcc 9 (Ubuntu 9.4.0-1ubuntu1~20.04.2) configuration: --enable-gpl --enable-libass --enable-libfdk-aac --enable-libfreetype --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265 --enable-nonfree libavutil 56. 51.100 / 56. 51.100 libavcodec 58. 91.100 / 58. 91.100 libavformat 58. 45.100 / 58. 45.100 libavdevice 58. 10.100 / 58. 10.100 libavfilter 7. 85.100 / 7. 85.100 libswscale 5. 7.100 / 5. 7.100 libswresample 3. 7.100 / 3. 7.100 libpostproc 55. 7.100 / 55. 7.100 Devices: D. = Demuxing supported .E = Muxing supported -- DE alsa ALSA audio output DE fbdev Linux framebuffer D lavfi Libavfilter virtual input device DE oss OSS (Open Sound System) playback E sdl,sdl2 SDL2 output device DE sndio sndio audio playback DE video4linux2,v4l2 Video4Linux2 output device D x11grab X11 screen capture, using XCB E xv XV (XVideo) output device 屏幕录制 Windows下操作 只录制画面，没有声音 1 ffmpeg -f gdigrab -i desktop -f mp4 out.mp4 播放视频 1 ffplay out.mp4 只录制声音，没有画面 1 ffmpeg -f dshow -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; -f mp3 out.mp3 -y 播放音频 1 ffplay out.mp3 同时录制声音和画面-1 1 ffmpeg -f dshow -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; -f gdigrab -i desktop -f mp4 -y out.mp4 以下是录制命令的说明： -f gdigrab 使用 FFmpeg 内置的 Windows 屏幕录制命令gdigrab，录制对象可为全屏、指定范围和指定程序。MacOS 录屏方法为AVFoundation，Linux 录屏方法为x11grab。\n">
<meta property='og:url' content='https://ynhugo.github.io/p/ffmpeg-%E6%95%99%E7%A8%8B/'>
<meta property='og:site_name' content='ynhugo'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='tools' /><meta property='article:tag' content='ffmpeg' /><meta property='article:published_time' content='2024-09-14T15:18:12&#43;08:00'/><meta property='article:modified_time' content='2024-09-14T15:18:12&#43;08:00'/>
<meta name="twitter:title" content="ffmpeg 教程">
<meta name="twitter:description" content=" ffmpeg使用教程 安装 ffmpeg windows 安装 ffmpeg 下载页面：https://ffmpeg.org/download.html\n查看设备列表 Windows查看设备列表 1 ffmpeg -list_devices true -f dshow -i dummy 查看设备列表结果 像我的主机上只有audio相关设备，没有video相关设备\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ffmpeg -list_devices true -f dshow -i dummy ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 0000025ec2e24e80] &#34;OBS Virtual Camera&#34; (video) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_sw_{860BB310-5D01-11D0-BD3B-00A0C911CE86}\\{A3FCE0F5-3493-419F-958A-ABA1250EC20B}&#34; [dshow @ 0000025ec2e24e80] &#34;麦克风 (Realtek(R) Audio)&#34; (audio) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\\wave_{8E507121-E2A9-415D-9EC9-B975D91463F7}&#34; [dshow @ 0000025ec2e24e80] &#34;立体声混音 (Realtek(R) Audio)&#34; (audio) [dshow @ 0000025ec2e24e80] Alternative name &#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\\wave_{56D3F882-71A2-4A0B-BF2A-404379259FF8}&#34; [in#0 @ 0000025ec2e1f4c0] Error opening input: Immediate exit requested Error opening input file dummy. 查看视频录制的可选参数 1 ffmpeg -f dshow -list_options true -i video=&#34;OBS Virtual Camera&#34; 查看视频录制的可选参数结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ ffmpeg -f dshow -list_options true -i video=&#34;OBS Virtual Camera&#34; ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 000002a9577d4180] DirectShow video device options (from video devices) [dshow @ 000002a9577d4180] Pin &#34;Video Output&#34; (alternative pin name &#34;Output Pin&#34;) [dshow @ 000002a9577d4180] pixel_format=nv12 min s=1920x1080 fps=30 max s=1920x1080 fps=30 [dshow @ 000002a9577d4180] pixel_format=yuv420p min s=1920x1080 fps=30 max s=1920x1080 fps=30 [dshow @ 000002a9577d4180] pixel_format=yuyv422 min s=1920x1080 fps=30 max s=1920x1080 fps=30 [in#0 @ 000002a9577ce5c0] Error opening input: Immediate exit requested Error opening input file video=OBS Virtual Camera. 查看音频录制的可选参数 1 ffmpeg -f dshow -list_options true -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; 查看音频录制的可选参数结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 $ ffmpeg -f dshow -list_options true -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; ffmpeg version N-112134-g9ef20920ab-20230920 Copyright (c) 2000-2023 the FFmpeg developers built with gcc 13.1.0 (crosstool-NG 1.25.0.196_227d99d) configuration: --prefix=/ffbuild/prefix --pkg-config-flags=--static --pkg-config=pkg-config --cross-prefix=x86_64-w64-mingw32- --arch=x86_64 --target-os=mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags=-DLIBTWOLAME_STATIC --extra-cxxflags= --extra-ldflags=-pthread --extra-ldexeflags= --extra-libs=-lgomp --extra-version=20230920 libavutil 58. 25.100 / 58. 25.100 libavcodec 60. 26.100 / 60. 26.100 libavformat 60. 13.100 / 60. 13.100 libavdevice 60. 2.101 / 60. 2.101 libavfilter 9. 11.100 / 9. 11.100 libswscale 7. 3.100 / 7. 3.100 libswresample 4. 11.100 / 4. 11.100 libpostproc 57. 2.100 / 57. 2.100 [dshow @ 000001a1c5a65e00] DirectShow audio only device options (from audio devices) [dshow @ 000001a1c5a65e00] Pin &#34;Capture&#34; (alternative pin name &#34;Capture&#34;) [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 44100 Last message repeated 1 times [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 32000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 32000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 44100 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 22050 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 11025 [dshow @ 000001a1c5a65e00] ch= 2, bits= 8, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 1, bits= 8, rate= 8000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 48000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 48000 [dshow @ 000001a1c5a65e00] ch= 2, bits=16, rate= 96000 [dshow @ 000001a1c5a65e00] ch= 1, bits=16, rate= 96000 [in#0 @ 000001a1c5a5bd00] Error opening input: Immediate exit requested Error opening input file audio=麦克风 (Realtek(R) Audio). Linux查看设备列表 1 ffmpeg -devices true -f dshow -i dummy 查看设备列表结果 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ubt@ubt:~/ts/debug$ ffmpeg -devices true -f dshow -i dummy ffmpeg version 4.3.1 Copyright (c) 2000-2020 the FFmpeg developers built with gcc 9 (Ubuntu 9.4.0-1ubuntu1~20.04.2) configuration: --enable-gpl --enable-libass --enable-libfdk-aac --enable-libfreetype --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265 --enable-nonfree libavutil 56. 51.100 / 56. 51.100 libavcodec 58. 91.100 / 58. 91.100 libavformat 58. 45.100 / 58. 45.100 libavdevice 58. 10.100 / 58. 10.100 libavfilter 7. 85.100 / 7. 85.100 libswscale 5. 7.100 / 5. 7.100 libswresample 3. 7.100 / 3. 7.100 libpostproc 55. 7.100 / 55. 7.100 Devices: D. = Demuxing supported .E = Muxing supported -- DE alsa ALSA audio output DE fbdev Linux framebuffer D lavfi Libavfilter virtual input device DE oss OSS (Open Sound System) playback E sdl,sdl2 SDL2 output device DE sndio sndio audio playback DE video4linux2,v4l2 Video4Linux2 output device D x11grab X11 screen capture, using XCB E xv XV (XVideo) output device 屏幕录制 Windows下操作 只录制画面，没有声音 1 ffmpeg -f gdigrab -i desktop -f mp4 out.mp4 播放视频 1 ffplay out.mp4 只录制声音，没有画面 1 ffmpeg -f dshow -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; -f mp3 out.mp3 -y 播放音频 1 ffplay out.mp3 同时录制声音和画面-1 1 ffmpeg -f dshow -i audio=&#34;麦克风 (Realtek(R) Audio)&#34; -f gdigrab -i desktop -f mp4 -y out.mp4 以下是录制命令的说明： -f gdigrab 使用 FFmpeg 内置的 Windows 屏幕录制命令gdigrab，录制对象可为全屏、指定范围和指定程序。MacOS 录屏方法为AVFoundation，Linux 录屏方法为x11grab。\n">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_f509edb42ecc0ebd.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🍥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">ynhugo</a></h1>
            <h2 class="site-description">ynhugo.github.io</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com'
                        target="_blank"
                        title="x"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://ynhugo.github.io/en/" >English</option>
                                
                                    <option value="https://ynhugo.github.io/" selected>中文</option>
                                
                                    <option value="https://ynhugo.github.io/ar/" >عربي</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">ffmpeg使用教程</a>
<ul>
<li><a href="#headline-2">安装 ffmpeg</a>
<ul>
<li><a href="#headline-3">windows 安装 ffmpeg</a>
</li>
</ul>
</li>
<li><a href="#headline-4">查看设备列表</a>
<ul>
<li><a href="#headline-5">Windows查看设备列表</a>
<ul>
<li><a href="#headline-6">查看设备列表结果</a>
</li>
<li><a href="#headline-7">查看视频录制的可选参数</a>
<ul>
<li><a href="#headline-8">查看视频录制的可选参数结果</a>
</li>
</ul>
</li>
<li><a href="#headline-9">查看音频录制的可选参数</a>
<ul>
<li><a href="#headline-10">查看音频录制的可选参数结果</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-11">Linux查看设备列表</a>
<ul>
<li><a href="#headline-12">查看设备列表结果</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-13">屏幕录制</a>
<ul>
<li><a href="#headline-14">Windows下操作</a>
<ul>
<li><a href="#headline-15">只录制画面，没有声音</a>
<ul>
<li><a href="#headline-16">播放视频</a>
</li>
</ul>
</li>
<li><a href="#headline-17">只录制声音，没有画面</a>
<ul>
<li><a href="#headline-18">播放音频</a>
</li>
</ul>
</li>
<li><a href="#headline-19">同时录制声音和画面-1</a>
<ul>
<li><a href="#headline-20">以下是录制命令的说明：</a>
</li>
</ul>
</li>
<li><a href="#headline-21">同时录制声音和画面-2</a>
<ul>
<li><a href="#headline-22">以下是录制命令的说明：</a>
</li>
<li><a href="#headline-23">播放视频</a>
</li>
</ul>
</li>
<li><a href="#headline-24">多参数录屏示例</a>
<ul>
<li><a href="#headline-25">命令详解</a>
</li>
<li><a href="#headline-26">播放视频</a>
</li>
</ul>
</li>
<li><a href="#headline-27">ffmpeg对桌面或指定窗口录制视频gdigrab</a>
<ul>
<li><a href="#headline-28">ffmpeg录屏命令gdigrab</a>
<ul>
<li><a href="#headline-29">录制窗口</a>
</li>
<li><a href="#headline-30">整个桌面 6帧/秒</a>
</li>
<li><a href="#headline-31">桌面指定区域 左上角(10,20) 尺寸(640x480)</a>
</li>
<li><a href="#headline-32">录制左半边屏幕</a>
</li>
<li><a href="#headline-33">录制右半边屏幕</a>
</li>
<li><a href="#headline-34">录制左上角占屏幕四分之一的区域</a>
</li>
<li><a href="#headline-35">录制左下角占屏幕四分之一的区域</a>
</li>
<li><a href="#headline-36">录制右上角占屏幕四分之一的区域</a>
</li>
<li><a href="#headline-37">录制右下角占屏幕四分之一的区域</a>
</li>
<li><a href="#headline-38">窗口标题为&#34;Calculator&#34;的窗口 也可设置offset_x/y和video_size</a>
</li>
<li><a href="#headline-39">显示边界框 只是提示作用不会保存进视频中</a>
<ul>
<li><a href="#headline-40">参数详解</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-41">video_size可选视频尺寸</a>
</li>
</ul>
</li>
<li><a href="#headline-42">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-43">Linux下操作</a>
<ul>
<li><a href="#headline-44">录制全屏视频</a>
<ul>
<li><a href="#headline-45">参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-46">录制指定区域视频</a>
<ul>
<li><a href="#headline-47">参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-48">指定录屏时间长度为30秒</a>
<ul>
<li><a href="#headline-49">参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-50">使用alsa录制系统音频</a>
<ul>
<li><a href="#headline-51">参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-52">参考链接</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-53">编辑字幕</a>
<ul>
<li><a href="#headline-54">硬字幕和软字幕的简介</a>
<ul>
<li><a href="#headline-55">硬字幕</a>
</li>
<li><a href="#headline-56">软字幕</a>
</li>
</ul>
</li>
<li><a href="#headline-57">SRT和ASS字幕格式的简介</a>
<ul>
<li><a href="#headline-58">SRT（SubRip Subtitle）</a>
</li>
<li><a href="#headline-59">ASS（Advanced SubStation Alpha）</a>
<ul>
<li><a href="#headline-60">样式</a>
</li>
<li><a href="#headline-61">对齐</a>
</li>
<li><a href="#headline-62">触发器</a>
</li>
<li><a href="#headline-63">动画</a>
</li>
<li><a href="#headline-64">特殊效果</a>
</li>
<li><a href="#headline-65">合的ASS字幕案例</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-66">生成字幕的命令</a>
<ul>
<li><a href="#headline-67">SRT硬字幕命令</a>
<ul>
<li><a href="#headline-68">命令参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-69">ASS硬字幕命令</a>
</li>
<li><a href="#headline-70">SRT和ASS软字幕命令</a>
</li>
<li><a href="#headline-71">SRT可以转ASS命令</a>
</li>
<li><a href="#headline-72">多通道(软)字幕命令</a>
<ul>
<li><a href="#headline-73">准备字幕文件：假设有中文字幕文件为ch.srt，英文字幕文件为en.srt。</a>
<ul>
<li><a href="#headline-74">中文字幕文件：ch.srt</a>
</li>
<li><a href="#headline-75">英文字幕文件：en.srt</a>
</li>
</ul>
</li>
<li><a href="#headline-76">命令</a>
<ul>
<li><a href="#headline-77">参数详解</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-78">多通道(软)字幕，中英字幕实现</a>
<ul>
<li><a href="#headline-79">准备字幕文件：假设有中英文字幕文件为ch_en.srt，英文字幕文件为en.srt。</a>
<ul>
<li><a href="#headline-80">中文字幕文件：ch_en.srt</a>
</li>
<li><a href="#headline-81">英文字幕文件：en.srt</a>
</li>
<li><a href="#headline-82">命令</a>
</li>
<li><a href="#headline-83">最后使用ffprobe查看一下生成文件的内容</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-84">ffmpeg给视频添加字幕(软字幕和硬字幕)</a>
<ul>
<li><a href="#headline-85">软字幕(外挂字幕)</a>
<ul>
<li><a href="#headline-86">先获取视频元数据</a>
<ul>
<li><a href="#headline-87">获取视频元数据结果</a>
<ul>
<li><a href="#headline-88">参数解释</a>
</li>
</ul>
</li>
<li><a href="#headline-89">给无字幕的视频添加软字幕</a>
<ul>
<li><a href="#headline-90">参数详解</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-91">硬字幕(将字幕烧录到视频上)</a>
<ul>
<li><a href="#headline-92">将外部字幕烧录到视频中(例如第二个字幕轨)</a>
</li>
<li><a href="#headline-93">使用mkv容器中的某一个字幕轨烧录到视频上</a>
<ul>
<li><a href="#headline-94">参数解释</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-95">使用 FFmpeg 将 MKV 内封字幕压制为内嵌硬字幕</a>
<ul>
<li><a href="#headline-96">命令参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-97">ffmpeg将带字幕轨道的视频分离成无字幕视频，同时提取字幕文件及替换视频音轨</a>
<ul>
<li><a href="#headline-98">查看视频信息</a>
<ul>
<li><a href="#headline-99">命令</a>
<ul>
<li><a href="#headline-100">查看视频信息结果</a>
</li>
<li><a href="#headline-101">提取字幕文件</a>
</li>
<li><a href="#headline-102">提取无字幕的视频文件</a>
<ul>
<li><a href="#headline-103">命令参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-104">提取音频文件</a>
<ul>
<li><a href="#headline-105">命令参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-106">使用ffmpeg替换视频音轨</a>
<ul>
<li><a href="#headline-107">命令参数详解</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-108">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-109">ffmpeg给视频添加文字</a>
<ul>
<li><a href="#headline-110">上面简单命令的相关参数</a>
</li>
<li><a href="#headline-111">相关命令参数</a>
</li>
<li><a href="#headline-112">前5秒加文字</a>
</li>
<li><a href="#headline-113">5秒后加文字</a>
</li>
<li><a href="#headline-114">第2秒到第5加文字</a>
<ul>
<li><a href="#headline-115">参数详解</a>
</li>
</ul>
</li>
<li><a href="#headline-116">每隔3秒周期显示1秒文字</a>
</li>
<li><a href="#headline-117">间隔1秒依次显示hello和world</a>
<ul>
<li><a href="#headline-118">文字从左向右移动 每帧移动50个像素</a>
<ul>
<li><a href="#headline-119">参数解释</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-120">从下往上移动，每次移动100像素</a>
</li>
<li><a href="#headline-121">打印real time</a>
</li>
<li><a href="#headline-122">将每帧的时间戳以 hh:mm:ss 格式叠加到视频上</a>
</li>
<li><a href="#headline-123">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-124">水印的添加与去除</a>
<ul>
<li><a href="#headline-125">ffmpeg添加水印</a>
<ul>
<li><a href="#headline-126">基本命令</a>
</li>
<li><a href="#headline-127">自定义水印位置 </a>
</li>
<li><a href="#headline-128">透明水印</a>
</li>
</ul>
</li>
<li><a href="#headline-129">fmpeg去除水印</a>
<ul>
<li><a href="#headline-130">示例</a>
</li>
</ul>
</li>
<li><a href="#headline-131">遮盖水印</a>
<ul>
<li><a href="#headline-132">示例</a>
</li>
</ul>
</li>
<li><a href="#headline-133">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-134">如何使用 ffmpeg 剪切和裁剪视频</a>
<ul>
<li><a href="#headline-135">如何使用ffmpeg剪切视频</a>
</li>
<li><a href="#headline-136">使用 ffmpeg 裁剪黑色边框</a>
<ul>
<li><a href="#headline-137">参数解释</a>
</li>
<li><a href="#headline-138">说明</a>
</li>
</ul>
</li>
<li><a href="#headline-139">关于使用 ffmpeg 裁剪视频：</a>
</li>
<li><a href="#headline-140">FFmpeg如何将一个gif嵌入视频指定位置并指定显示时间</a>
<ul>
<li><a href="#headline-141">参数详解</a>
</li>
<li><a href="#headline-142">参考链接</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-143">视频转换成帧图片再转换成视频，如何考虑速率问题</a>
<ul>
<li><a href="#headline-144">脚本</a>
<ul>
<li><a href="#headline-145">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-146">1. 将视频转换为帧图片</a>
</li>
<li><a href="#headline-147">2. 将帧图片重新转换为视频</a>
</li>
<li><a href="#headline-148">注意事项</a>
</li>
</ul>
</li>
<li><a href="#headline-149">把视频拆帧的方法</a>
<ul>
<li><a href="#headline-150">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-151">用ffmpeg从多张图片生成动图</a>
<ul>
<li><a href="#headline-152">使用调色板解决颜色偏差问题</a>
<ul>
<li><a href="#headline-153">首先用以下命令生成调色板</a>
<ul>
<li><a href="#headline-154">如果不是以数字进行命名排列的，可以使用文件列表的方式进行操作</a>
<ul>
<li><a href="#headline-155">将文件添加到列表</a>
<ul>
<li><a href="#headline-156">生成调色板</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-157">然后在生成动图时使用调色板</a>
<ul>
<li><a href="#headline-158">如果是文件列表方式生成的可以按照如下命令操作</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-159">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-160">FFmpeg 视频旋转处理命令</a>
<ul>
<li><a href="#headline-161">ffmpeg -vf</a>
<ul>
<li><a href="#headline-162">顺时针旋转90°</a>
</li>
<li><a href="#headline-163">逆时针旋转90°</a>
</li>
<li><a href="#headline-164">水平翻转</a>
</li>
<li><a href="#headline-165">水平翻转</a>
</li>
<li><a href="#headline-166">逆时针旋转90°后再水平翻转</a>
</li>
<li><a href="#headline-167">顺时针旋转90°后再水平翻转</a>
</li>
<li><a href="#headline-168">旋转180°</a>
</li>
<li><a href="#headline-169">顺时针旋转45°</a>
</li>
</ul>
</li>
<li><a href="#headline-170">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-171">ffmpeg 中打印实时信息</a>
</li>
<li><a href="#headline-172">ffplay常用参数总结</a>
<ul>
<li><a href="#headline-173">指定播放窗口位置和窗口大小</a>
<ul>
<li><a href="#headline-174">首先录制一个时长为3秒，分辨率为960x540的视频</a>
</li>
<li><a href="#headline-175">指定窗口播放位置，根据分辨率长和高的数值进行位置数值的调整</a>
</li>
<li><a href="#headline-176">指定播放窗口的大小</a>
</li>
<li><a href="#headline-177">将指定位置和指定大小的选项结合起来用</a>
</li>
</ul>
</li>
<li><a href="#headline-178">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-179">播放 yuv 格式的视频</a>
<ul>
<li><a href="#headline-180">将yuv文件转换为mp4文件</a>
</li>
<li><a href="#headline-181">直接播放yuv文件</a>
</li>
</ul>
</li>
<li><a href="#headline-182">使用 ffplay 一帧一帧地播放视频</a>
</li>
<li><a href="#headline-183">循环播放视频</a>
<ul>
<li><a href="#headline-184">命令说明</a>
</li>
</ul>
</li>
<li><a href="#headline-185">ffplay倍速播放</a>
<ul>
<li><a href="#headline-186">音频变速播放</a>
</li>
<li><a href="#headline-187">视频变速播放</a>
</li>
<li><a href="#headline-188">音视频同时变速</a>
</li>
<li><a href="#headline-189">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-190">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-191">视频裁剪与拼接命令 ( 裁剪视频命令 | h264 编码的 SPS 和 PPS 数据 | 拼接视频 - 相同编码和相同容器格式的拼接 | 拼接视频 - 不同编码和容器格式的拼接测试</a>
<ul>
<li><a href="#headline-192">拼接视频 - 相同编码和相同容器格式的拼接测试</a>
<ul>
<li><a href="#headline-193">拼接视频命令 - mp4 格式</a>
<ul>
<li><a href="#headline-194">方法一，使用concat demuxer进行视频文件的合并</a>
<ul>
<li><a href="#headline-195">将视频添加到文件列表</a>
</li>
<li><a href="#headline-196">合并视频</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-197">拼接视频命令 - ts 格式</a>
<ul>
<li><a href="#headline-198">将mp4转换为ts</a>
</li>
<li><a href="#headline-199">将ts文件添加为文件列表</a>
</li>
<li><a href="#headline-200">将ts文件进行拼接</a>
</li>
</ul>
</li>
<li><a href="#headline-201">拼接视频命令 - flv 格式</a>
<ul>
<li><a href="#headline-202">将mp4转换为flv</a>
</li>
<li><a href="#headline-203">将flv文件添加为文件列表</a>
</li>
<li><a href="#headline-204">将flv文件进行拼接</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-205">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-206">手把手教你用ffmpeg制作表情包</a>
<ul>
<li><a href="#headline-207">准备视频素材</a>
<ul>
<li><a href="#headline-208">裁剪视频</a>
</li>
<li><a href="#headline-209">添加文字</a>
<ul>
<li><a href="#headline-210">设置文字位置：</a>
</li>
<li><a href="#headline-211">如果有多句话，可以指定时间段进行添加</a>
</li>
</ul>
</li>
<li><a href="#headline-212">缩放视频尺寸</a>
<ul>
<li><a href="#headline-213">加倍速播放视频</a>
</li>
<li><a href="#headline-214">定义帧率 16fps</a>
</li>
<li><a href="#headline-215">慢倍速播放视频</a>
</li>
</ul>
</li>
<li><a href="#headline-216">将视频 MP4 转化为 GIF</a>
</li>
</ul>
</li>
<li><a href="#headline-217">mp4转gif</a>
<ul>
<li><a href="#headline-218">转换命令</a>
</li>
<li><a href="#headline-219">参考链接</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-220">使用ffplay拉流RSTP-海康威视摄像机</a>
</li>
<li><a href="#headline-221">windows环境下实现ffmpeg本地视频进行rtsp推流</a>
<ul>
<li><a href="#headline-222">环境搭建</a>
<ul>
<li><a href="#headline-223">系统环境</a>
</li>
<li><a href="#headline-224">下载rtsp</a>
</li>
<li><a href="#headline-225">下载ffmpeg</a>
</li>
<li><a href="#headline-226">把rtsp和ffmpeg解压到同一个文件夹</a>
</li>
</ul>
</li>
<li><a href="#headline-227">ffmpeg对本地视频进行rtsp推流</a>
<ul>
<li><a href="#headline-228">启动rtsp</a>
</li>
<li><a href="#headline-229">ffpmeg推流本地视频</a>
<ul>
<li><a href="#headline-230">ffpmeg常用参数</a>
</li>
</ul>
</li>
<li><a href="#headline-231">使用vlc验证是否推流成功</a>
</li>
</ul>
</li>
<li><a href="#headline-232">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-233">在Windows操作系统上使用mediamtx和ffmpeg推送录屏视频流</a>
<ul>
<li><a href="#headline-234">搭建启动rtsp server</a>
</li>
<li><a href="#headline-235">推送录屏视频流</a>
</li>
<li><a href="#headline-236">检验</a>
<ul>
<li><a href="#headline-237">获取本机IP</a>
</li>
<li><a href="#headline-238">检测</a>
</li>
</ul>
</li>
<li><a href="#headline-239">参考链接</a>
</li>
</ul>
</li>
<li><a href="#headline-240">RTSP 和 RTMP原理 &amp; 通过ffmpeg实现将本地摄像头推流到RTSP服务器</a>
<ul>
<li><a href="#headline-241">流媒体：RTSP 和 RTMP</a>
<ul>
<li><a href="#headline-242">参考资料</a>
</li>
<li><a href="#headline-243">RTSP 和 RTMP的工作原理</a>
<ul>
<li><a href="#headline-244">RTSP工作原理</a>
<ul>
<li><a href="#headline-245">这里解释一下RTSP中是如何用到UDP和TCP的：</a>
</li>
</ul>
</li>
<li><a href="#headline-246">RTMP工作原理</a>
</li>
</ul>
</li>
<li><a href="#headline-247">RTSP 和 RTMP的优缺点</a>
<ul>
<li><a href="#headline-248">RTSP的优缺点</a>
</li>
</ul>
</li>
<li><a href="#headline-249">RTMP的优缺点</a>
<ul>
<li><a href="#headline-250">RTMP的优点：</a>
</li>
<li><a href="#headline-251">RTMP的缺点：</a>
</li>
</ul>
</li>
<li><a href="#headline-252">RTSP和RTMP的比较</a>
<ul>
<li><a href="#headline-253">RTMP 和 RTSP协议 的区别：</a>
</li>
</ul>
</li>
<li><a href="#headline-254">RTSP和RTMP如何选择</a>
</li>
<li><a href="#headline-255">如何在浏览器上播放RTSP</a>
</li>
</ul>
</li>
<li><a href="#headline-256">ffmpeg将本地摄像头推流到RTSP服务器</a>
<ul>
<li><a href="#headline-257">ffmpeg参考资料</a>
<ul>
<li><a href="#headline-258">ffmpeg将本地摄像头推流到RTSP服务器</a>
</li>
</ul>
</li>
<li><a href="#headline-259">安装ffmpeg和rtsp-simple-server</a>
<ul>
<li><a href="#headline-260">windows安装rtsp-simple-server和ffmpeg</a>
</li>
<li><a href="#headline-261">linux安装rtsp-simple-server和ffmpeg</a>
</li>
</ul>
</li>
<li><a href="#headline-262">将本地摄像头推流到RTSP服务器</a>
<ul>
<li><a href="#headline-263">写客户端：ffmpeg</a>
</li>
<li><a href="#headline-264">服务器端：RTSP服务器</a>
</li>
<li><a href="#headline-265">读客户端：读客户端可以通过两种方式来实现</a>
</li>
<li><a href="#headline-266">存在问题：视频读取时延大</a>
<ul>
<li><a href="#headline-267">可能原因1：视频编码导致延迟高（亲测效果不明显）</a>
</li>
<li><a href="#headline-268">可能原因2：设置ffmpeg参数（亲测效果不明显）</a>
</li>
<li><a href="#headline-269">可能原因3：tcp连接导致延迟高</a>
</li>
<li><a href="#headline-270">原因4：逐帧读取时需要逐帧解码，导致输入和输出速率不匹配导致延迟高（有效 - 抽帧读取）</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-271">参考链接</a>
</li>
</ul>
</li>
</ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ffmpeg-%E6%95%99%E7%A8%8B/">ffmpeg 教程</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 14, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 31 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
ffmpeg使用教程
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
安装 ffmpeg
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<div id="outline-container-headline-3" class="outline-4">
<h4 id="headline-3">
windows 安装 ffmpeg
</h4>
<div id="outline-text-headline-3" class="outline-text-4">
<p>
下载页面：<a href="https://ffmpeg.org/download.html">https://ffmpeg.org/download.html</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
查看设备列表
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<div id="outline-container-headline-5" class="outline-4">
<h4 id="headline-5">
Windows查看设备列表
</h4>
<div id="outline-text-headline-5" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -list_devices <span class="nb">true</span> -f dshow -i dummy</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-6" class="outline-5">
<h5 id="headline-6">
查看设备列表结果
</h5>
<div id="outline-text-headline-6" class="outline-text-5">
<p>
像我的主机上只有audio相关设备，没有video相关设备</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ffmpeg -list_devices <span class="nb">true</span> -f dshow -i dummy
</span></span><span class="line"><span class="cl">ffmpeg version N-112134-g9ef20920ab-20230920 Copyright <span class="o">(</span>c<span class="o">)</span> 2000-2023 the FFmpeg developers
</span></span><span class="line"><span class="cl">  built with gcc 13.1.0 <span class="o">(</span>crosstool-NG 1.25.0.196_227d99d<span class="o">)</span>
</span></span><span class="line"><span class="cl">  configuration: --prefix<span class="o">=</span>/ffbuild/prefix --pkg-config-flags<span class="o">=</span>--static --pkg-config<span class="o">=</span>pkg-config --cross-prefix<span class="o">=</span>x86_64-w64-mingw32- --arch<span class="o">=</span>x86_64 --target-os<span class="o">=</span>mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags<span class="o">=</span>-DLIBTWOLAME_STATIC --extra-cxxflags<span class="o">=</span> --extra-ldflags<span class="o">=</span>-pthread --extra-ldexeflags<span class="o">=</span> --extra-libs<span class="o">=</span>-lgomp --extra-version<span class="o">=</span><span class="m">20230920</span>
</span></span><span class="line"><span class="cl">  libavutil      58. 25.100 / 58. 25.100
</span></span><span class="line"><span class="cl">  libavcodec     60. 26.100 / 60. 26.100
</span></span><span class="line"><span class="cl">  libavformat    60. 13.100 / 60. 13.100
</span></span><span class="line"><span class="cl">  libavdevice    60.  2.101 / 60.  2.101
</span></span><span class="line"><span class="cl">  libavfilter     9. 11.100 /  9. 11.100
</span></span><span class="line"><span class="cl">  libswscale      7.  3.100 /  7.  3.100
</span></span><span class="line"><span class="cl">  libswresample   4. 11.100 /  4. 11.100
</span></span><span class="line"><span class="cl">  libpostproc    57.  2.100 / 57.  2.100
</span></span><span class="line"><span class="cl"><span class="o">[</span>dshow @ 0000025ec2e24e80<span class="o">]</span> <span class="s2">&#34;OBS Virtual Camera&#34;</span> <span class="o">(</span>video<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>dshow @ 0000025ec2e24e80<span class="o">]</span>   Alternative name <span class="s2">&#34;@device_sw_{860BB310-5D01-11D0-BD3B-00A0C911CE86}\{A3FCE0F5-3493-419F-958A-ABA1250EC20B}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>dshow @ 0000025ec2e24e80<span class="o">]</span> <span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span> <span class="o">(</span>audio<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>dshow @ 0000025ec2e24e80<span class="o">]</span>   Alternative name <span class="s2">&#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\wave_{8E507121-E2A9-415D-9EC9-B975D91463F7}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>dshow @ 0000025ec2e24e80<span class="o">]</span> <span class="s2">&#34;立体声混音 (Realtek(R) Audio)&#34;</span> <span class="o">(</span>audio<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>dshow @ 0000025ec2e24e80<span class="o">]</span>   Alternative name <span class="s2">&#34;@device_cm_{33D9A762-90C8-11D0-BD43-00A0C911CE86}\wave_{56D3F882-71A2-4A0B-BF2A-404379259FF8}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>in#0 @ 0000025ec2e1f4c0<span class="o">]</span> Error opening input: Immediate <span class="nb">exit</span> requested
</span></span><span class="line"><span class="cl">Error opening input file dummy.</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-5">
<h5 id="headline-7">
查看视频录制的可选参数
</h5>
<div id="outline-text-headline-7" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -list_options <span class="nb">true</span> -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;OBS Virtual Camera&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-6">
<h6 id="headline-8">
查看视频录制的可选参数结果
</h6>
<div id="outline-text-headline-8" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  $ ffmpeg -f dshow -list_options <span class="nb">true</span> -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;OBS Virtual Camera&#34;</span>
</span></span><span class="line"><span class="cl">  ffmpeg version N-112134-g9ef20920ab-20230920 Copyright <span class="o">(</span>c<span class="o">)</span> 2000-2023 the FFmpeg developers
</span></span><span class="line"><span class="cl">  built with gcc 13.1.0 <span class="o">(</span>crosstool-NG 1.25.0.196_227d99d<span class="o">)</span>
</span></span><span class="line"><span class="cl">  configuration: --prefix<span class="o">=</span>/ffbuild/prefix --pkg-config-flags<span class="o">=</span>--static --pkg-config<span class="o">=</span>pkg-config --cross-prefix<span class="o">=</span>x86_64-w64-mingw32- --arch<span class="o">=</span>x86_64 --target-os<span class="o">=</span>mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags<span class="o">=</span>-DLIBTWOLAME_STATIC --extra-cxxflags<span class="o">=</span> --extra-ldflags<span class="o">=</span>-pthread --extra-ldexeflags<span class="o">=</span> --extra-libs<span class="o">=</span>-lgomp --extra-version<span class="o">=</span><span class="m">20230920</span>
</span></span><span class="line"><span class="cl">  libavutil      58. 25.100 / 58. 25.100
</span></span><span class="line"><span class="cl">  libavcodec     60. 26.100 / 60. 26.100
</span></span><span class="line"><span class="cl">  libavformat    60. 13.100 / 60. 13.100
</span></span><span class="line"><span class="cl">  libavdevice    60.  2.101 / 60.  2.101
</span></span><span class="line"><span class="cl">  libavfilter     9. 11.100 /  9. 11.100
</span></span><span class="line"><span class="cl">  libswscale      7.  3.100 /  7.  3.100
</span></span><span class="line"><span class="cl">  libswresample   4. 11.100 /  4. 11.100
</span></span><span class="line"><span class="cl">  libpostproc    57.  2.100 / 57.  2.100
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000002a9577d4180<span class="o">]</span> DirectShow video device options <span class="o">(</span>from video devices<span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000002a9577d4180<span class="o">]</span>  Pin <span class="s2">&#34;Video Output&#34;</span> <span class="o">(</span>alternative pin name <span class="s2">&#34;Output Pin&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000002a9577d4180<span class="o">]</span>   <span class="nv">pixel_format</span><span class="o">=</span>nv12  min <span class="nv">s</span><span class="o">=</span>1920x1080 <span class="nv">fps</span><span class="o">=</span><span class="m">30</span> max <span class="nv">s</span><span class="o">=</span>1920x1080 <span class="nv">fps</span><span class="o">=</span><span class="m">30</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000002a9577d4180<span class="o">]</span>   <span class="nv">pixel_format</span><span class="o">=</span>yuv420p  min <span class="nv">s</span><span class="o">=</span>1920x1080 <span class="nv">fps</span><span class="o">=</span><span class="m">30</span> max <span class="nv">s</span><span class="o">=</span>1920x1080 <span class="nv">fps</span><span class="o">=</span><span class="m">30</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000002a9577d4180<span class="o">]</span>   <span class="nv">pixel_format</span><span class="o">=</span>yuyv422  min <span class="nv">s</span><span class="o">=</span>1920x1080 <span class="nv">fps</span><span class="o">=</span><span class="m">30</span> max <span class="nv">s</span><span class="o">=</span>1920x1080 <span class="nv">fps</span><span class="o">=</span><span class="m">30</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>in#0 @ 000002a9577ce5c0<span class="o">]</span> Error opening input: Immediate <span class="nb">exit</span> requested
</span></span><span class="line"><span class="cl">  Error opening input file <span class="nv">video</span><span class="o">=</span>OBS Virtual Camera.</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-9" class="outline-5">
<h5 id="headline-9">
查看音频录制的可选参数
</h5>
<div id="outline-text-headline-9" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -list_options <span class="nb">true</span> -i <span class="nv">audio</span><span class="o">=</span><span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-10" class="outline-6">
<h6 id="headline-10">
查看音频录制的可选参数结果
</h6>
<div id="outline-text-headline-10" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  $ ffmpeg -f dshow -list_options <span class="nb">true</span> -i <span class="nv">audio</span><span class="o">=</span><span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span>
</span></span><span class="line"><span class="cl">  ffmpeg version N-112134-g9ef20920ab-20230920 Copyright <span class="o">(</span>c<span class="o">)</span> 2000-2023 the FFmpeg developers
</span></span><span class="line"><span class="cl">  built with gcc 13.1.0 <span class="o">(</span>crosstool-NG 1.25.0.196_227d99d<span class="o">)</span>
</span></span><span class="line"><span class="cl">  configuration: --prefix<span class="o">=</span>/ffbuild/prefix --pkg-config-flags<span class="o">=</span>--static --pkg-config<span class="o">=</span>pkg-config --cross-prefix<span class="o">=</span>x86_64-w64-mingw32- --arch<span class="o">=</span>x86_64 --target-os<span class="o">=</span>mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags<span class="o">=</span>-DLIBTWOLAME_STATIC --extra-cxxflags<span class="o">=</span> --extra-ldflags<span class="o">=</span>-pthread --extra-ldexeflags<span class="o">=</span> --extra-libs<span class="o">=</span>-lgomp --extra-version<span class="o">=</span><span class="m">20230920</span>
</span></span><span class="line"><span class="cl">  libavutil      58. 25.100 / 58. 25.100
</span></span><span class="line"><span class="cl">  libavcodec     60. 26.100 / 60. 26.100
</span></span><span class="line"><span class="cl">  libavformat    60. 13.100 / 60. 13.100
</span></span><span class="line"><span class="cl">  libavdevice    60.  2.101 / 60.  2.101
</span></span><span class="line"><span class="cl">  libavfilter     9. 11.100 /  9. 11.100
</span></span><span class="line"><span class="cl">  libswscale      7.  3.100 /  7.  3.100
</span></span><span class="line"><span class="cl">  libswresample   4. 11.100 /  4. 11.100
</span></span><span class="line"><span class="cl">  libpostproc    57.  2.100 / 57.  2.100
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span> DirectShow audio only device options <span class="o">(</span>from audio devices<span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>  Pin <span class="s2">&#34;Capture&#34;</span> <span class="o">(</span>alternative pin name <span class="s2">&#34;Capture&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">44100</span>
</span></span><span class="line"><span class="cl">  Last message repeated <span class="m">1</span> <span class="nb">times</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">44100</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">32000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">32000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">22050</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">22050</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">11025</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">11025</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span>  <span class="m">8000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span>  <span class="m">8000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span> <span class="m">44100</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span> <span class="m">44100</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span> <span class="m">22050</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span> <span class="m">22050</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span> <span class="m">11025</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span> <span class="m">11025</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span>  <span class="m">8000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span> 8, <span class="nv">rate</span><span class="o">=</span>  <span class="m">8000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">48000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">48000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 2, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">96000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>dshow @ 000001a1c5a65e00<span class="o">]</span>   <span class="nv">ch</span><span class="o">=</span> 1, <span class="nv">bits</span><span class="o">=</span>16, <span class="nv">rate</span><span class="o">=</span> <span class="m">96000</span>
</span></span><span class="line"><span class="cl">  <span class="o">[</span>in#0 @ 000001a1c5a5bd00<span class="o">]</span> Error opening input: Immediate <span class="nb">exit</span> requested
</span></span><span class="line"><span class="cl">  Error opening input file <span class="nv">audio</span><span class="o">=</span>麦克风 <span class="o">(</span>Realtek<span class="o">(</span>R<span class="o">)</span> Audio<span class="o">)</span>.</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-11" class="outline-4">
<h4 id="headline-11">
Linux查看设备列表
</h4>
<div id="outline-text-headline-11" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -devices <span class="nb">true</span> -f dshow -i dummy</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-12" class="outline-5">
<h5 id="headline-12">
查看设备列表结果
</h5>
<div id="outline-text-headline-12" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ubt@ubt:~/ts/debug$ ffmpeg -devices <span class="nb">true</span> -f dshow -i dummy
</span></span><span class="line"><span class="cl">  ffmpeg version 4.3.1 Copyright <span class="o">(</span>c<span class="o">)</span> 2000-2020 the FFmpeg developers
</span></span><span class="line"><span class="cl">  built with gcc <span class="m">9</span> <span class="o">(</span>Ubuntu 9.4.0-1ubuntu1~20.04.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">  configuration: --enable-gpl --enable-libass --enable-libfdk-aac --enable-libfreetype --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265 --enable-nonfree
</span></span><span class="line"><span class="cl">  libavutil      56. 51.100 / 56. 51.100
</span></span><span class="line"><span class="cl">  libavcodec     58. 91.100 / 58. 91.100
</span></span><span class="line"><span class="cl">  libavformat    58. 45.100 / 58. 45.100
</span></span><span class="line"><span class="cl">  libavdevice    58. 10.100 / 58. 10.100
</span></span><span class="line"><span class="cl">  libavfilter     7. 85.100 /  7. 85.100
</span></span><span class="line"><span class="cl">  libswscale      5.  7.100 /  5.  7.100
</span></span><span class="line"><span class="cl">  libswresample   3.  7.100 /  3.  7.100
</span></span><span class="line"><span class="cl">  libpostproc    55.  7.100 / 55.  7.100
</span></span><span class="line"><span class="cl">  Devices:
</span></span><span class="line"><span class="cl">  D. <span class="o">=</span> Demuxing supported
</span></span><span class="line"><span class="cl">  .E <span class="o">=</span> Muxing supported
</span></span><span class="line"><span class="cl">  --
</span></span><span class="line"><span class="cl">  DE alsa            ALSA audio output
</span></span><span class="line"><span class="cl">  DE fbdev           Linux framebuffer
</span></span><span class="line"><span class="cl">  D  lavfi           Libavfilter virtual input device
</span></span><span class="line"><span class="cl">  DE oss             OSS <span class="o">(</span>Open Sound System<span class="o">)</span> playback
</span></span><span class="line"><span class="cl">  E sdl,sdl2        SDL2 output device
</span></span><span class="line"><span class="cl">  DE sndio           sndio audio playback
</span></span><span class="line"><span class="cl">  DE video4linux2,v4l2 Video4Linux2 output device
</span></span><span class="line"><span class="cl">  D  x11grab         X11 screen capture, using XCB
</span></span><span class="line"><span class="cl">  E xv              XV <span class="o">(</span>XVideo<span class="o">)</span> output device</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-13" class="outline-3">
<h3 id="headline-13">
屏幕录制
</h3>
<div id="outline-text-headline-13" class="outline-text-3">
<div id="outline-container-headline-14" class="outline-4">
<h4 id="headline-14">
Windows下操作
</h4>
<div id="outline-text-headline-14" class="outline-text-4">
<div id="outline-container-headline-15" class="outline-5">
<h5 id="headline-15">
只录制画面，没有声音
</h5>
<div id="outline-text-headline-15" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -i desktop -f mp4 out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-16" class="outline-6">
<h6 id="headline-16">
播放视频
</h6>
<div id="outline-text-headline-16" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-17" class="outline-5">
<h5 id="headline-17">
只录制声音，没有画面
</h5>
<div id="outline-text-headline-17" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">audio</span><span class="o">=</span><span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span> -f mp3 out.mp3 -y</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-18" class="outline-6">
<h6 id="headline-18">
播放音频
</h6>
<div id="outline-text-headline-18" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay out.mp3</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-19" class="outline-5">
<h5 id="headline-19">
同时录制声音和画面-1
</h5>
<div id="outline-text-headline-19" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">audio</span><span class="o">=</span><span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span> -f gdigrab -i desktop -f mp4 -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-20" class="outline-6">
<h6 id="headline-20">
以下是录制命令的说明：
</h6>
<div id="outline-text-headline-20" class="outline-text-6">
<p>
-f gdigrab 使用 FFmpeg 内置的 Windows 屏幕录制命令gdigrab，录制对象可为全屏、指定范围和指定程序。MacOS 录屏方法为AVFoundation，Linux 录屏方法为x11grab。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-21" class="outline-5">
<h5 id="headline-21">
同时录制声音和画面-2
</h5>
<div id="outline-text-headline-21" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">audio</span><span class="o">=</span><span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span> -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;OBS Virtual Camera&#34;</span> -f mp4 -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-22" class="outline-6">
<h6 id="headline-22">
以下是录制命令的说明：
</h6>
<div id="outline-text-headline-22" class="outline-text-6">
<p>
&#34;OBS Virtual Camera&#34; 是电脑安装了OBS，然后将OBS的虚拟摄像机打开并设置输出类型为&#34;来源&#34;，输出选择为&#34;显示器采集&#34;，打开了虚拟摄像机后可以再次使用命令查看设备列表可以看到多出一个OBS的虚拟摄像机</p>
</div>
</div>
<div id="outline-container-headline-23" class="outline-6">
<h6 id="headline-23">
播放视频
</h6>
<div id="outline-text-headline-23" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-24" class="outline-5">
<h5 id="headline-24">
多参数录屏示例
</h5>
<div id="outline-text-headline-24" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -t <span class="m">30</span> -framerate <span class="m">15</span> -i desktop -f dshow -i <span class="nv">audio</span><span class="o">=</span><span class="s2">&#34;麦克风 (Realtek(R) Audio)&#34;</span> -b:v 3M -pixel_format yuv420p -vcodec libx264 -s 1366x768 -y test.flv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-25" class="outline-6">
<h6 id="headline-25">
命令详解
</h6>
<div id="outline-text-headline-25" class="outline-text-6">
<p>
-f 指定采集数据方式，一般为dshow 或 gdigrab。gdigrab为系统自带，只能录屏幕，没声音；dshow需装directX，优点是可以指定多个输入，比如下载安装screen capture recorder后，可将其作为dshow模式下的视频输入，可将virtual-audio-capturer作为dshow模式下的音频输入，实现录屏的同时录音。
-i 指定输入，desktop表示gdigrab采集模式输入全部桌面。dshow模式下自己指定，如：-i video=&#34;screen-capture-recorder&#34; -i audio=&#34;virtual-audio-capturer&#34; 
-t 表示录屏时间，缺省则没有录屏时间限制，会一直录，录到手动停止或强制关闭
-framerate 表示帧率。对屏幕录制来说，一般15帧就够了，太大的话会很占资源，cpu占用率、内存、存储空间占用等都会很高。</p>
<ul>
<li>s 表示分辨率</li>
</ul>
<p>-b:v 表示码率，如：-b:v 3M。大一点清楚，但是占资源，自己权衡吧。
-pixel_format 表示像素格式，如yuv420p等，注意选择不同的像素格式会影响资源占用率和视频质量，自己研究吧。
-vcodec 表示编码方式。libx264表示软编码，编码器的库为x264。你可以选择其他的，不同的编码方式也会影响资源占用率和视频质量，自己研究吧。此外可以用硬件加速，硬编解码有3种常见的方式，例如：-vcodec h264_qsv，即使用集显加速；例如： -vcodec h264_nvenc，即使用N卡加速；例如： -vcodec h264_amf，即使用A卡加速。开启硬件加速的情况下可大大降低CPU的占用率
-y 表示覆盖同名文件
test.flv为输出文件名，格式虽然mp4较为常见，但我建议用flv格式，因为如果中间有录制损坏，mp4整个就播放不了了，但flv能。</p>
</div>
</div>
<div id="outline-container-headline-26" class="outline-6">
<h6 id="headline-26">
播放视频
</h6>
<div id="outline-text-headline-26" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay test.flv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-27" class="outline-5">
<h5 id="headline-27">
ffmpeg对桌面或指定窗口录制视频gdigrab
</h5>
<div id="outline-text-headline-27" class="outline-text-5">
<div id="outline-container-headline-28" class="outline-6">
<h6 id="headline-28">
ffmpeg录屏命令gdigrab
</h6>
<div id="outline-text-headline-28" class="outline-text-6">
<p>
基于Win32屏幕捕捉设备，支持对显示器指定区域进行录屏。</p>
<p>
可选2种捕捉方式：</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>-i</th>
<th>desktop</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i</td>
<td>title=window_title</td>
</tr>
</tbody>
</table></div>
<ul>
<li>方式1 捕捉整个桌面或者桌面的某个区域。</li>
<li>方式2 捕捉指定窗口，由窗口标题栏指定窗口。</li>
</ul>
<p>实际上，由于窗口标题可能重名，导致录屏窗口不对。</p>
<div id="outline-container-headline-29" class="outline-7">
<h7 id="headline-29">
录制窗口
</h7>
<div id="outline-text-headline-29" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -t <span class="m">3</span> -i <span class="nv">title</span><span class="o">=</span>企业微信 -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-30" class="outline-7">
<h7 id="headline-30">
整个桌面 6帧/秒
</h7>
<div id="outline-text-headline-30" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -framerate <span class="m">6</span> -i desktop out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-31" class="outline-7">
<h7 id="headline-31">
桌面指定区域 左上角(10,20) 尺寸(640x480)
</h7>
<div id="outline-text-headline-31" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -f gdigrab -framerate <span class="m">6</span> -offset_x <span class="m">10</span> -offset_y <span class="m">20</span> -video_size vga -i desktop out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-32" class="outline-7">
<h7 id="headline-32">
录制左半边屏幕
</h7>
<div id="outline-text-headline-32" class="outline-text-7">
<p>
录制时长为3秒</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -t <span class="m">3</span> -offset_x <span class="m">0</span> -offset_y <span class="m">0</span> -video_size 960x1080 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-33" class="outline-7">
<h7 id="headline-33">
录制右半边屏幕
</h7>
<div id="outline-text-headline-33" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -t <span class="m">3</span> -offset_x <span class="m">960</span> -offset_y <span class="m">0</span> -video_size 960x1080 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-34" class="outline-7">
<h7 id="headline-34">
录制左上角占屏幕四分之一的区域
</h7>
<div id="outline-text-headline-34" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -t <span class="m">3</span> -offset_x <span class="m">0</span> -offset_y <span class="m">0</span> -video_size 960x540 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-35" class="outline-7">
<h7 id="headline-35">
录制左下角占屏幕四分之一的区域
</h7>
<div id="outline-text-headline-35" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -t <span class="m">3</span> -offset_x <span class="m">0</span> -offset_y <span class="m">540</span> -video_size 960x540 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-36" class="outline-7">
<h7 id="headline-36">
录制右上角占屏幕四分之一的区域
</h7>
<div id="outline-text-headline-36" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -t <span class="m">3</span> -offset_x <span class="m">960</span> -offset_y <span class="m">0</span> -video_size 960x540 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-37" class="outline-7">
<h7 id="headline-37">
录制右下角占屏幕四分之一的区域
</h7>
<div id="outline-text-headline-37" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -t <span class="m">3</span> -offset_x <span class="m">960</span> -offset_y <span class="m">540</span> -video_size 960x540 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-38" class="outline-7">
<h7 id="headline-38">
窗口标题为&#34;Calculator&#34;的窗口 也可设置offset_x/y和video_size
</h7>
<div id="outline-text-headline-38" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -framerate <span class="m">6</span> -i <span class="nv">title</span><span class="o">=</span>Calculator out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-39" class="outline-7">
<h7 id="headline-39">
显示边界框 只是提示作用不会保存进视频中
</h7>
<div id="outline-text-headline-39" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -show_region <span class="m">1</span> -framerate <span class="m">6</span> -video_size cif -offset_x <span class="m">10</span> -offset_y <span class="m">20</span> -i desktop out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-40" class="outline-8">
<h8 id="headline-40">
参数详解
</h8>
<div id="outline-text-headline-40" class="outline-text-8">
<ul>
<li>framerate
  录屏帧率。默认值ntsc, 一般是30000/1001.</li>
</ul>
<p>除了ffmpeg设置默认参数之外，gdigrab可设置下列参数项：</p>
<ul>
<li>show_region
  录屏时是否在屏幕上显示边界框。用于检查录屏区域，防止区域错误。
  1显示，0不显示。</li>
<li>draw_mouse
  是否包含鼠标。0=不包含，1=包含。默认值1，视频含有鼠标。</li>
<li>video_size
  视频尺寸，默认整个桌面或整个窗口。
  自定义尺寸，如1280x720。或者，下面的列表之一。</li>
<li>offset_x
  和video_size一起使用，指定左上角位置。
  原点为桌面或指定窗口的左上角。</li>
<li>offset_y
  同上。</li>
</ul>
<p>不使用video_size/offset_x/offset_y，则对整个桌面或程序窗口录屏，使用则只对桌面或窗口的部分区域进行录屏。</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-41" class="outline-6">
<h6 id="headline-41">
video_size可选视频尺寸
</h6>
<div id="outline-text-headline-41" class="outline-text-6">
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ntsc</th>
<th>720x480</th>
</tr>
</thead>
<tbody>
<tr>
<td>pal</td>
<td>720x576</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qntsc</td>
<td>352x240</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qpal</td>
<td>352x288</td>
</tr>
</tbody>
<tbody>
<tr>
<td>sntsc</td>
<td>640x480</td>
</tr>
</tbody>
<tbody>
<tr>
<td>spal</td>
<td>768x576</td>
</tr>
</tbody>
<tbody>
<tr>
<td>film</td>
<td>352x240</td>
</tr>
</tbody>
<tbody>
<tr>
<td>ntsc-film</td>
<td>352x240</td>
</tr>
</tbody>
<tbody>
<tr>
<td>sqcif</td>
<td>128x96</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qcif</td>
<td>176x144</td>
</tr>
</tbody>
<tbody>
<tr>
<td>cif</td>
<td>352x288</td>
</tr>
</tbody>
<tbody>
<tr>
<td>4cif</td>
<td>704x576</td>
</tr>
</tbody>
<tbody>
<tr>
<td>16cif</td>
<td>1408x1152</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qqvga</td>
<td>160x120</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qvga</td>
<td>320x240</td>
</tr>
</tbody>
<tbody>
<tr>
<td>vga</td>
<td>640x480</td>
</tr>
</tbody>
<tbody>
<tr>
<td>svga</td>
<td>800x600</td>
</tr>
</tbody>
<tbody>
<tr>
<td>xga</td>
<td>1024x768</td>
</tr>
</tbody>
<tbody>
<tr>
<td>uxga</td>
<td>1600x1200</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qxga</td>
<td>2048x1536</td>
</tr>
</tbody>
<tbody>
<tr>
<td>sxga</td>
<td>1280x1024</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qsxga</td>
<td>2560x2048</td>
</tr>
</tbody>
<tbody>
<tr>
<td>hsxga</td>
<td>5120x4096</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wvga</td>
<td>852x480</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wxga</td>
<td>1366x768</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wsxga</td>
<td>1600x1024</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wuxga</td>
<td>1920x1200</td>
</tr>
</tbody>
<tbody>
<tr>
<td>woxga</td>
<td>2560x1600</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wqsxga</td>
<td>3200x2048</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wquxga</td>
<td>3840x2400</td>
</tr>
</tbody>
<tbody>
<tr>
<td>whsxga</td>
<td>6400x4096</td>
</tr>
</tbody>
<tbody>
<tr>
<td>whuxga</td>
<td>7680x4800</td>
</tr>
</tbody>
<tbody>
<tr>
<td>cga</td>
<td>320x200</td>
</tr>
</tbody>
<tbody>
<tr>
<td>ega</td>
<td>640x350</td>
</tr>
</tbody>
<tbody>
<tr>
<td>hd480</td>
<td>852x480</td>
</tr>
</tbody>
<tbody>
<tr>
<td>hd720</td>
<td>1280x720</td>
</tr>
</tbody>
<tbody>
<tr>
<td>hd1080</td>
<td>1920x1080</td>
</tr>
</tbody>
<tbody>
<tr>
<td>2k</td>
<td>2048x1080</td>
</tr>
</tbody>
<tbody>
<tr>
<td>2kflat</td>
<td>1998x1080</td>
</tr>
</tbody>
<tbody>
<tr>
<td>2kscope</td>
<td>2048x858</td>
</tr>
</tbody>
<tbody>
<tr>
<td>4k</td>
<td>4096x2160</td>
</tr>
</tbody>
<tbody>
<tr>
<td>4kflat</td>
<td>3996x2160</td>
</tr>
</tbody>
<tbody>
<tr>
<td>4kscope</td>
<td>4096x1716</td>
</tr>
</tbody>
<tbody>
<tr>
<td>nhd</td>
<td>640x360</td>
</tr>
</tbody>
<tbody>
<tr>
<td>hqvga</td>
<td>240x160</td>
</tr>
</tbody>
<tbody>
<tr>
<td>wqvga</td>
<td>400x240</td>
</tr>
</tbody>
<tbody>
<tr>
<td>fwqvga</td>
<td>432x240</td>
</tr>
</tbody>
<tbody>
<tr>
<td>hvga</td>
<td>480x320</td>
</tr>
</tbody>
<tbody>
<tr>
<td>qhd</td>
<td>960x540</td>
</tr>
</tbody>
<tbody>
<tr>
<td>2kdci</td>
<td>2048x1080</td>
</tr>
</tbody>
<tbody>
<tr>
<td>4kdci</td>
<td>4096x2160</td>
</tr>
</tbody>
<tbody>
<tr>
<td>uhd2160</td>
<td>3840x2160</td>
</tr>
</tbody>
<tbody>
<tr>
<td>uhd4320</td>
<td>7680x4320</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-42" class="outline-5">
<h5 id="headline-42">
参考链接
</h5>
<div id="outline-text-headline-42" class="outline-text-5">
<p>
<a href="https://blog.csdn.net/awangdea99/article/details/114555743">FFmpeg屏幕录制</a></p>
<p>
<a href="https://www.zhihu.com/zvideo/1240037588020662272">15-ffmpeg常用 命令视频录制</a></p>
<p>
<a href="https://zhuanlan.zhihu.com/p/580624916">3 分钟入门 FFmpeg，抛弃又贵又难用的录屏软件</a></p>
<p>
<a href="https://www.bilibili.com/read/cv20197318/">ffmpeg对桌面或指定窗口录制视频gdigrab</a></p>
<p>
<a href="https://www.cnblogs.com/yongfengnice/p/7156952.html">ffmpeg时间有关的操作</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-43" class="outline-4">
<h4 id="headline-43">
Linux下操作
</h4>
<div id="outline-text-headline-43" class="outline-text-4">
<div id="outline-container-headline-44" class="outline-5">
<h5 id="headline-44">
录制全屏视频
</h5>
<div id="outline-text-headline-44" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f x11grab -r <span class="m">25</span> -s <span class="k">$(</span>xwininfo -root <span class="p">|</span> grep -Eo <span class="s2">&#34;[0-9]{3,5}x[0-9]{3,5}&#34;</span><span class="k">)</span> -i :0.0 -t <span class="m">3</span> -vcodec libx264 -preset ultrafast -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-45" class="outline-6">
<h6 id="headline-45">
参数详解
</h6>
<div id="outline-text-headline-45" class="outline-text-6">
<p>
这条 ffmpeg 命令用于从 X11 屏幕录制视频，并将结果保存为 output.mp4。以下是对每个参数的详细解释：</p>
<ol>
<li>ffmpeg: 调用 FFmpeg 工具进行视频和音频处理。</li>
<li>-f x11grab: 指定输入格式为 X11 屏幕捕捉（x11grab）。这表示要录制 X11 显示器上的屏幕内容。</li>
<li>-r 25: 设置视频的帧率为 25 帧每秒（fps）。这决定了录制视频的流畅度。</li>
<li>
<p>-s $(xwininfo -root | grep -Eo &#34;[0-9]{3,5}x[0-9]{3,5}&#34;): 设置输出视频的分辨率为当前屏幕的分辨率。</p>
<ul>
<li>xwininfo -root: 获取根窗口（即整个屏幕）的信息。</li>
<li>grep -Eo &#34;[0-9]{3,5}x[0-9]{3,5}&#34;: 使用正则表达式从 xwininfo 的输出中提取屏幕分辨率，格式为 宽度x高度。[0-9]{3,5} 匹配 3 到 5 位的数字，x 是分隔符，后面的 [0-9]{3,5} 匹配高度部分。</li>
</ul>
</li>
<li>-i :0.0: 指定 X11 屏幕的显示和显示编号为 :0.0。通常表示第一个显示器的第一个屏幕。</li>
<li>-t 3: 设置录制时长为 3 秒。-t 指定录制的时间长度。</li>
<li>-vcodec libx264: 指定视频编码器为 libx264，即使用 H.264 编码。H.264 是一种高效的视频编码格式。</li>
<li>-preset ultrafast: 设置编码预设为 ultrafast，优先考虑编码速度，而非压缩效率。这将生成较大的文件，但编码速度最快。</li>
<li>-y: 自动确认覆盖输出文件。如果 output.mp4 已经存在，FFmpeg 会自动覆盖它，而不会提示用户确认。</li>
<li>output.mp4: 指定输出文件名为 output.mp4。mp4 是一种广泛使用的视频文件格式，能够容纳视频和音频流。</li>
</ol>
<p>总的来说，这条命令从 X11 屏幕录制 3 秒钟的视频，使用 H.264 编码，保存为 output.mp4。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-46" class="outline-5">
<h5 id="headline-46">
录制指定区域视频
</h5>
<div id="outline-text-headline-46" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f x11grab -r <span class="m">25</span> -s 800x600 -i :0.0+100,200 -vcodec libx264 -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-47" class="outline-6">
<h6 id="headline-47">
参数详解
</h6>
<div id="outline-text-headline-47" class="outline-text-6">
<p>
这条 ffmpeg 命令用于从 X11 屏幕录制指定区域的视频，并将结果保存为 output.mp4。下面是对每个参数的解释：</p>
<ol>
<li>ffmpeg: 调用 FFmpeg 工具进行视频处理。</li>
<li>-f x11grab: 指定输入格式为 X11 屏幕捕捉，表示要录制 X11 显示器上的屏幕内容。</li>
<li>-r 25: 设置视频的帧率为 25 帧每秒（fps），决定了录制视频的流畅度。</li>
<li>-s 800x600: 设置录制视频的分辨率为 800x600 像素。这里是指定的区域大小。</li>
<li>-i :0.0+100,200: 指定录制的输入源为 X11 屏幕 :0.0，并且设置录制区域的起始位置为屏幕上的 (100, 200) 像素点。这意味着视频录制将从屏幕的 (100, 200) 位置开始，覆盖 800x600 像素的区域。</li>
<li>-vcodec libx264: 指定视频编码器为 libx264，即使用 H.264 编码。这种编码格式在压缩效率和视频质量之间提供了很好的平衡。</li>
<li>output.mp4: 指定输出文件名为 output.mp4。这是最终保存录制内容的视频文件名。</li>
</ol>
<p>总的来说，这条命令从 X11 屏幕的 (100, 200) 位置开始录制一个 800x600 像素的区域，录制的帧率为 25 fps，使用 H.264 编码，保存为 `output.mp4`。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-48" class="outline-5">
<h5 id="headline-48">
指定录屏时间长度为30秒
</h5>
<div id="outline-text-headline-48" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f x11grab -r <span class="m">25</span> -s <span class="k">$(</span>xwininfo -root <span class="p">|</span> grep -Eo <span class="s2">&#34;[0-9]{3,5}x[0-9]{3,5}&#34;</span><span class="k">)</span> -i :0.0 -t <span class="m">30</span> -preset ultrafast -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-49" class="outline-6">
<h6 id="headline-49">
参数详解
</h6>
<div id="outline-text-headline-49" class="outline-text-6">
<p>
这条 `ffmpeg` 命令用于从 X11 屏幕录制指定时长的视频，并将结果保存为 `output.mp4`。下面是对每个参数的详细解释：</p>
<ol>
<li>ffmpeg: 调用 FFmpeg 工具来处理视频和音频。</li>
<li>-f x11grab: 指定输入格式为 X11 屏幕捕捉，表示要录制 X11 显示器上的屏幕内容。</li>
<li>-r 25: 设置视频的帧率为 25 帧每秒（fps），决定了录制视频的流畅度。</li>
<li>
<p>-s $(xwininfo -root | grep -Eo &#34;[0-9]{3,5}x[0-9]{3,5}&#34;): 设置录制视频的分辨率为当前屏幕的分辨率。</p>
<ul>
<li>xwininfo -root: 获取根窗口（即整个屏幕）的信息。</li>
<li>grep -Eo &#34;[0-9]{3,5}x[0-9]{3,5}&#34;: 从 xwininfo 输出中提取屏幕的分辨率，格式为 宽度x高度。正则表达式 [0-9]{3,5} 匹配 3 到 5 位的数字，x 作为分隔符，后面 [0-9]{3,5} 匹配高度部分。这样做可以确保 FFmpeg 使用当前屏幕的完整分辨率进行录制。</li>
</ul>
</li>
<li>-i :0.0: 指定 X11 屏幕的显示和显示编号为 :0.0。通常表示第一个显示器的第一个屏幕。</li>
<li>-t 30: 设置录制时长为 30 秒。-t 用来指定录制的时间长度。</li>
<li>-preset ultrafast: 设置视频编码的预设为 ultrafast。这会使编码过程尽可能快，但会生成较大的文件，因为编码压缩率较低。</li>
<li>-y: 自动确认覆盖输出文件。如果 output.mp4 已经存在，FFmpeg 会自动覆盖它，而不需要用户确认。</li>
<li>output.mp4: 指定输出文件名为 output.mp4。这是录制的视频将被保存的文件名。</li>
</ol>
<p>总的来说，这条命令从 X11 屏幕录制 30 秒钟的视频，使用当前屏幕的完整分辨率，帧率为 25 fps，使用 H.264 编码，并将结果保存为 `output.mp4`。编码设置为 `ultrafast`，优先考虑编码速度。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-50" class="outline-5">
<h5 id="headline-50">
使用alsa录制系统音频
</h5>
<div id="outline-text-headline-50" class="outline-text-5">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg -f alsa -i default -f x11grab -r 25 -s $(xdpyinfo | grep &#39;dimensions:&#39;|awk &#39;{print $2;}&#39;) -i :0.0 -c:v libx264 -preset ultrafast -c:a aac -tune fastdecode -y output.mkv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-51" class="outline-6">
<h6 id="headline-51">
参数详解
</h6>
<div id="outline-text-headline-51" class="outline-text-6">
<p>
这条 `ffmpeg` 命令用于同时录制音频和视频，并将结果保存为 `output.mkv`。以下是对每个参数的详细解释：</p>
<ol>
<li>ffmpeg: 调用 FFmpeg 工具来处理视频和音频。</li>
<li>-f alsa -i default: 指定音频输入格式为 ALSA（Advanced Linux Sound Architecture），并选择默认音频设备作为输入。-f alsa 指定了音频输入格式为 ALSA，-i default 表示使用系统默认的音频输入设备。</li>
<li>
<p>-f x11grab -r 25 -s $(xdpyinfo | grep &#39;dimensions:&#39; | awk &#39;{print $2;}&#39;) -i :0.0: 指定视频输入格式为 X11 屏幕捕捉。</p>
<ul>
<li>-f x11grab: 指定视频输入格式为 X11 屏幕捕捉。</li>
<li>-r 25: 设置视频的帧率为 25 帧每秒（fps）。</li>
<li>-s $(xdpyinfo | grep &#39;dimensions:&#39; | awk &#39;{print $2;}&#39;): 设置录制视频的分辨率。xdpyinfo 是一个 X11 工具，用于获取 X11 显示的相关信息。grep &#39;dimensions:&#39; 提取包含屏幕分辨率的行，awk &#39;{print $2;}&#39; 从这一行中提取分辨率信息（如 1920x1080）。</li>
<li>-i :0.0: 指定 X11 屏幕的显示和显示编号为 :0.0，通常表示第一个显示器的第一个屏幕。</li>
</ul>
</li>
<li>-c:v libx264: 指定视频编码器为 libx264，这是用于 H.264 视频编码的 FFmpeg 编码器。</li>
<li>-preset ultrafast: 设置视频编码的预设为 ultrafast，使编码过程尽可能快，但会生成较大的文件，因为编码压缩率较低。</li>
<li>-c:a aac: 指定音频编码器为 aac，用于音频压缩和编码，常用于高效的音频压缩。</li>
<li>-tune fastdecode: 指定编码器的调整参数为 fastdecode，优化编码设置以加快解码速度。这通常有助于提高播放设备或软件的解码效率。</li>
<li>output.mkv: 指定输出文件名为 output.mkv。这是录制的音视频将被保存的文件名，使用 MKV 格式。</li>
</ol>
<p>总结来说，这条命令将从默认的音频设备和 X11 屏幕录制视频和音频。视频将以 25 fps 录制，使用 `libx264` 编码器和 `ultrafast` 预设，音频将使用 `aac` 编码器，并且优化了解码速度。录制的结果将保存为 `output.mkv` 文件。</p>
<p>
这些命令可以根据需要进行修改，例如更改输出文件名或调整录屏分辨率和帧速率。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-52" class="outline-5">
<h5 id="headline-52">
参考链接
</h5>
<div id="outline-text-headline-52" class="outline-text-5">
<p>
<a href="https://avmedia.0voice.com/?id=43422">linux ffmpeg录屏命令实例</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-53" class="outline-3">
<h3 id="headline-53">
编辑字幕
</h3>
<div id="outline-text-headline-53" class="outline-text-3">
<div id="outline-container-headline-54" class="outline-4">
<h4 id="headline-54">
硬字幕和软字幕的简介
</h4>
<div id="outline-text-headline-54" class="outline-text-4">
<div id="outline-container-headline-55" class="outline-5">
<h5 id="headline-55">
硬字幕
</h5>
<div id="outline-text-headline-55" class="outline-text-5">
<p>
将字幕渲染到视频的纹理上，然后将其编码成独立于视频格式的一个完整的视频。硬字幕不能更改或删除，因为它们与视频（通道）是一个整体。</p>
</div>
</div>
<div id="outline-container-headline-56" class="outline-5">
<h5 id="headline-56">
软字幕
</h5>
<div id="outline-text-headline-56" class="outline-text-5">
<p>
在播放视频时实时渲染和读取。软字幕可以在播放过程中随时添加或删除。软字幕比硬字幕更加灵活，因为它们可以随时进行修改，但它们也需要高性能的播放器支持。</p>
<p>
字幕单独生成一个字幕通道，与视频、音频一样，如以下Stream #0:2：</p>
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  Stream #0:0[0x1](und): Video: h264 (High) (avc1 / 0x31637661), yuv420p(progressive), 852x480, 397 kb/s, 25 fps, 25 tbr, 12800 tbn (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : VideoHandler
</span></span><span class="line"><span class="cl">      vendor_id       : [0][0][0][0]
</span></span><span class="line"><span class="cl">  Stream #0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 48000 Hz, stereo, fltp, 127 kb/s (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : SoundHandler
</span></span><span class="line"><span class="cl">      vendor_id       : [0][0][0][0]
</span></span><span class="line"><span class="cl">  Stream #0:2[0x3](eng): Subtitle: mov_text (tx3g / 0x67337874), 0 kb/s (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : SubtitleHandler</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-57" class="outline-4">
<h4 id="headline-57">
SRT和ASS字幕格式的简介
</h4>
<div id="outline-text-headline-57" class="outline-text-4">
<div id="outline-container-headline-58" class="outline-5">
<h5 id="headline-58">
SRT（SubRip Subtitle）
</h5>
<div id="outline-text-headline-58" class="outline-text-5">
<p>
是一种简单的字幕格式，主要由时间戳和文本组成。它通常用于简单的字幕文件，如电影聚会之类。SRT字幕格式的参数如下：</p>
<ul>
<li>标题的计数器/索引</li>
<li>START和END：字幕开始和字幕结束的时间戳，格式为 “小时：分钟：毫秒”。</li>
<li>TEXT：在此时间戳范围内显示的字幕文本</li>
<li>一行空白表示一个结束</li>
</ul>
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">00:00:0,000 --&gt; 00:00:2,000
</span></span><span class="line"><span class="cl">这是0到2秒显示的字幕
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">00:00:2,000 --&gt; 00:00:4,000 
</span></span><span class="line"><span class="cl">这是2到4秒显示的字幕
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3
</span></span><span class="line"><span class="cl">00:00:4,000 --&gt; 00:00:7,000
</span></span><span class="line"><span class="cl">这是4到7秒显示的字幕</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-59" class="outline-5">
<h5 id="headline-59">
ASS（Advanced SubStation Alpha）
</h5>
<div id="outline-text-headline-59" class="outline-text-5">
<p>
是一个高级的字幕格式，它可以支持更多的样式和控制，比如，更改颜色、字体和大小，还可以通过几何变换来控制字幕的位置。ASS字幕格式包含以下参数：</p>
<div id="outline-container-headline-60" class="outline-6">
<h6 id="headline-60">
样式
</h6>
<div id="outline-text-headline-60" class="outline-text-6">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Style: 序号, 字体名称, 字号, 颜色, 阴影, 边框, 描边, 阴影, 抗锯齿, 倾斜度, weight, underline
</span></span><span class="line"><span class="cl">例子：Style: Top, Microsoft YaHei,40,&amp;H00F5FF&amp;,-1,2,0,0,1,0,0</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-61" class="outline-6">
<h6 id="headline-61">
对齐
</h6>
<div id="outline-text-headline-61" class="outline-text-6">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Dialogue: 0,0:00:03.42,0:00:04.91,Top,,0,0,0,,{\an6}本字幕居右上</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-62" class="outline-6">
<h6 id="headline-62">
触发器
</h6>
<div id="outline-text-headline-62" class="outline-text-6">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Dialogue: 0,0:00:03.42,0:00:04.91,Top,,0,0,0,,{\t(0,300,\fade(400,400))}三秒内渐入渐出</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-63" class="outline-6">
<h6 id="headline-63">
动画
</h6>
<div id="outline-text-headline-63" class="outline-text-6">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Dialogue: 0,0:00:03.42,0:00:04.91,Top,,0,0,0,,{\move(0,0,100,100)}右下角移动</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-64" class="outline-6">
<h6 id="headline-64">
特殊效果
</h6>
<div id="outline-text-headline-64" class="outline-text-6">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Dialogue: 0,0:00:03.42,0:00:05.62,Top,,0,0,0,,{\fad(500,500)\blur3}左右淡入淡出，模糊度3</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-65" class="outline-6">
<h6 id="headline-65">
合的ASS字幕案例
</h6>
<div id="outline-text-headline-65" class="outline-text-6">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">[Script Info]
</span></span><span class="line"><span class="cl">; Script generated by FFmpeg/Lavc59.18.100
</span></span><span class="line"><span class="cl">Title: 某电影
</span></span><span class="line"><span class="cl">Original Script: 某人
</span></span><span class="line"><span class="cl">ScriptType: v4.00+
</span></span><span class="line"><span class="cl">WrapStyle: 0
</span></span><span class="line"><span class="cl">Collisions: Normal
</span></span><span class="line"><span class="cl">PlayResX: 1920
</span></span><span class="line"><span class="cl">PlayResY: 1080
</span></span><span class="line"><span class="cl">Timer: 100.0000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[V4 Styles]
</span></span><span class="line"><span class="cl">Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
</span></span><span class="line"><span class="cl">Style: Default,Arial,30,&amp;Hffffff,&amp;Hffffff,&amp;H0,&amp;H0,0,0,0,0,100,100,0,0,1,1,0,2,10,10,50,0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[Events]
</span></span><span class="line"><span class="cl">Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
</span></span><span class="line"><span class="cl">Dialogue: 0,0:00:00.00,0:00:02.00,Default,,0,0,0,,这是0到2秒显示的{\b1}{\i1}字幕{\i0}{\b0}
</span></span><span class="line"><span class="cl">Dialogue: 0,0:00:02.00,0:00:04.00,Default,,0,0,0,,这是2到4秒显示的字幕
</span></span><span class="line"><span class="cl">Dialogue: 0,0:00:04.00,0:00:07.00,Default,,0,0,0,,这是4到7秒显示的字幕
</span></span><span class="line"><span class="cl">Dialogue: 0,0:00:07.00,0:00:10.00,Default,,0,0,0,,这是7到10秒显示的字幕
</span></span><span class="line"><span class="cl">Dialogue: 0,0:00:10.00,0:00:30.00,Default,,0,0,0,,这是10到30秒显示的字幕{\an5\move(960,700,960,900)\t(\fscx200\fscy200\frx360\fry360\fad(200,200))\fs60\p5\t(\fscx100\fscy100\frx0\fry0\fad(200,200))\c&amp;HFFFFFF&amp;\3c&amp;HA000&amp;}高级操作.</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-66" class="outline-4">
<h4 id="headline-66">
生成字幕的命令
</h4>
<div id="outline-text-headline-66" class="outline-text-4">
<div id="outline-container-headline-67" class="outline-5">
<h5 id="headline-67">
SRT硬字幕命令
</h5>
<div id="outline-text-headline-67" class="outline-text-5">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg -i input.mp4 -vf subtitles=subtitle.srt output_srt.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-68" class="outline-6">
<h6 id="headline-68">
命令参数详解
</h6>
<div id="outline-text-headline-68" class="outline-text-6">
<p>
-vf 是 ffmpeg 的视频滤镜选项，subtitles=subtitle.srt 表示使用字幕滤镜将 subtitle.srt 文件中的字幕嵌入到视频中。这个选项会将 subtitle.srt 文件中的字幕渲染到视频流上。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-69" class="outline-5">
<h5 id="headline-69">
ASS硬字幕命令
</h5>
<div id="outline-text-headline-69" class="outline-text-5">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg -i input.mp4 -vf ass=subtitle.ass output_ass.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-70" class="outline-5">
<h5 id="headline-70">
SRT和ASS软字幕命令
</h5>
<div id="outline-text-headline-70" class="outline-text-5">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg -i input.mp4 -i subtitle.srt -c copy -c:s mov_text -metadata:s:s:0 language=chi ouptut_chi.mp4
</span></span><span class="line"><span class="cl">or
</span></span><span class="line"><span class="cl">ffmpeg -i input.mp4 -i subtitle.ass -c copy -c:s mov_text -metadata:s:s:0 language=chi ouptut_chi.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-71" class="outline-5">
<h5 id="headline-71">
SRT可以转ASS命令
</h5>
<div id="outline-text-headline-71" class="outline-text-5">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg -i subtitle.srt subtitle.ass</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-72" class="outline-5">
<h5 id="headline-72">
多通道(软)字幕命令
</h5>
<div id="outline-text-headline-72" class="outline-text-5">
<div id="outline-container-headline-73" class="outline-6">
<h6 id="headline-73">
准备字幕文件：假设有中文字幕文件为ch.srt，英文字幕文件为en.srt。
</h6>
<div id="outline-text-headline-73" class="outline-text-6">
<div id="outline-container-headline-74" class="outline-7">
<h7 id="headline-74">
中文字幕文件：ch.srt
</h7>
<div id="outline-text-headline-74" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  1
</span></span><span class="line"><span class="cl">00:00:0,000 --&gt; 00:00:5,000
</span></span><span class="line"><span class="cl">这里是视频的标题 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">00:00:5,000 --&gt; 00:00:10,000 
</span></span><span class="line"><span class="cl">这里是视频的标题 2</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-75" class="outline-7">
<h7 id="headline-75">
英文字幕文件：en.srt
</h7>
<div id="outline-text-headline-75" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  1
</span></span><span class="line"><span class="cl">00:00:0,000 --&gt; 00:00:5,000
</span></span><span class="line"><span class="cl">Here&#39;s the video&#39;s title 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">00:00:5,000 --&gt; 00:00:10,000 
</span></span><span class="line"><span class="cl">Here&#39;s the video&#39;s title 2</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-76" class="outline-6">
<h6 id="headline-76">
命令
</h6>
<div id="outline-text-headline-76" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -i ch.srt -i en.srt -map <span class="m">0</span> -map <span class="m">1</span> -map <span class="m">2</span> -c copy -c:s mov_text -metadata:s:s:0 <span class="nv">language</span><span class="o">=</span>chi -metadata:s:s:1 <span class="nv">language</span><span class="o">=</span>eng output_chi_eng.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
注意：ass格式同样的操作</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -i ch.ass -i en.ass -map <span class="m">0</span> -map <span class="m">1</span> -map <span class="m">2</span> -c copy -c:s mov_text -metadata:s:s:0 <span class="nv">language</span><span class="o">=</span>chi -metadata:s:s:1 <span class="nv">language</span><span class="o">=</span>eng output_chi_eng_ass.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-77" class="outline-7">
<h7 id="headline-77">
参数详解
</h7>
<div id="outline-text-headline-77" class="outline-text-7">
<p>
这个 ffmpeg 命令的作用是将 input.mp4 视频与两个字幕文件 ch.srt（中文）和 en.srt（英文）合并成一个包含两种语言字幕的输出视频文件 output_chi_eng.mp4。以下是各个参数的详细解释：</p>
<ol>
<li>ffmpeg: 调用 FFmpeg 工具。</li>
<li>-i input.mp4: 指定第一个输入文件，input.mp4 是要处理的视频文件。</li>
<li>-i ch.srt: 指定第二个输入文件，ch.srt 是中文字幕文件。</li>
<li>-i en.srt: 指定第三个输入文件，en.srt 是英文字幕文件。</li>
<li>-map 0: 包含第一个输入文件（input.mp4）的所有流（视频、音频、字幕）。</li>
<li>-map 1: 包含第二个输入文件（ch.srt）的所有流（中文字幕）。</li>
<li>-map 2: 包含第三个输入文件（en.srt）的所有流（英文字幕）。</li>
<li>-c copy: 对视频和音频流使用直接复制方式，不进行重新编码。</li>
<li>-c:s mov_text: 对字幕流使用 mov_text 编解码器，这种编码适用于 MP4 容器。</li>
<li>-metadata:s:s:0 language=chi: 为第一个字幕流（中文字幕）设置语言元数据为 chi。</li>
<li>-metadata:s:s:1 language=eng: 为第二个字幕流（英文字幕）设置语言元数据为 eng。</li>
<li>output_chi_eng.mp4: 指定输出文件名，output_chi_eng.mp4 是最终生成的包含中英文字幕的视频文件。</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-78" class="outline-5">
<h5 id="headline-78">
多通道(软)字幕，中英字幕实现
</h5>
<div id="outline-text-headline-78" class="outline-text-5">
<div id="outline-container-headline-79" class="outline-6">
<h6 id="headline-79">
准备字幕文件：假设有中英文字幕文件为ch_en.srt，英文字幕文件为en.srt。
</h6>
<div id="outline-text-headline-79" class="outline-text-6">
<div id="outline-container-headline-80" class="outline-7">
<h7 id="headline-80">
中文字幕文件：ch_en.srt
</h7>
<div id="outline-text-headline-80" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">00:00:0,000 --&gt; 00:00:5,000
</span></span><span class="line"><span class="cl">这里是视频的标题 1
</span></span><span class="line"><span class="cl">Here&#39;s the video&#39;s title 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">00:00:5,000 --&gt; 00:00:10,000 
</span></span><span class="line"><span class="cl">这里是视频的标题 2
</span></span><span class="line"><span class="cl">Here&#39;s the video&#39;s title 2</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-81" class="outline-7">
<h7 id="headline-81">
英文字幕文件：en.srt
</h7>
<div id="outline-text-headline-81" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">00:00:0,000 --&gt; 00:00:5,000
</span></span><span class="line"><span class="cl">Here&#39;s the video&#39;s title 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">00:00:5,000 --&gt; 00:00:10,000 
</span></span><span class="line"><span class="cl">Here&#39;s the video&#39;s title 2</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-82" class="outline-7">
<h7 id="headline-82">
命令
</h7>
<div id="outline-text-headline-82" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg -i input.mp4 -i ch_en.srt -i en.srt -map 0 -map 1 -map 2 -c copy -c:s mov_text -metadata:s:s:0 language=chi_eng -metadata:s:s:1 language=eng output_chi_eng_eng.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-83" class="outline-7">
<h7 id="headline-83">
最后使用ffprobe查看一下生成文件的内容
</h7>
<div id="outline-text-headline-83" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Input #0, mov,mp4,m4a,3gp,3g2,mj2, from &#39;output_chi_eng_eng.mp4&#39;:
</span></span><span class="line"><span class="cl">  Metadata:
</span></span><span class="line"><span class="cl">    major_brand     : isom
</span></span><span class="line"><span class="cl">    minor_version   : 512
</span></span><span class="line"><span class="cl">    compatible_brands: isomiso2avc1mp41
</span></span><span class="line"><span class="cl">    encoder         : Lavf60.3.100
</span></span><span class="line"><span class="cl">    description     : Bilibili VXCode Swarm Transcoder v0.6.11
</span></span><span class="line"><span class="cl">  Duration: 00:05:24.20, start: 0.000000, bitrate: 531 kb/s
</span></span><span class="line"><span class="cl">  Stream #0:0[0x1](und): Video: h264 (High) (avc1 / 0x31637661), yuv420p(progressive), 852x480, 397 kb/s, 25 fps, 25 tbr, 12800 tbn (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : VideoHandler
</span></span><span class="line"><span class="cl">      vendor_id       : [0][0][0][0]
</span></span><span class="line"><span class="cl">  Stream #0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 48000 Hz, stereo, fltp, 127 kb/s (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : SoundHandler
</span></span><span class="line"><span class="cl">      vendor_id       : [0][0][0][0]
</span></span><span class="line"><span class="cl">  Stream #0:2[0x3](chi): Subtitle: mov_text (tx3g / 0x67337874), 0 kb/s (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : SubtitleHandler
</span></span><span class="line"><span class="cl">  Stream #0:3[0x4](eng): Subtitle: mov_text (tx3g / 0x67337874), 0 kb/s
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : SubtitleHandler</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-84" class="outline-4">
<h4 id="headline-84">
ffmpeg给视频添加字幕(软字幕和硬字幕)
</h4>
<div id="outline-text-headline-84" class="outline-text-4">
<div id="outline-container-headline-85" class="outline-5">
<h5 id="headline-85">
软字幕(外挂字幕)
</h5>
<div id="outline-text-headline-85" class="outline-text-5">
<div id="outline-container-headline-86" class="outline-6">
<h6 id="headline-86">
先获取视频元数据
</h6>
<div id="outline-text-headline-86" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -hide_banner</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-87" class="outline-7">
<h7 id="headline-87">
获取视频元数据结果
</h7>
<div id="outline-text-headline-87" class="outline-text-7">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  $ ffmpeg -i 1.mp4 -hide_banner
</span></span><span class="line"><span class="cl">Input #0, mov,mp4,m4a,3gp,3g2,mj2, from &#39;1.mp4&#39;:
</span></span><span class="line"><span class="cl">  Metadata:
</span></span><span class="line"><span class="cl">    major_brand     : isom
</span></span><span class="line"><span class="cl">    minor_version   : 512
</span></span><span class="line"><span class="cl">    compatible_brands: isomiso2avc1mp41
</span></span><span class="line"><span class="cl">    encoder         : Lavf60.13.100
</span></span><span class="line"><span class="cl">  Duration: 00:00:05.01, start: 0.000000, bitrate: 1320 kb/s
</span></span><span class="line"><span class="cl">  Stream #0:0[0x1](und): Video: h264 (High 4:4:4 Predictive) (avc1 / 0x31637661), yuv444p(progressive), 3840x1080, 1285 kb/s, 29.97 fps, 29.97 tbr, 30k tbn (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : VideoHandler
</span></span><span class="line"><span class="cl">      vendor_id       : [0][0][0][0]
</span></span><span class="line"><span class="cl">      encoder         : Lavc60.26.100 libx264
</span></span><span class="line"><span class="cl">  Stream #0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 127 kb/s (default)
</span></span><span class="line"><span class="cl">    Metadata:
</span></span><span class="line"><span class="cl">      handler_name    : SoundHandler
</span></span><span class="line"><span class="cl">      vendor_id       : [0][0][0][0]
</span></span><span class="line"><span class="cl">At least one output file must be specified</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
假设有一个视频轨(#0:0), 一个音频轨(#0:1), 两个字幕轨(#0:2和#0:3)，现在我要添加第三个字幕, 可以如下操作</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 4.mp4 -i ch_en.srt -map 0:v:0 -map 0:a:0 -map 0:s:0 -map 0:s:1 -c:v copy -c:a copy -c:s copy -map <span class="m">1</span> -c:s:2 mov_text -metadata:s:s:2 <span class="nv">language</span><span class="o">=</span>chi_eng  -y 6.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-88" class="outline-8">
<h8 id="headline-88">
参数解释
</h8>
<div id="outline-text-headline-88" class="outline-text-8">
<ol>
<li>第一个输入流(视频.mp4)对应map 0, 第二个输入流(字幕.srt)对应map 1</li>
<li>metadata:s:s:2 指向第三个字幕流元数据</li>
<li>c:v 视频编解码方式</li>
<li>c:a 音频编解码方式</li>
<li>c:s 字幕编解码方式</li>
<li>c:s:2 mov_text: 对字幕流使用 mov_text 编解码器，这种编码适用于 MP4 容器。</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-89" class="outline-7">
<h7 id="headline-89">
给无字幕的视频添加软字幕
</h7>
<div id="outline-text-headline-89" class="outline-text-7">
<p>
视频已经有video和audio，接下来要做是添加Subtitle</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -i input.srt -c:v copy -c:a copy -c:s mov_text -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-90" class="outline-8">
<h8 id="headline-90">
参数详解
</h8>
<div id="outline-text-headline-90" class="outline-text-8">
<ol>
<li>-i input.mp4：-i 选项指定输入文件。这里 input.mp4 是你要处理的视频文件。</li>
<li>-i input.srt：第二个 -i 选项指定字幕文件 input.srt。ffmpeg 会将这个字幕文件合并到视频中。</li>
<li>-c:v copy：-c:v 用于指定视频编解码器。copy 表示直接拷贝视频流，不进行任何编码或重新压缩，从而保留原始视频质量。</li>
<li>-c:a copy：-c:a 用于指定音频编解码器。copy 表示直接拷贝音频流，不进行重新编码，保持原始音频质量。</li>
<li>-c:s mov_text：-c:s 用于指定字幕编解码器。mov_text 是将字幕编码为适用于 MP4 文件的文本轨道格式。这种格式允许播放器选择显示或隐藏字幕。</li>
<li>-y：-y 选项表示在输出文件 output.mp4 已存在时自动覆盖该文件，而不会询问确认。这对于脚本或批处理操作非常有用。</li>
<li>output.mp4：这是输出文件的名称。合并后的文件将保存为 output.mp4。</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-91" class="outline-5">
<h5 id="headline-91">
硬字幕(将字幕烧录到视频上)
</h5>
<div id="outline-text-headline-91" class="outline-text-5">
<div id="outline-container-headline-92" class="outline-6">
<h6 id="headline-92">
将外部字幕烧录到视频中(例如第二个字幕轨)
</h6>
<div id="outline-text-headline-92" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -map 0:v:0 -map 0:a:0 -vf <span class="nv">subtitles</span><span class="o">=</span>ch.srt -y 7.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-93" class="outline-6">
<h6 id="headline-93">
使用mkv容器中的某一个字幕轨烧录到视频上
</h6>
<div id="outline-text-headline-93" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -map 0:v:0 -map 0:a:0 -vf <span class="nv">subtitles</span><span class="o">=</span>4.mp4:si<span class="o">=</span><span class="m">1</span> 8.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-94" class="outline-7">
<h7 id="headline-94">
参数解释
</h7>
<div id="outline-text-headline-94" class="outline-text-7">
<p>
:si=1 代表指定选择第 1 个字幕轨道，字幕轨道从 0 开始算起，因此 si=1 对应第 2 个字幕轨道。si 是 subtitles 过滤器的一个选项，用于指定字幕流的索引。这里的 si 代表 &#34;subtitle index&#34;，即字幕流的索引。它必须用 si 而不是 s 是因为 s 是用来指定其它过滤器选项的缩写，例如 scale 或 setpts，而 si 特指字幕流的索引选择。</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-95" class="outline-4">
<h4 id="headline-95">
使用 FFmpeg 将 MKV 内封字幕压制为内嵌硬字幕
</h4>
<div id="outline-text-headline-95" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i output_chi_eng_eng.mp4 -vf <span class="s2">&#34;subtitles=output_chi_eng_eng.mp4:si=0&#34;</span> -crf:18 -o result.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-96" class="outline-5">
<h5 id="headline-96">
命令参数详解
</h5>
<div id="outline-text-headline-96" class="outline-text-5">
<p>
-i output_chi_eng_eng.mp4 为你的输入视频文件</p>
<p>
-vf &#34;subtitles=output_chi_eng_eng.mp4:si=0&#34; 代表了要选用的滤镜，请注意，这里 -vf 后面的参数是双引号之间的内容</p>
<p>
subtitles=output_chi_eng_eng.mp4 这里是字幕的来源，可以填写 mp4 文件</p>
<p>
:si=0 代表指定选择第 0 个字幕轨道。实际上此参数可以不加，FFmepg 将选择默认的字幕轨道。关于字幕轨道的编号可以通过播放器或 mediainfo 来查看，在 ffmpeg 中。si 是 subtitles 过滤器的一个选项，用于指定字幕流的索引。这里的 si 代表 &#34;subtitle index&#34;，即字幕流的索引。它必须用 si 而不是 s 是因为 s 是用来指定其它过滤器选项的缩写，例如 scale 或 setpts，而 si 特指字幕流的索引选择。</p>
<p>
-crf:18 这里简单指定了压制的质量，18 已经是画质较佳的选项。一般动画压制的范围在 16-23，可查找其他教程</p>
<p>
-o result.mp4 这里指定了输出文件名，mp4 的后缀将会自动将视频压制为 H.264 / AVC 编码。若需要使用其他封装格式请手动指定编码器为 libx264</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-97" class="outline-4">
<h4 id="headline-97">
ffmpeg将带字幕轨道的视频分离成无字幕视频，同时提取字幕文件及替换视频音轨
</h4>
<div id="outline-text-headline-97" class="outline-text-4">
<div id="outline-container-headline-98" class="outline-5">
<h5 id="headline-98">
查看视频信息
</h5>
<div id="outline-text-headline-98" class="outline-text-5">
<div id="outline-container-headline-99" class="outline-6">
<h6 id="headline-99">
命令
</h6>
<div id="outline-text-headline-99" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i output_chi.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-100" class="outline-7">
<h7 id="headline-100">
查看视频信息结果
</h7>
<div id="outline-text-headline-100" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  $ ffmpeg -i output_chi.mp4
</span></span><span class="line"><span class="cl">  ffmpeg version N-112134-g9ef20920ab-20230920 Copyright <span class="o">(</span>c<span class="o">)</span> 2000-2023 the FFmpeg developers
</span></span><span class="line"><span class="cl">  built with gcc 13.1.0 <span class="o">(</span>crosstool-NG 1.25.0.196_227d99d<span class="o">)</span>
</span></span><span class="line"><span class="cl">  configuration: --prefix<span class="o">=</span>/ffbuild/prefix --pkg-config-flags<span class="o">=</span>--static --pkg-config<span class="o">=</span>pkg-config --cross-prefix<span class="o">=</span>x86_64-w64-mingw32- --arch<span class="o">=</span>x86_64 --target-os<span class="o">=</span>mingw32 --enable-gpl --enable-version3 --disable-debug --disable-w32threads --enable-pthreads --enable-iconv --enable-libxml2 --enable-zlib --enable-libfreetype --enable-libfribidi --enable-gmp --enable-lzma --enable-fontconfig --enable-libharfbuzz --enable-libvorbis --enable-opencl --disable-libpulse --enable-libvmaf --disable-libxcb --disable-xlib --enable-amf --enable-libaom --enable-libaribb24 --enable-avisynth --enable-chromaprint --enable-libdav1d --enable-libdavs2 --disable-libfdk-aac --enable-ffnvcodec --enable-cuda-llvm --enable-frei0r --enable-libgme --enable-libkvazaar --enable-libass --enable-libbluray --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librist --enable-libssh --enable-libtheora --enable-libvpx --enable-libwebp --enable-lv2 --enable-libvpl --enable-openal --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenh264 --enable-libopenjpeg --enable-libopenmpt --enable-librav1e --enable-librubberband --enable-schannel --enable-sdl2 --enable-libsoxr --enable-libsrt --enable-libsvtav1 --enable-libtwolame --enable-libuavs3d --disable-libdrm --enable-vaapi --enable-libvidstab --enable-vulkan --enable-libshaderc --enable-libplacebo --enable-libx264 --enable-libx265 --enable-libxavs2 --enable-libxvid --enable-libzimg --enable-libzvbi --extra-cflags<span class="o">=</span>-DLIBTWOLAME_STATIC --extra-cxxflags<span class="o">=</span> --extra-ldflags<span class="o">=</span>-pthread --extra-ldexeflags<span class="o">=</span> --extra-libs<span class="o">=</span>-lgomp --extra-version<span class="o">=</span><span class="m">20230920</span>
</span></span><span class="line"><span class="cl">  libavutil      58. 25.100 / 58. 25.100
</span></span><span class="line"><span class="cl">  libavcodec     60. 26.100 / 60. 26.100
</span></span><span class="line"><span class="cl">  libavformat    60. 13.100 / 60. 13.100
</span></span><span class="line"><span class="cl">  libavdevice    60.  2.101 / 60.  2.101
</span></span><span class="line"><span class="cl">  libavfilter     9. 11.100 /  9. 11.100
</span></span><span class="line"><span class="cl">  libswscale      7.  3.100 /  7.  3.100
</span></span><span class="line"><span class="cl">  libswresample   4. 11.100 /  4. 11.100
</span></span><span class="line"><span class="cl">  libpostproc    57.  2.100 / 57.  2.100
</span></span><span class="line"><span class="cl">  Input <span class="c1">#0, mov,mp4,m4a,3gp,3g2,mj2, from &#39;output_chi.mp4&#39;:</span>
</span></span><span class="line"><span class="cl">  Metadata:
</span></span><span class="line"><span class="cl">  major_brand     : isom
</span></span><span class="line"><span class="cl">  minor_version   : <span class="m">512</span>
</span></span><span class="line"><span class="cl">  compatible_brands: isomiso2avc1mp41
</span></span><span class="line"><span class="cl">  encoder         : Lavf60.13.100
</span></span><span class="line"><span class="cl">  Duration: 00:00:07.00, start: 0.000000, bitrate: <span class="m">1287</span> kb/s
</span></span><span class="line"><span class="cl">  Stream <span class="c1">#0:0[0x1](und): Video: h264 (High 4:4:4 Predictive) (avc1 / 0x31637661), yuv444p(progressive), 3840x1080, 1457 kb/s, 29.97 fps, 29.97 tbr, 30k tbn (default)</span>
</span></span><span class="line"><span class="cl">  Metadata:
</span></span><span class="line"><span class="cl">  handler_name    : VideoHandler
</span></span><span class="line"><span class="cl">  vendor_id       : <span class="o">[</span>0<span class="o">][</span>0<span class="o">][</span>0<span class="o">][</span>0<span class="o">]</span>
</span></span><span class="line"><span class="cl">  encoder         : Lavc60.26.100 libx264
</span></span><span class="line"><span class="cl">  Stream <span class="c1">#0:1[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 127 kb/s (default)</span>
</span></span><span class="line"><span class="cl">  Metadata:
</span></span><span class="line"><span class="cl">  handler_name    : SoundHandler
</span></span><span class="line"><span class="cl">  vendor_id       : <span class="o">[</span>0<span class="o">][</span>0<span class="o">][</span>0<span class="o">][</span>0<span class="o">]</span>
</span></span><span class="line"><span class="cl">  Stream <span class="c1">#0:2[0x3](chi): Subtitle: mov_text (tx3g / 0x67337874), 0 kb/s (default)</span>
</span></span><span class="line"><span class="cl">  Metadata:
</span></span><span class="line"><span class="cl">  handler_name    : SubtitleHandler
</span></span><span class="line"><span class="cl">  At least one output file must be specified</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
可以看到第一个轨道是视频，第二个轨道是音频，第三个轨道是字幕</p>
</div>
</div>
<div id="outline-container-headline-101" class="outline-7">
<h7 id="headline-101">
提取字幕文件
</h7>
<div id="outline-text-headline-101" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  <span class="c1">#将第三个轨道subrip字幕轨道提取成srt文件</span>
</span></span><span class="line"><span class="cl">  ffmpeg -i output_chi.mp4 -map <span class="s2">&#34;0:2&#34;</span> test.srt
</span></span><span class="line"><span class="cl">  <span class="c1">#将第三个轨道subrip字幕轨道提取成ass文件</span>
</span></span><span class="line"><span class="cl">  ffmpeg -i output_chi.mp4 -map <span class="s2">&#34;0:2&#34;</span> test.ass</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-102" class="outline-7">
<h7 id="headline-102">
提取无字幕的视频文件
</h7>
<div id="outline-text-headline-102" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i output_chi.mp4 -map <span class="s2">&#34;0:0&#34;</span> test.srt</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
或</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  <span class="c1"># 将第一轨道的视频和第二轨道的音频重新生成新的视频文件</span>
</span></span><span class="line"><span class="cl">  ffmpeg -i .<span class="se">\3</span>3死者们的侵略.mp4 -map 0:0 -map 0:1 -vcodec copy -acodec copy 33死者们的侵略（无字幕）.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-103" class="outline-8">
<h8 id="headline-103">
命令参数详解
</h8>
<div id="outline-text-headline-103" class="outline-text-8">
<ol>
<li>-i: 输入文件</li>
<li>-map 0:0: 第1个输入文件的第一个流，也就是主要的视频流。</li>
<li>-map 0:1: 第1个输入文件的第二个流，是视频的声音。</li>
<li>-vcodec copy: 拷贝选择的视频流。</li>
<li>-acodec copy: 拷贝选择的声音流。</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-104" class="outline-7">
<h7 id="headline-104">
提取音频文件
</h7>
<div id="outline-text-headline-104" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i output_chi.mp4 -map <span class="s2">&#34;0:1&#34;</span> test.mp3</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
或</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -c:a mp3 -map 0:a:0 targetAudio.mp3</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-105" class="outline-8">
<h8 id="headline-105">
命令参数详解
</h8>
<div id="outline-text-headline-105" class="outline-text-8">
<ol>
<li>-i 1.mp4 指定输入的视频文件名称和路径</li>
<li>-c:a mp3 指定输出的音频编码采用mp3编码器</li>
<li>-map 0:a:0 指定输入输出的映射</li>
<li>targetAudio.mp3 指定输出的音频文件名称和路径</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-106" class="outline-7">
<h7 id="headline-106">
使用ffmpeg替换视频音轨
</h7>
<div id="outline-text-headline-106" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -i 2.mp3 -c:v copy -c:a alac -map 0:v:0 -map 1:a:0 3.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-107" class="outline-8">
<h8 id="headline-107">
命令参数详解
</h8>
<div id="outline-text-headline-107" class="outline-text-8">
<ol>
<li>-i sourceVideo.mp4 指定输入的视频文件名称和路径</li>
<li>-i sourceAudio.flac 指定输入的音频文件名称和路径，这里是一个无损格式的flac音频文件</li>
<li>-c:v copy 指定输出的视频编码，copy指直接拷贝源文件的内容，不就行二次编码</li>
<li>-c:a alac 指定输出的音频编码采用alac编码器</li>
<li>-map 0:v:0  指定第一个输入映射到输出的视频</li>
<li>-map 1:a:0 指定第二个输入映射到输出的音频</li>
<li>targetVideo.mp4 指定输出的视频文件名称和路径</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-108" class="outline-4">
<h4 id="headline-108">
参考链接
</h4>
<div id="outline-text-headline-108" class="outline-text-4">
<p>
<a href="https://blog.csdn.net/github_38117599/article/details/129976196">FFmpeg添加字幕的详细操作</a></p>
<p>
<a href="https://magma.ink/posts/ffmpeg-mkvass/">使用 FFmpeg 将 MKV 内封字幕压制为内嵌硬字幕</a></p>
<p>
<a href="https://yonglun.me/ffmpeg/">ffmpeg 视频音轨的提取及替换</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-109" class="outline-3">
<h3 id="headline-109">
ffmpeg给视频添加文字
</h3>
<div id="outline-text-headline-109" class="outline-text-3">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>50:text<span class="o">=</span><span class="s1">&#39;Hello World!&#39;</span>:x<span class="o">=</span>0:y<span class="o">=</span><span class="m">100</span> -y 5.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-110" class="outline-4">
<h4 id="headline-110">
上面简单命令的相关参数
</h4>
<div id="outline-text-headline-110" class="outline-text-4">
<ol>
<li>输入文件 1.mp4</li>
<li>fontcolor 文字颜色 为黑色red</li>
<li>fontsize 文字大小 为50</li>
<li>text 文本内容 “Hello Word”</li>
<li>文本所处的位置 x=0,y=100</li>
<li>输出文件 5.mp4</li>
</ol>
</div>
</div>
<div id="outline-container-headline-111" class="outline-4">
<h4 id="headline-111">
相关命令参数
</h4>
<div id="outline-text-headline-111" class="outline-text-4">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">between(x, min, max)
</span></span><span class="line"><span class="cl">Return 1 if x is greater than or equal to min and lesser than or equal to max, 0 otherwise.
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">gt(x, y)
</span></span><span class="line"><span class="cl">Return 1 if x is greater than y, 0 otherwise.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gte(x, y)
</span></span><span class="line"><span class="cl">Return 1 if x is greater than or equal to y, 0 otherwise.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">if(x, y)
</span></span><span class="line"><span class="cl">Evaluate x, and if the result is non-zero return the result of the evaluation of y, return 0 otherwise.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if(x, y, z)
</span></span><span class="line"><span class="cl">Evaluate x, and if the result is non-zero return the evaluation result of y, otherwise the evaluation result of z.
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">lt(x, y)
</span></span><span class="line"><span class="cl">Return 1 if x is lesser than y, 0 otherwise.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lte(x, y)
</span></span><span class="line"><span class="cl">Return 1 if x is lesser than or equal to y, 0 otherwise.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">mod(x, y)
</span></span><span class="line"><span class="cl">Compute the remainder of division of x by y.</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-112" class="outline-4">
<h4 id="headline-112">
前5秒加文字
</h4>
<div id="outline-text-headline-112" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;test&#39;</span>:x<span class="o">=</span>50:y<span class="o">=</span>50:enable<span class="o">=</span><span class="s1">&#39;lte(t\,5)&#39;</span> -y 9.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-113" class="outline-4">
<h4 id="headline-113">
5秒后加文字
</h4>
<div id="outline-text-headline-113" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;test&#39;</span>:x<span class="o">=</span>50:y<span class="o">=</span>50:enable<span class="o">=</span><span class="s1">&#39;gte(t\,5)&#39;</span> -y 10.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-114" class="outline-4">
<h4 id="headline-114">
第2秒到第5加文字
</h4>
<div id="outline-text-headline-114" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;test&#39;</span>:x<span class="o">=</span>50:y<span class="o">=</span>50:enable<span class="o">=</span><span class="s1">&#39;between(t\,2\,5)&#39;</span> -y 11.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-115" class="outline-5">
<h5 id="headline-115">
参数详解
</h5>
<div id="outline-text-headline-115" class="outline-text-5">
<p>
between(t\,start\,end)：这个条件判断 t 是否在 start 和 end 之间。例如，between(t\,2\,5) 会在视频播放时间从第 10 秒到第 15 秒之间为 true，即在这段时间内显示文本。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-116" class="outline-4">
<h4 id="headline-116">
每隔3秒周期显示1秒文字
</h4>
<div id="outline-text-headline-116" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;test&#39;</span>:x<span class="o">=</span>50:y<span class="o">=</span>50:enable<span class="o">=</span><span class="s1">&#39;lte(mod(t\,3)\,1)&#39;</span> -y 12.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-117" class="outline-4">
<h4 id="headline-117">
间隔1秒依次显示hello和world
</h4>
<div id="outline-text-headline-117" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;hello&#39;</span>:x<span class="o">=</span>50:y<span class="o">=</span>50:enable<span class="o">=</span><span class="s1">&#39;lte(mod(t\,2)\,1)&#39;</span>,drawtext<span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;world&#39;</span>:x<span class="o">=</span>50:y<span class="o">=</span>50:enable<span class="o">=</span><span class="s1">&#39;gte(mod(t\,2)\,1)&#39;</span> -y 13.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-118" class="outline-5">
<h5 id="headline-118">
文字从左向右移动 每帧移动50个像素
</h5>
<div id="outline-text-headline-118" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>60:text<span class="o">=</span><span class="s1">&#39;test&#39;</span>:x<span class="o">=</span>50+50*t:y<span class="o">=</span><span class="m">50</span> -y 14.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-119" class="outline-6">
<h6 id="headline-119">
参数解释
</h6>
<div id="outline-text-headline-119" class="outline-text-6">
<p>
x=50+50*t：文本的水平位置随着时间变化。50+50*t 意味着文本的水平位置会随着视频播放时间 t 增加，每秒移动 50 像素。</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-120" class="outline-4">
<h4 id="headline-120">
从下往上移动，每次移动100像素
</h4>
<div id="outline-text-headline-120" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>50:text<span class="o">=</span><span class="s1">&#39;Hello World!&#39;</span>:y<span class="o">=</span>h-100*t -y 15.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-121" class="outline-4">
<h4 id="headline-121">
打印real time
</h4>
<div id="outline-text-headline-121" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">drawtext</span><span class="o">=</span><span class="nv">fontcolor</span><span class="o">=</span>red:fontsize<span class="o">=</span>40:text<span class="o">=</span><span class="s1">&#39;%{localtime}&#39;</span>:x<span class="o">=</span>200:y<span class="o">=</span><span class="m">200</span> -y 16.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-122" class="outline-4">
<h4 id="headline-122">
将每帧的时间戳以 hh:mm:ss 格式叠加到视频上
</h4>
<div id="outline-text-headline-122" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;drawtext=fontcolor=red:fontsize=40:text=&#39;%{pts\:hms}&#39;:x=10:y=10&#34;</span> -y 17.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-123" class="outline-4">
<h4 id="headline-123">
参考链接
</h4>
<div id="outline-text-headline-123" class="outline-text-4">
<p>
<a href="https://blog.csdn.net/m0_37477175/article/details/106453427">ffmpeg给视频添加文字</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-124" class="outline-3">
<h3 id="headline-124">
水印的添加与去除
</h3>
<div id="outline-text-headline-124" class="outline-text-3">
<div id="outline-container-headline-125" class="outline-4">
<h4 id="headline-125">
ffmpeg添加水印
</h4>
<div id="outline-text-headline-125" class="outline-text-4">
<div id="outline-container-headline-126" class="outline-5">
<h5 id="headline-126">
基本命令
</h5>
<div id="outline-text-headline-126" class="outline-text-5">
<p>
ffmpeg添加水印主要通过overlay滤镜实现。以下是一个基本示例，展示了如何在视频中添加静态水印：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -i yenao.png -filter_complex <span class="s2">&#34;overlay=400:50&#34;</span> -y 6.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
在这个命令中，-i input.mp4指定了输入视频文件，-i logo.png指定了水印图片文件，overlay=10:10表示将水印放置在视频的左上角（距离左边和上边各10像素的位置），output.mp4是输出视频文件。</p>
</div>
</div>
<div id="outline-container-headline-127" class="outline-5">
<h5 id="headline-127">
自定义水印位置 
</h5>
<div id="outline-text-headline-127" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -i yenao.png -filter_complex <span class="s2">&#34;overlay=main_w-overlay_w-100:main_h-overlay_h-100&#34;</span> -y 6.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
其中，main_w和main_h分别代表主视频的宽度和高度，overlay_w和overlay_h分别代表水印的宽度和高度。通过计算，可以将水印放置在指定位置。</p>
</div>
</div>
<div id="outline-container-headline-128" class="outline-5">
<h5 id="headline-128">
透明水印
</h5>
<div id="outline-text-headline-128" class="outline-text-5">
<p>
如果水印图片包含透明通道（如PNG图片），则可以直接使用ffmpeg添加透明水印。不需要额外的设置，ffmpeg会自动处理透明通道。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-129" class="outline-4">
<h4 id="headline-129">
fmpeg去除水印
</h4>
<div id="outline-text-headline-129" class="outline-text-4">
<p>
delogo是ffmpeg中用于去除视频中固定位置标志或水印的滤镜。基本语法如下：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;delogo=x:y:w:h[:band[:show]]&#34;</span> output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
其中，x和y是水印左上角的坐标，w和h是水印的宽度和高度，band是可选的边缘模糊宽度（默认值为4），show是可选的，如果设置为1，将显示一个矩形表示删除的区域（默认值为0）。</p>
<div id="outline-container-headline-130" class="outline-5">
<h5 id="headline-130">
示例
</h5>
<div id="outline-text-headline-130" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 6.mp4 -vf <span class="nv">delogo</span><span class="o">=</span><span class="nv">x</span><span class="o">=</span>400:y<span class="o">=</span>50:w<span class="o">=</span>70:h<span class="o">=</span><span class="m">30</span> -y 8.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-131" class="outline-4">
<h4 id="headline-131">
遮盖水印
</h4>
<div id="outline-text-headline-131" class="outline-text-4">
<p>
如果delogo滤镜的效果不理想，可以尝试使用drawbox滤镜来遮盖水印。基本语法如下：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;drawbox=x:y:w:h:color[:t]&#34;</span> output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
其中，x、y、w、h分别代表矩形的位置和大小，color是矩形的颜色（可以是颜色名称或十六进制代码），t是矩形的厚度（t=fill表示填充整个区域）。</p>
<div id="outline-container-headline-132" class="outline-5">
<h5 id="headline-132">
示例
</h5>
<div id="outline-text-headline-132" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 6.mp4 -vf <span class="nv">drawbox</span><span class="o">=</span><span class="nv">x</span><span class="o">=</span>400:y<span class="o">=</span>50:w<span class="o">=</span>70:h<span class="o">=</span>30:color<span class="o">=</span>red:t<span class="o">=</span>fill -y 7.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-133" class="outline-4">
<h4 id="headline-133">
参考链接
</h4>
<div id="outline-text-headline-133" class="outline-text-4">
<p>
<a href="https://developer.baidu.com/article/detail.html?id=3333970">ffmpeg实战：水印的添加与去除</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-134" class="outline-3">
<h3 id="headline-134">
如何使用 ffmpeg 剪切和裁剪视频
</h3>
<div id="outline-text-headline-134" class="outline-text-3">
<div id="outline-container-headline-135" class="outline-4">
<h4 id="headline-135">
如何使用ffmpeg剪切视频
</h4>
<div id="outline-text-headline-135" class="outline-text-4">
<p>
使用 ffmpeg 剪切视频是一项非常简单、快速且资源消耗低的任务。您只需要定义开始或结束时间，或两者（如果需要）和输出文件。</p>
<p>
下面的命令使用 ffmpeg 从标志 -ss 指定的 00:00:05 处开始剪切视频；这是定义新视频起点的标志，以防您想剪切开头的一部分。如果您只想剪切视频末尾的一部分，则不需要使用此标志。如您所见，计时格式必须为 HH:MM:SS（小时、分钟、秒）。例如，对于 2 分 3 秒的计时，您应该键入 00:02:03。</p>
<p>
-i 标志用于指定要编辑的文件；</p>
<p>
选项-t用于指定新文件的结尾；在这种情况下，视频将在 00:00:05 结束。与 -ss 类似，如果您不想剪切视频结尾的部分，而只想剪切开头的部分，则不需要应用此标志。</p>
<p>
在这种情况下，-c copy 标志用于定义输出文件；</p>
<p>
从 -ss 00:00:05 处开始，剪辑了 -t 00:00:05 这么长时间，共5秒</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -ss 00:00:05 -i input.mp4 -t 00:00:05 -c copy -y 1.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
整个操作只需几秒钟，不消耗计算机资源。</p>
<p>
下一个示例演示如何仅剪切视频的结尾部分。因此，我省略了选项 -ss，因为我想保留起点，并通过实施 -t 标志在 00:00:05 剪切视频。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -t 00:00:05 -c copy -y 3.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
与前面的示例相反，下面的命令仅使用 -ss 标志来剪切视频开头的部分。在这种情况下，新输出将从 00:00:05 开始。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -ss 00:00:05 -i input.mp4 -c copy -y 4.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
如您所见，使用 ffmpeg 剪切视频是一个简单而快速的过程。</p>
</div>
</div>
<div id="outline-container-headline-136" class="outline-4">
<h4 id="headline-136">
使用 ffmpeg 裁剪黑色边框
</h4>
<div id="outline-text-headline-136" class="outline-text-4">
<p>
本教程的这一部分介绍如何使用 ffmpeg 裁剪视频。</p>
<p>
您可以使用 ffmpeg 尝试自动检测如何裁剪视频以去除黑色边框。</p>
<p>
下面的命令将尝试检测正确的尺寸和位置以正确裁剪视频。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">timeout 3s ffmpeg -i input.mp4 -vf cropdetect -f null - 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> awk <span class="s1">&#39;/crop/ {print $NF}&#39;</span> <span class="p">|</span> head -n <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
如您所见，ffmpeg 返回正确的宽度 (320)、高度 (208)、X 和 Y 位置以正确裁剪视频。</p>
<p>
X 位置：X 位置定义从左边距开始的水平裁剪起点，其中左边距为 0。</p>
<p>
Y 位置：Y 是垂直裁剪起始点，上边距为 0。</p>
<p>
视频下面的示例将被裁剪；您可以看到 -filter:v 标志。</p>
<p>
-filter 标志实现一个过滤器图，该过滤器图划分输入流，裁剪它，并将其与其他流叠加。如您所见，下面的命令中定义的尺寸和位置是由上一个命令提供的。</p>
<p>
另外，您可以看到省略了标志“-c copy”，并且输出文件名写在作物标志之后。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 1.mp4 -filter:v <span class="s2">&#34;crop=1920:1072:0:4&#34;</span> -y 5.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-137" class="outline-5">
<h5 id="headline-137">
参数解释
</h5>
<div id="outline-text-headline-137" class="outline-text-5">
<p>
timeout 3s：timeout 命令会在指定时间（如 3 秒）后强制终止 ffmpeg 命令。你可以根据需要调整时间长度。
ffmpeg -i input.mp4 -vf cropdetect -f null - 2&gt;&amp;1：执行视频裁剪检测，将输出重定向到标准输出。
awk &#39;<em>crop</em> {print $NF}&#39;：过滤包含 “crop” 的行，并打印最后一个字段。
head -n 1：只取 awk 输出的第一行。</p>
</div>
</div>
<div id="outline-container-headline-138" class="outline-5">
<h5 id="headline-138">
说明
</h5>
<div id="outline-text-headline-138" class="outline-text-5">
<p>
timeout 命令会在指定时间后终止 ffmpeg 进程。如果 ffmpeg 在超时时间内找到了裁剪建议并打印出来，head -n 1 将确保你只得到第一行输出。
timeout 的时间需要根据你的视频长度和处理速度进行调整，以确保它足够长以捕捉到裁剪建议，但又不会长到影响效率。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-139" class="outline-4">
<h4 id="headline-139">
关于使用 ffmpeg 裁剪视频：
</h4>
<div id="outline-text-headline-139" class="outline-text-4">
<p>
您可以使用以前的技术裁剪视频的任何部分，而不仅仅是黑色边框。</p>
<p>
下面的命令将裁剪上一个视频，返回 200×200 的图像，从左侧开始 200 像素，从上边距开始 0 像素。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 5.mp4 -filter:v <span class="s2">&#34;crop=200:200:200:0&#34;</span> 6.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
如果不指定位置，ffmpeg会自动裁剪视频的中心。因此，在下面的示例中，仅定义了视频的高度和宽度，但没有定义位置，ffmpeg 将裁剪视频并返回视频中心的 500×500 裁剪输出。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 5.mp4 -filter:v <span class="s2">&#34;crop=200:200&#34;</span> 7.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
如果需要，可以使用ffmpeg命令结合grep来了解原始视频分辨率，如下所示。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 5.mp4 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep <span class="s2">&#34;Video:&#34;</span> <span class="p">|</span> grep -Po <span class="s1">&#39;\d{3,5}x\d{3,5}&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-140" class="outline-4">
<h4 id="headline-140">
FFmpeg如何将一个gif嵌入视频指定位置并指定显示时间
</h4>
<div id="outline-text-headline-140" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i test.mp4 -stream_loop -1 -i test.gif -filter_complex <span class="s2">&#34;[0:v][1:v] overlay=10:10:enable=&#39;between(t,3,4)&#39;:shortest=1&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
或</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i test.mp4 -stream_loop -1 -i test.gif -filter_complex <span class="s2">&#34;overlay=10:10:enable=&#39;between(t,3,4)&#39;:shortest=1&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-141" class="outline-5">
<h5 id="headline-141">
参数详解
</h5>
<div id="outline-text-headline-141" class="outline-text-5">
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">ffmpeg: 调用 FFmpeg 工具。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-i test.mp4: 指定输入视频文件 test.mp4。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-stream_loop -1 -i test.gif: 指定输入动图 test.gif 并使其无限循环（-1 表示无限循环）。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-filter_complex: 应用复杂的滤镜链，允许同时处理多个输入流。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;[0:v][1:v] overlay=10:10:enable=&#39;between(t,3,4)&#39;:shortest=1&#34;:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[0:v]: 第一个输入的第一个视频流（即 test.mp4）。
</span></span><span class="line"><span class="cl">[1:v]: 第二个输入的第一个视频流（即 test.gif）。
</span></span><span class="line"><span class="cl">overlay=10:10: 在 test.mp4 上覆盖 test.gif，并将 test.gif 放置在视频的 (10,10) 位置。
</span></span><span class="line"><span class="cl">enable=&#39;between(t,3,4)&#39;: 仅在 test.mp4 的时间从第3秒到第4秒之间显示覆盖。
</span></span><span class="line"><span class="cl">shortest=1: 确保输出视频长度与最短输入视频流长度一致。
</span></span><span class="line"><span class="cl">-y: 自动覆盖输出文件 output.mp4（如果存在）。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">output.mp4: 指定输出文件名。</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-142" class="outline-5">
<h5 id="headline-142">
参考链接
</h5>
<div id="outline-text-headline-142" class="outline-text-5">
<p>
<a href="https://www.cnblogs.com/xiaxiaolu/p/17717626.html">FFmpeg如何将一个gif嵌入视频指定位置并指定显示时间</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-143" class="outline-3">
<h3 id="headline-143">
视频转换成帧图片再转换成视频，如何考虑速率问题
</h3>
<div id="outline-text-headline-143" class="outline-text-3">
<p>
将视频转换为帧图片，再将这些帧图片重新转换为视频时，考虑到速率（即帧率）的问题是关键。以下是处理这一过程的步骤和相关说明：</p>
<div id="outline-container-headline-144" class="outline-4">
<h4 id="headline-144">
脚本
</h4>
<div id="outline-text-headline-144" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  <span class="nv">vcodec_1</span><span class="o">=</span><span class="s2">&#34;libx264&#34;</span>				<span class="c1"># 视频编码格式</span>
</span></span><span class="line"><span class="cl">  <span class="nv">crf_1</span><span class="o">=</span><span class="s2">&#34;25&#34;</span>						<span class="c1"># 画质</span>
</span></span><span class="line"><span class="cl">  <span class="nv">fps</span><span class="o">=</span><span class="k">$(</span>ffprobe <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep -Eo <span class="s2">&#34;[0-9]{2,5} fps&#34;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span> <span class="c1"># 获取帧率</span>
</span></span><span class="line"><span class="cl">  <span class="nv">s</span><span class="o">=</span><span class="k">$(</span>ffprobe <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep <span class="s2">&#34;Video&#34;</span> <span class="p">|</span> grep -Eo <span class="s2">&#34;[0-9]{3,5}x[0-9]{3,5}&#34;</span><span class="k">)</span>				<span class="c1"># 获取分辨率</span>
</span></span><span class="line"><span class="cl">  <span class="nv">b</span><span class="o">=</span><span class="k">$(</span>ffprobe <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep <span class="s2">&#34;bitrate&#34;</span> <span class="p">|</span> grep -Eo <span class="s2">&#34;[0-9]{4,6} kb/s&#34;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="nv">pix_fmt</span><span class="o">=</span><span class="k">$(</span>ffprobe <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep -Eo <span class="s2">&#34;, .*(.*progressive)&#34;</span> <span class="p">|</span> awk -F <span class="s1">&#39;(&#39;</span> <span class="s1">&#39;{print $1}&#39;</span> <span class="p">|</span> awk -F <span class="s1">&#39;,&#39;</span> <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/ //g&#39;</span><span class="k">)</span> <span class="c1"># 获取像素格式</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># echo &#34;fps: ${fps}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># echo &#34;s: ${s}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># echo &#34;pix_fmt: ${pix_fmt}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="nv">$2</span> in
</span></span><span class="line"><span class="cl">	  R<span class="o">)</span>
</span></span><span class="line"><span class="cl">		  <span class="nv">dir</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="p">|</span> awk -F <span class="s1">&#39;.&#39;</span> <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">		  mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">		  ffmpeg -i <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> -vf <span class="s2">&#34;fps=</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -y <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>/%d.png
</span></span><span class="line"><span class="cl">		  <span class="nb">cd</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">		  mapfile -t files &lt; &lt;<span class="o">(</span>ls *.png <span class="p">|</span> sort -nr<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;file &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span> <span class="k">done</span> <span class="p">|</span> cat &gt; pngRlist.txt <span class="c1"># 生成帧图片的文件列表</span>
</span></span><span class="line"><span class="cl">		  ffmpeg -f concat -safe <span class="m">0</span> -i pngRlist.txt -vf palettegen -y palette.png <span class="c1"># 生成调色板</span>
</span></span><span class="line"><span class="cl">		  <span class="k">case</span> <span class="nv">$3</span> in
</span></span><span class="line"><span class="cl">			  mp4<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f image2 -f concat -safe <span class="m">0</span> -i pngRlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -vcodec <span class="s2">&#34;</span><span class="si">${</span><span class="nv">vcodec_1</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y routput.mp4 <span class="c1"># 将视频转换为倒放</span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt
</span></span><span class="line"><span class="cl">				  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">			  gif<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f concat -safe <span class="m">0</span> -i pngRlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y routput.gif <span class="c1"># 将视频转换为倒放的gif</span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt
</span></span><span class="line"><span class="cl">				  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">			  rgif<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f concat -safe <span class="m">0</span> -i pngRlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y routput.gif <span class="c1"># 将视频转换为gif</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -i routput.gif -vf <span class="s2">&#34;scale=</span><span class="si">${</span><span class="nv">4</span><span class="si">}</span><span class="s2">:-2&#34;</span> -y rsoutput.gif <span class="c1"># 缩放gif文件</span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt
</span></span><span class="line"><span class="cl">				  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">			  all<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f image2 -f concat -safe <span class="m">0</span> -i pngRlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -vcodec <span class="s2">&#34;</span><span class="si">${</span><span class="nv">vcodec_1</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y routput.mp4 <span class="c1"># 将视频转换为倒放</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f concat -safe <span class="m">0</span> -i pngRlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y routput.gif <span class="c1"># 将视频转换为倒放的gif				  </span>
</span></span><span class="line"><span class="cl">				  ffmpeg -i routput.gif -vf <span class="s2">&#34;scale=</span><span class="si">${</span><span class="nv">4</span><span class="si">}</span><span class="s2">:-2&#34;</span> -y rsoutput.gif <span class="c1"># 缩放gif文件</span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt				  
</span></span><span class="line"><span class="cl">		  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">		  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">	  N<span class="o">)</span>
</span></span><span class="line"><span class="cl">		  <span class="nv">dir</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="p">|</span> awk -F <span class="s1">&#39;.&#39;</span> <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">		  mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">		  ffmpeg -i <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> -vf <span class="s2">&#34;fps=</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -y <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>/%d.png
</span></span><span class="line"><span class="cl">		  <span class="nb">cd</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">		  mapfile -t files &lt; &lt;<span class="o">(</span>ls *.png <span class="p">|</span> sort -n<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;file &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span> <span class="k">done</span> <span class="p">|</span> cat &gt; pngNlist.txt <span class="c1"># 生成帧图片的文件列表</span>
</span></span><span class="line"><span class="cl">		  ffmpeg -f concat -safe <span class="m">0</span> -i pngNlist.txt -vf palettegen -y palette.png <span class="c1"># 生成调色板		  </span>
</span></span><span class="line"><span class="cl">		  <span class="k">case</span> <span class="nv">$3</span> in
</span></span><span class="line"><span class="cl">			  gif<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f concat -safe <span class="m">0</span> -i pngNlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y noutput.gif <span class="c1"># 将视频转换为gif				  </span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt
</span></span><span class="line"><span class="cl">				  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">			  sgif<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f concat -safe <span class="m">0</span> -i pngNlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y noutput.gif <span class="c1"># 将视频转换为gif</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -i noutput.gif -vf <span class="s2">&#34;scale=</span><span class="si">${</span><span class="nv">4</span><span class="si">}</span><span class="s2">:-2&#34;</span> -y nsoutput.gif <span class="c1"># 缩放gif文件</span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt
</span></span><span class="line"><span class="cl">				  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">			  all<span class="o">)</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -r <span class="s2">&#34;</span><span class="si">${</span><span class="nv">fps</span><span class="si">}</span><span class="s2">&#34;</span> -f concat -safe <span class="m">0</span> -i pngNlist.txt -i palette.png -pix_fmt <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pix_fmt</span><span class="si">}</span><span class="s2">&#34;</span> -crf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">crf_1</span><span class="si">}</span><span class="s2">&#34;</span> -lavfi paletteuse -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">s</span><span class="si">}</span><span class="s2">&#34;</span> -y noutput.gif <span class="c1"># 将视频转换为gif</span>
</span></span><span class="line"><span class="cl">				  ffmpeg -i noutput.gif -vf <span class="s2">&#34;scale=</span><span class="si">${</span><span class="nv">4</span><span class="si">}</span><span class="s2">:-2&#34;</span> -y nsoutput.gif <span class="c1"># 缩放gif文件</span>
</span></span><span class="line"><span class="cl">				  rm *.png
</span></span><span class="line"><span class="cl">				  rm *.txt
</span></span><span class="line"><span class="cl">		  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">		  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">	  s<span class="o">)</span>		  
</span></span><span class="line"><span class="cl">		  ffmpeg -i <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> -vf <span class="s2">&#34;scale=</span><span class="si">${</span><span class="nv">3</span><span class="si">}</span><span class="s2">:-2&#34;</span> -y soutput.gif
</span></span><span class="line"><span class="cl">		  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">	  c<span class="o">)</span>
</span></span><span class="line"><span class="cl">		  ffmpeg -i <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> -y coutput.gif
</span></span><span class="line"><span class="cl">		  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">	  cs<span class="o">)</span>
</span></span><span class="line"><span class="cl">		  ffmpeg -i <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> -y coutput.gif
</span></span><span class="line"><span class="cl">		  ffmpeg -i <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> -vf <span class="s2">&#34;scale=</span><span class="si">${</span><span class="nv">3</span><span class="si">}</span><span class="s2">:-2&#34;</span> -y csoutput.gif
</span></span><span class="line"><span class="cl">		  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-145" class="outline-5">
<h5 id="headline-145">
参考链接
</h5>
<div id="outline-text-headline-145" class="outline-text-5">
<p>
<a href="https://blog.csdn.net/weixin_37939906/article/details/107281060">FFmpeg将有序帧（图片）转换成视频（解决了生成视频后播放闪烁的问题）</a></p>
<p>
<a href="https://blog.csdn.net/m0_62599305/article/details/140483404">【ffmpeg命令入门】重新编码媒体流、设置码率、设置帧速率</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-146" class="outline-4">
<h4 id="headline-146">
1. 将视频转换为帧图片
</h4>
<div id="outline-text-headline-146" class="outline-text-4">
<p>
首先，你需要确定你想从视频中提取的帧率（fps）。可以使用 ffmpeg 提取帧图片，并指定 fps 参数：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="nv">fps</span><span class="o">=</span><span class="m">25</span> frame_%04d.png</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
这里 fps=25 表示你从视频中每秒提取 25 帧。frame_%04d.png 是帧图片的命名格式，其中 %04d 是一个四位数的递增编号（如 0001, 0002, 等等）。</p>
</div>
</div>
<div id="outline-container-headline-147" class="outline-4">
<h4 id="headline-147">
2. 将帧图片重新转换为视频
</h4>
<div id="outline-text-headline-147" class="outline-text-4">
<p>
当你把这些帧图片转换回视频时，你需要指定与提取时相同的帧率。这样可以确保视频播放的速率与原始视频一致：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -framerate <span class="m">25</span> -i frame_%04d.png -c:v libx264 -r <span class="m">25</span> output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<ul>
<li>-framerate 25 表示输入的帧图片的帧率。</li>
<li>-i frame_%04d.png 是输入的帧图片文件名格式。</li>
<li>-c:v libx264 表示使用 libx264 编码器来编码视频。</li>
<li>-r 25 是输出视频的帧率，与输入帧图片的帧率保持一致。</li>
</ul>
</div>
</div>
<div id="outline-container-headline-148" class="outline-4">
<h4 id="headline-148">
注意事项
</h4>
<div id="outline-text-headline-148" class="outline-text-4">
<ol>
<li>帧率一致性：确保提取帧时和重建视频时的帧率一致，以避免视频播放速度的变化。</li>
<li>文件命名：帧图片的命名格式应保持一致，以便 ffmpeg 能正确读取所有帧。</li>
<li>编码设置：选择合适的视频编码器和参数，以确保输出视频的质量和压缩效果。</li>
</ol>
<p>通过正确设置这些参数，你可以在帧图片和视频之间进行转换，而不会影响最终视频的播放速率。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-149" class="outline-3">
<h3 id="headline-149">
把视频拆帧的方法
</h3>
<div id="outline-text-headline-149" class="outline-text-3">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i 3.mp4 -vf <span class="nv">fps</span><span class="o">=</span><span class="m">20</span> %d.png</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
这个 ffmpeg 命令将 3.mp4 视频按每秒 20 帧的速度提取为一系列 PNG 图片。每张图片将按递增的数字命名（如 1.png, 2.png）。确保 ffmpeg 已安装并在你的 PATH 中。如果有问题，可以检查文件路径或命名格式是否正确。</p>
<div id="outline-container-headline-150" class="outline-4">
<h4 id="headline-150">
参考链接
</h4>
<div id="outline-text-headline-150" class="outline-text-4">
<p>
<a href="https://www.bilibili.com/video/BV1qt421J7MV/?spm_id_from=333.788.recommend_more_video.4&amp;vd_source=e7de88f963dcdcb94847fceb0e821942">把视频拆帧的方法 ffmpeg</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-151" class="outline-3">
<h3 id="headline-151">
用ffmpeg从多张图片生成动图
</h3>
<div id="outline-text-headline-151" class="outline-text-3">
<p>
在做笔记、写博客或者制作梗图时，我们有时需要将多张图片合成为动图。这里介绍一种使用 ffmpeg 从多张图片生成动图的方法。</p>
<p>
通过 ffmpeg -h encoder=gif 可以得知 ffmpeg 支持的 GIF 编码器仅支持 rgb8 bgr8 rgb4_byte bgr4_byte gray pal8 7 种 pixel format，不支持输入文件使用的 rg24。在 ffmpeg 将其强制转换为 rgb8 时，颜色出现偏差。</p>
<div id="outline-container-headline-152" class="outline-4">
<h4 id="headline-152">
使用调色板解决颜色偏差问题
</h4>
<div id="outline-text-headline-152" class="outline-text-4">
<div id="outline-container-headline-153" class="outline-5">
<h5 id="headline-153">
首先用以下命令生成调色板
</h5>
<div id="outline-text-headline-153" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i %d.png -vf palettegen palette.png</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
-i %d.png：指定输入文件。%d.png 表示输入文件是以 1.png, 2.png, 3.png 等格式命名的一系列图像。%d 是一个格式说明符，表示这是一个数字序列。</p>
<div id="outline-container-headline-154" class="outline-6">
<h6 id="headline-154">
如果不是以数字进行命名排列的，可以使用文件列表的方式进行操作
</h6>
<div id="outline-text-headline-154" class="outline-text-6">
<div id="outline-container-headline-155" class="outline-7">
<h7 id="headline-155">
将文件添加到列表
</h7>
<div id="outline-text-headline-155" class="outline-text-7">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  mapfile -t files &lt; &lt;<span class="o">(</span>ls <span class="p">|</span> sort<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;file &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span> <span class="k">done</span> <span class="p">|</span> cat &gt; test.txt</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-156" class="outline-8">
<h8 id="headline-156">
生成调色板
</h8>
<div id="outline-text-headline-156" class="outline-text-8">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f concat -safe <span class="m">0</span> -i test.txt -vf palettegen -y test.png</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-157" class="outline-5">
<h5 id="headline-157">
然后在生成动图时使用调色板
</h5>
<div id="outline-text-headline-157" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg  -framerate <span class="m">1</span> -i %d.png -i palette.png -lavfi paletteuse out.gif</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
-framerate 1 是用来设置帧速率为间隔1秒</p>
<div id="outline-container-headline-158" class="outline-6">
<h6 id="headline-158">
如果是文件列表方式生成的可以按照如下命令操作
</h6>
<div id="outline-text-headline-158" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -r <span class="m">1</span> -f concat -safe <span class="m">0</span> -i test.txt -i test.png -lavfi paletteuse -y test.gif</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
-r 是用来设置帧速率为间隔1秒 </p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-159" class="outline-4">
<h4 id="headline-159">
参考链接
</h4>
<div id="outline-text-headline-159" class="outline-text-4">
<p>
<a href="https://blog.caomingjun.com/ffmpeg-images-to-gif/">用ffmpeg从多张图片生成动图</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-160" class="outline-3">
<h3 id="headline-160">
FFmpeg 视频旋转处理命令
</h3>
<div id="outline-text-headline-160" class="outline-text-3">
<div id="outline-container-headline-161" class="outline-4">
<h4 id="headline-161">
ffmpeg -vf
</h4>
<div id="outline-text-headline-161" class="outline-text-4">
<p>
-vf指令是一些简单的视频过滤器。</p>
<div id="outline-container-headline-162" class="outline-5">
<h5 id="headline-162">
顺时针旋转90°
</h5>
<div id="outline-text-headline-162" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=1&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-163" class="outline-5">
<h5 id="headline-163">
逆时针旋转90°
</h5>
<div id="outline-text-headline-163" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=2&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-164" class="outline-5">
<h5 id="headline-164">
水平翻转
</h5>
<div id="outline-text-headline-164" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf hflip -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-165" class="outline-5">
<h5 id="headline-165">
水平翻转
</h5>
<div id="outline-text-headline-165" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf vflip -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-166" class="outline-5">
<h5 id="headline-166">
逆时针旋转90°后再水平翻转
</h5>
<div id="outline-text-headline-166" class="outline-text-5">
<p>
也可以理解为水平翻转后逆时针旋转90°。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=3&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
等效于</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=2,hflip&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-167" class="outline-5">
<h5 id="headline-167">
顺时针旋转90°后再水平翻转
</h5>
<div id="outline-text-headline-167" class="outline-text-5">
<p>
也可以理解为水平翻转后逆时针旋转90°</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=0&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
等效于</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=1,hflip&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-168" class="outline-5">
<h5 id="headline-168">
旋转180°
</h5>
<div id="outline-text-headline-168" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;transpose=1,transpose=1&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-169" class="outline-5">
<h5 id="headline-169">
顺时针旋转45°
</h5>
<div id="outline-text-headline-169" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i input.mp4 -vf <span class="s2">&#34;rotate=PI/4&#34;</span> -y output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
兀等于180度，可以计算不同的值进行旋转</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-170" class="outline-4">
<h4 id="headline-170">
参考链接
</h4>
<div id="outline-text-headline-170" class="outline-text-4">
<p>
<a href="https://blog.csdn.net/shaosunrise/article/details/122006306">FFmpeg 视频旋转处理命令</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-171" class="outline-3">
<h3 id="headline-171">
ffmpeg 中打印实时信息
</h3>
<div id="outline-text-headline-171" class="outline-text-3">
<p>
要在 ffmpeg 中打印实时信息，你可以使用 -loglevel 参数来调整日志详细程度。在命令中添加 -loglevel debug 将显示更详细的调试信息，包括时间戳和实时数据。示例如下：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -loglevel debug -i input.mp4 -vf <span class="s2">&#34;drawtext=fontcolor=red:fontsize=40:text=&#39;%{pts\:hms}&#39;:x=10:y=10&#34;</span> -y 17.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-172" class="outline-3">
<h3 id="headline-172">
ffplay常用参数总结
</h3>
<div id="outline-text-headline-172" class="outline-text-3">
<p>
通过ffplay播放视频时，窗口的大小规则是如何呢？</p>
<p>
答：如果拉取视频流的分辨率大于屏幕分辨率，那么ffplay播放时会将视频画面缩放至屏幕大小；如果拉取视频流的分辨率大小小于屏幕分辨率，那么ffplay播放时会按照视频分辨率的大小调整窗口大小。</p>
<p>
调整播放窗口大小</p>
<p>
答：通过-x xx -y xx的方式来调整播放窗口的大小</p>
<p>
调整播放窗口的位置</p>
<p>
答：通过-left xxx -top xxx的方式来调整播放窗口的位置，例如-left 0 -top 0来指出播放窗口在屏幕的左上角。</p>
<p>
设置播放窗口标题</p>
<p>
答：通过-window_title xxxxx 来设置窗口标题，注意不需要双引号</p>
<p>
设置播放窗口没有标题栏</p>
<p>
答：通过-noborder来取消播放窗口的标题栏，设置该选项后，播放窗口则不存在标题栏</p>
<div id="outline-container-headline-173" class="outline-4">
<h4 id="headline-173">
指定播放窗口位置和窗口大小
</h4>
<div id="outline-text-headline-173" class="outline-text-4">
<div id="outline-container-headline-174" class="outline-5">
<h5 id="headline-174">
首先录制一个时长为3秒，分辨率为960x540的视频
</h5>
<div id="outline-text-headline-174" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -t <span class="m">3</span> -f gdigrab -offset_x <span class="m">0</span> -offset_y <span class="m">0</span> -video_size 960x540 -i desktop -y out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-175" class="outline-5">
<h5 id="headline-175">
指定窗口播放位置，根据分辨率长和高的数值进行位置数值的调整
</h5>
<div id="outline-text-headline-175" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -window_title <span class="nb">test</span> -left <span class="m">960</span> -top <span class="m">540</span> out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-176" class="outline-5">
<h5 id="headline-176">
指定播放窗口的大小
</h5>
<div id="outline-text-headline-176" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -window_title <span class="nb">test</span> -x <span class="m">1000</span> -y <span class="m">1000</span> out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
最好是跟分辨率对应着进行设置，例如视频的分辨率也是960x540</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -window_title <span class="nb">test</span> -x <span class="m">960</span> -y <span class="m">540</span> out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-177" class="outline-5">
<h5 id="headline-177">
将指定位置和指定大小的选项结合起来用
</h5>
<div id="outline-text-headline-177" class="outline-text-5">
<p>
视频在屏幕右上角播放</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -window_title <span class="nb">test</span> -left <span class="m">960</span> -top <span class="m">0</span> -x <span class="m">960</span> -y <span class="m">540</span> out.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-178" class="outline-4">
<h4 id="headline-178">
参考链接
</h4>
<div id="outline-text-headline-178" class="outline-text-4">
<p>
<a href="https://blog.csdn.net/iqanchao/article/details/131995780">ffplay常用参数总结</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-179" class="outline-3">
<h3 id="headline-179">
播放 yuv 格式的视频
</h3>
<div id="outline-text-headline-179" class="outline-text-3">
<div id="outline-container-headline-180" class="outline-4">
<h4 id="headline-180">
将yuv文件转换为mp4文件
</h4>
<div id="outline-text-headline-180" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -s:v 640x480 -pix_fmt yuv420p -i input.yuv output.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-181" class="outline-4">
<h4 id="headline-181">
直接播放yuv文件
</h4>
<div id="outline-text-headline-181" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -video_size 640x480 -i video.yuv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-182" class="outline-3">
<h3 id="headline-182">
使用 ffplay 一帧一帧地播放视频
</h3>
<div id="outline-text-headline-182" class="outline-text-3">
<p>
要使用 ffplay 一帧一帧地播放视频，您可以通过在命令行中逐帧显示视频帧的方式来实现。以下是一种常见的方法：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -vf <span class="s2">&#34;select=&#39;eq(n\,FRAME_NUMBER)&#39;&#34;</span> input.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
在这个命令中，将 `FRAME_NUMBER` 替换为您想要查看的帧数（从0开始），`input.mp4` 是您的视频文件名。</p>
<p>
通过这个命令，ffplay 将加载视频并显示指定帧的内容。您可以通过不断更改 `FRAME_NUMBER` 的值来逐帧显示视频内容，从而实现一帧一帧地播放视频。</p>
<p>
需要注意的是，ffplay 是一个简单的用于播放视频和音频的工具，如果您需要更多交互性或者更复杂的播放控制，可能需要借助其他工具或编程语言来实现。</p>
</div>
</div>
<div id="outline-container-headline-183" class="outline-3">
<h3 id="headline-183">
循环播放视频
</h3>
<div id="outline-text-headline-183" class="outline-text-3">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -loop <span class="m">0</span> output_ass.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-184" class="outline-4">
<h4 id="headline-184">
命令说明
</h4>
<div id="outline-text-headline-184" class="outline-text-4">
<p>
-loop number
循环播放影片 &lt;number&gt; 次。0表示永远。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-185" class="outline-3">
<h3 id="headline-185">
ffplay倍速播放
</h3>
<div id="outline-text-headline-185" class="outline-text-3">
<div id="outline-container-headline-186" class="outline-4">
<h4 id="headline-186">
音频变速播放
</h4>
<div id="outline-text-headline-186" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -i test.mp4 -af <span class="nv">atempo</span><span class="o">=</span><span class="m">2</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-187" class="outline-4">
<h4 id="headline-187">
视频变速播放
</h4>
<div id="outline-text-headline-187" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -i test.mp4 -vf <span class="nv">setpts</span><span class="o">=</span>PTS/2</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-188" class="outline-4">
<h4 id="headline-188">
音视频同时变速
</h4>
<div id="outline-text-headline-188" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay -i test.mp4 -vf <span class="nv">setpts</span> <span class="o">=</span>PTS/2 -af <span class="nv">atempo</span> <span class="o">=</span><span class="m">2</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-189" class="outline-4">
<h4 id="headline-189">
参考链接
</h4>
<div id="outline-text-headline-189" class="outline-text-4">
<p>
<a href="https://www.cnblogs.com/vczf/p/13450998.html">FFplay命令 —- 播放与参数选项</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-190" class="outline-3">
<h3 id="headline-190">
参考链接
</h3>
<div id="outline-text-headline-190" class="outline-text-3">
<p>
<a href="https://blog.csdn.net/m0_47449768/article/details/130102406">ffmpeg安装教程（windows版）</a></p>
<p>
<a href="https://ffmpeg.github.net.cn/ffplay.html">ffplay 文档</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-191" class="outline-2">
<h2 id="headline-191">
视频裁剪与拼接命令 ( 裁剪视频命令 | h264 编码的 SPS 和 PPS 数据 | 拼接视频 - 相同编码和相同容器格式的拼接 | 拼接视频 - 不同编码和容器格式的拼接测试
</h2>
<div id="outline-text-headline-191" class="outline-text-2">
<div id="outline-container-headline-192" class="outline-3">
<h3 id="headline-192">
拼接视频 - 相同编码和相同容器格式的拼接测试
</h3>
<div id="outline-text-headline-192" class="outline-text-3">
<div id="outline-container-headline-193" class="outline-4">
<h4 id="headline-193">
拼接视频命令 - mp4 格式
</h4>
<div id="outline-text-headline-193" class="outline-text-4">
<div id="outline-container-headline-194" class="outline-5">
<h5 id="headline-194">
方法一，使用concat demuxer进行视频文件的合并
</h5>
<div id="outline-text-headline-194" class="outline-text-5">
<div id="outline-container-headline-195" class="outline-6">
<h6 id="headline-195">
将视频添加到文件列表
</h6>
<div id="outline-text-headline-195" class="outline-text-6">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  mapfile -t files &lt; &lt;<span class="o">(</span>ls <span class="p">|</span> sort<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;file &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span> <span class="k">done</span> <span class="p">|</span> cat &gt; test.txt</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-196" class="outline-6">
<h6 id="headline-196">
合并视频
</h6>
<div id="outline-text-headline-196" class="outline-text-6">
<p>
这种合并方式的适用场景是：当容器格式不支持文件层次的合并，而又不想（不需要）进行再编码的操作的时候。这种方式对源视频同样有同格式同性质的要求。其详细语法参见 <a href="https://ffmpeg.mplayerhq.hu/ffmpeg-formats.html#concat-1">这里</a> 。典型的命令示例如下：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f concat -i test.txt -c copy -y test.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
指定文件列表拼接 mp4 视频 - 拼接成功但是播放不正常</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-197" class="outline-4">
<h4 id="headline-197">
拼接视频命令 - ts 格式
</h4>
<div id="outline-text-headline-197" class="outline-text-4">
<div id="outline-container-headline-198" class="outline-5">
<h5 id="headline-198">
将mp4转换为ts
</h5>
<div id="outline-text-headline-198" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  mapfile -t files &lt; &lt;<span class="o">(</span>ls *.mp4 <span class="p">|</span> sort<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> ffmpeg -i <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> -vcodec libx264 <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">.ts&#34;</span><span class="p">;</span> <span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-199" class="outline-5">
<h5 id="headline-199">
将ts文件添加为文件列表
</h5>
<div id="outline-text-headline-199" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  mapfile -t files &lt; &lt;<span class="o">(</span>ls *.ts <span class="p">|</span> sort<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;file &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span> <span class="k">done</span> <span class="p">|</span> cat &gt; ts.txt</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-200" class="outline-5">
<h5 id="headline-200">
将ts文件进行拼接
</h5>
<div id="outline-text-headline-200" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f concat -i ts.txt -c copy output.ts</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-201" class="outline-4">
<h4 id="headline-201">
拼接视频命令 - flv 格式
</h4>
<div id="outline-text-headline-201" class="outline-text-4">
<div id="outline-container-headline-202" class="outline-5">
<h5 id="headline-202">
将mp4转换为flv
</h5>
<div id="outline-text-headline-202" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  mapfile -t files &lt; &lt;<span class="o">(</span>ls *.mp4 <span class="p">|</span> sort<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> ffmpeg -i <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> -vcodec libx264 <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">.flv&#34;</span><span class="p">;</span> <span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-203" class="outline-5">
<h5 id="headline-203">
将flv文件添加为文件列表
</h5>
<div id="outline-text-headline-203" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  mapfile -t files &lt; &lt;<span class="o">(</span>ls *.flv <span class="p">|</span> sort<span class="o">)</span><span class="p">;</span> <span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">files</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;file &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">;</span> <span class="k">done</span> <span class="p">|</span> cat &gt; flv.txt</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-204" class="outline-5">
<h5 id="headline-204">
将flv文件进行拼接
</h5>
<div id="outline-text-headline-204" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f concat -i flv.txt -c copy output.flv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-205" class="outline-3">
<h3 id="headline-205">
参考链接
</h3>
<div id="outline-text-headline-205" class="outline-text-3">
<p>
<a href="https://blog.csdn.net/shulianghan/article/details/137548821">【FFmpeg】视频裁剪与拼接命令 ( 裁剪视频命令 | h264 编码的 SPS 和 PPS 数据 | 拼接视频 - 相同编码和相同容器格式的拼接 | 拼接视频 - 不同编码和容器格式的拼接测试 )</a></p>
<p>
<a href="https://cn.linux-console.net/?p=15837">如何使用 ffmpeg 剪切和裁剪视频</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-206" class="outline-2">
<h2 id="headline-206">
手把手教你用ffmpeg制作表情包
</h2>
<div id="outline-text-headline-206" class="outline-text-2">
<div id="outline-container-headline-207" class="outline-3">
<h3 id="headline-207">
准备视频素材
</h3>
<div id="outline-text-headline-207" class="outline-text-3">
<div id="outline-container-headline-208" class="outline-4">
<h4 id="headline-208">
裁剪视频
</h4>
<div id="outline-text-headline-208" class="outline-text-4">
<p>
找到要裁剪的时间段：00:00:02，裁剪时长3秒，进行裁剪：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -ss 00:00:02 -i 7.mp4 -t 00:00:03 gif.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-209" class="outline-4">
<h4 id="headline-209">
添加文字
</h4>
<div id="outline-text-headline-209" class="outline-text-4">
<p>
ffmpeg中可以用drawtext filter为视频添加水印或添加文字，需要编译ffmpeg添加支持：</p>
<ul>
<li>使用drawtext，编译时需要加上–enable-libfreetype</li>
<li>要使用多种字体，需要加上–enable-libfontconfig</li>
<li>需要字体变形，需要加上–enable-libfribidi</li>
</ul>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i gif.mp4 -vf <span class="s2">&#34;drawtext=yellow:fontsize=40:text=&#39;Gif测试&#39;:x=(w-text_w)/2:y=h-th-20&#34;</span> -y gif_3s.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div id="outline-container-headline-210" class="outline-5">
<h5 id="headline-210">
设置文字位置：
</h5>
<div id="outline-text-headline-210" class="outline-text-5">
<ol>
<li>顶端左侧: x=0:y=0 (边缘留白10像素： x=10:y=10)</li>
<li>顶端居中: x=(w-text_w)/2:y=0 (边缘留白10像素： x=(w-text_w)/2:y=10)</li>
<li>顶端右侧: x=w-tw:y=0 (边缘留白10像素: x=w-tw-10:y=10)</li>
<li>画面中心: x=(w-text_w)/2:y=(h-text_h)/2</li>
<li>底端左侧: x=0:y=h-th (边缘留白10像素: x=10:y=h-th-10)</li>
<li>底端居中: x=(w-text_w)/2:y=h-th (边缘留白10像素: x=(w-text_w)/2:y=h-th-10)</li>
<li>底端右侧: x=w-tw:y=h-th (边缘留白10像素: x=w-tw-10:y=h-th-10)</li>
</ol>
</div>
</div>
<div id="outline-container-headline-211" class="outline-5">
<h5 id="headline-211">
如果有多句话，可以指定时间段进行添加
</h5>
<div id="outline-text-headline-211" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i gif.mp4 -vf <span class="s2">&#34;drawtext=enable=&#39;between(t,0,1)&#39;:fontcolor=yellow:fontsize=40:text=&#39;hello&#39;:x=(w-text_w)/2:y=h-th-20&#34;</span>,<span class="s2">&#34;drawtext=enable=&#39;between(t,1,2)&#39;:fontcolor=yellow:fontsize=40:text=&#39;world&#39;:x=(w-text_w)/2:y=h-th-20&#34;</span> -y out_3s.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<ul>
<li>enable=&#39;between(t,0,1)&#39; 指定的是在0s-1s之间添加文字。</li>
<li>enable=&#39;between(t,1,2)&#39; 指定的是在1s-2s之间添加文字。</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-212" class="outline-4">
<h4 id="headline-212">
缩放视频尺寸
</h4>
<div id="outline-text-headline-212" class="outline-text-4">
<p>
裁剪好后的源视频是1920x1080 1080格式的，做成gif可能有点大，需要先进行缩放：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i gif_3s.mp4 -vf <span class="s2">&#34;scale=360:-2&#34;</span> -y small_3s.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
注意 sacle 值必须是偶数，这里的 -2 表示要求压缩出来的视频尺寸长宽都保持为偶数.如果需要保持长宽比，根据宽度值自适应高度，可以使用 -1。</p>
<p>
我这里只进行缩小就可以了，你也可能有加速播放和慢速播放的需要，也可以用实现。</p>
<div id="outline-container-headline-213" class="outline-5">
<h5 id="headline-213">
加倍速播放视频
</h5>
<div id="outline-text-headline-213" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i small_3s.mp4 -filter:v <span class="s2">&#34;setpts=0.5*PTS&#34;</span> out_speedup.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-214" class="outline-5">
<h5 id="headline-214">
定义帧率 16fps
</h5>
<div id="outline-text-headline-214" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i small_3s.mp4 -r <span class="m">16</span> -an -y out_16_fps.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
-an 选项表示“去除音频”。在你的命令中，-an 会移除视频文件 out_3s.mp4 的音频流，只保留视频流。</p>
</div>
</div>
<div id="outline-container-headline-215" class="outline-5">
<h5 id="headline-215">
慢倍速播放视频
</h5>
<div id="outline-text-headline-215" class="outline-text-5">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i gif_3s.mp4 -filter:v <span class="s2">&#34;setpts=2.0*PTS&#34;</span> out_slowdown.mp4</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-216" class="outline-4">
<h4 id="headline-216">
将视频 MP4 转化为 GIF
</h4>
<div id="outline-text-headline-216" class="outline-text-4">
<p>
经过以上步骤，已经有了我们处理完成的视频文件，只需要转换成gif即可</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i small_3s.mp4 small.gif</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
转化成gif默认转换是中等质量的，压缩的比较厉害，可以修改比特率提高gif质量：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i small_3s.mp4 -b 2048k -y small_3s.gif</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
统过以上步骤就完成了我们要制作的gif，ffmpeg的生态比较丰富，目前很多在线制作表情包的网站和一些Telegram上的bot，就是通过ffmpeg进行制作。也可以找其它的视频进行制作，比如，张学友：食屎啦你、有钱真的可以为所欲为、王镜泽： 真香 等等。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-217" class="outline-3">
<h3 id="headline-217">
mp4转gif
</h3>
<div id="outline-text-headline-217" class="outline-text-3">
<div id="outline-container-headline-218" class="outline-4">
<h4 id="headline-218">
转换命令
</h4>
<div id="outline-text-headline-218" class="outline-text-4">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -i test.mp4 -y test.gif</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-219" class="outline-4">
<h4 id="headline-219">
参考链接
</h4>
<div id="outline-text-headline-219" class="outline-text-4">
<p>
<a href="https://cloud.tencent.com/developer/article/2161440">利用 FFmpeg 将视频转换为 GIF 操作指北</a></p>
<p>
<a href="https://opswill.com/articles/ffmpeg-convert-video-to-gif.html">手把手教你用ffmpeg制作表情包</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-220" class="outline-2">
<h2 id="headline-220">
使用ffplay拉流RSTP-海康威视摄像机
</h2>
<div id="outline-text-headline-220" class="outline-text-2">
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffplay rtsp://admin:qingyikeji1@192.168.0.64:554/h264/ch1/main/av_stream</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-221" class="outline-2">
<h2 id="headline-221">
windows环境下实现ffmpeg本地视频进行rtsp推流
</h2>
<div id="outline-text-headline-221" class="outline-text-2">
<p>
摘要：有时候服务端（如linux）或者边缘端（jetson盒子）需要接受摄像头的视频流输入，而摄像头的输入视频流一般为rtsp，测试时需要搭建摄像头环境，很不方便，因此需要对本地视频进行rtsp推流，模拟摄像头的rtsp输入。</p>
<div id="outline-container-headline-222" class="outline-3">
<h3 id="headline-222">
环境搭建
</h3>
<div id="outline-text-headline-222" class="outline-text-3">
<div id="outline-container-headline-223" class="outline-4">
<h4 id="headline-223">
系统环境
</h4>
<div id="outline-text-headline-223" class="outline-text-4">
<p>
本地使用windows11 64位</p>
</div>
</div>
<div id="outline-container-headline-224" class="outline-4">
<h4 id="headline-224">
下载rtsp
</h4>
<div id="outline-text-headline-224" class="outline-text-4">
<p>
<a href="https://github.com/bluenviron/mediamtx/releases/latest">rtsp下载地址</a></p>
<p>
<img src="/images/ffmpeg教程/png1.png" alt="/images/ffmpeg教程/png1.png" title="/images/ffmpeg教程/png1.png" /></p>
</div>
</div>
<div id="outline-container-headline-225" class="outline-4">
<h4 id="headline-225">
下载ffmpeg
</h4>
<div id="outline-text-headline-225" class="outline-text-4">
<p>
<a href="https://github.com/BtbN/FFmpeg-Builds/releases/latest">ffmpeg下载地址</a></p>
<p>
<img src="/images/ffmpeg教程/png2.png" alt="/images/ffmpeg教程/png2.png" title="/images/ffmpeg教程/png2.png" /></p>
</div>
</div>
<div id="outline-container-headline-226" class="outline-4">
<h4 id="headline-226">
把rtsp和ffmpeg解压到同一个文件夹
</h4>
<div id="outline-text-headline-226" class="outline-text-4">
<p>
把上面下载的两个压缩包解压到同一个文件夹，视频也放到该文件夹目录下，如下图所示：</p>
<p>
<img src="/images/ffmpeg教程/png3.png" alt="/images/ffmpeg教程/png3.png" title="/images/ffmpeg教程/png3.png" /></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-227" class="outline-3">
<h3 id="headline-227">
ffmpeg对本地视频进行rtsp推流
</h3>
<div id="outline-text-headline-227" class="outline-text-3">
<div id="outline-container-headline-228" class="outline-4">
<h4 id="headline-228">
启动rtsp
</h4>
<div id="outline-text-headline-228" class="outline-text-4">
<p>
双击点开mediamtx.exe，得到如下图画面：</p>
<p>
<img src="/images/ffmpeg教程/png4.png" alt="/images/ffmpeg教程/png4.png" title="/images/ffmpeg教程/png4.png" /></p>
</div>
</div>
<div id="outline-container-headline-229" class="outline-4">
<h4 id="headline-229">
ffpmeg推流本地视频
</h4>
<div id="outline-text-headline-229" class="outline-text-4">
<p>
打开cmd终端(win+r，输入cmd, 回车)，进入到ffmpeg.exe所在路径，使用以下命令：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -re -stream_loop -1 -i normal_78.mp4 -c copy -f rtsp rtsp://127.0.0.1:8554/video</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
<img src="/images/ffmpeg教程/png5.png" alt="/images/ffmpeg教程/png5.png" title="/images/ffmpeg教程/png5.png" /></p>
<p>
注意：这里ip为本地环境IP，可以在cmd终端输入ipconfig查看。</p>
<div id="outline-container-headline-230" class="outline-5">
<h5 id="headline-230">
ffpmeg常用参数
</h5>
<div id="outline-text-headline-230" class="outline-text-5">
<div class="table-wrapper"><table>
<thead>
<tr>
<th>-re</th>
<th>以流的方式读取</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i</td>
<td>输入视频</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-f</td>
<td>格式化输出到哪里</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-stream_loop</td>
<td>循环读取视频源的次数，-l为无线循环</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-c</td>
<td>指定编码器</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-c copy</td>
<td>直接复制，不经过重新编码（较快）</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-c:v</td>
<td>指定视频编码器</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-c:a</td>
<td>指定音频编码器</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-vn</td>
<td>去除视频流</td>
</tr>
</tbody>
<tbody>
<tr>
<td>-an</td>
<td>去除音频流</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-231" class="outline-4">
<h4 id="headline-231">
使用vlc验证是否推流成功
</h4>
<div id="outline-text-headline-231" class="outline-text-4">
<ol>
<li>下载vlc软件并安装:</li>
</ol>
<p><img src="/images/ffmpeg教程/png6.png" alt="/images/ffmpeg教程/png6.png" title="/images/ffmpeg教程/png6.png" /></p>
<ol>
<li>打开vlc，点击媒体-&gt;打开网络串流-&gt;输入网路url：rtsp://127.0.0.1:8554/video</li>
</ol>
<p><img src="/images/ffmpeg教程/png7.png" alt="/images/ffmpeg教程/png7.png" title="/images/ffmpeg教程/png7.png" /></p>
<p>
如果能正常播放视频，证明推流成功，服务端或者边缘端可以使用ur进行rtsp来推流。</p>
<p>
<img src="/images/ffmpeg教程/png8.png" alt="/images/ffmpeg教程/png8.png" title="/images/ffmpeg教程/png8.png" /></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-232" class="outline-3">
<h3 id="headline-232">
参考链接
</h3>
<div id="outline-text-headline-232" class="outline-text-3">
<p>
<a href="https://blog.csdn.net/Caesar6666/article/details/137512406">windows环境下实现ffmpeg本地视频进行rtsp推流</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-233" class="outline-2">
<h2 id="headline-233">
在Windows操作系统上使用mediamtx和ffmpeg推送录屏视频流
</h2>
<div id="outline-text-headline-233" class="outline-text-2">
<div id="outline-container-headline-234" class="outline-3">
<h3 id="headline-234">
搭建启动rtsp server
</h3>
<div id="outline-text-headline-234" class="outline-text-3">
<p>
从<a href="https://github.com/bluenviron/mediamtx/releases/latest">https://github.com/bluenviron/mediamtx/releases/latest</a>下载Windows版本的编译结果。</p>
<p>
<img src="/images/ffmpeg教程/png1.png" alt="/images/ffmpeg教程/png1.png" title="/images/ffmpeg教程/png1.png" /></p>
<p>
解压，然后启动该程序</p>
<p>
<img src="/images/ffmpeg教程/png4.png" alt="/images/ffmpeg教程/png4.png" title="/images/ffmpeg教程/png4.png" /></p>
</div>
</div>
<div id="outline-container-headline-235" class="outline-3">
<h3 id="headline-235">
推送录屏视频流
</h3>
<div id="outline-text-headline-235" class="outline-text-3">
<p>
下载FFmpeg</p>
<p>
从<a href="https://github.com/BtbN/FFmpeg-Builds/releases/latest">https://github.com/BtbN/FFmpeg-Builds/releases/latest</a>下载Windows版本的编译结果。</p>
<p>
<img src="/images/ffmpeg教程/png2.png" alt="/images/ffmpeg教程/png2.png" title="/images/ffmpeg教程/png2.png" /></p>
<p>
解压后，通过cmd进入FFmpeg所在的目录，执行下面的命令（其中rtsp://localhost:8554/mystream是上一步生成的地址）。</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f gdigrab -framerate <span class="m">10</span> -i desktop -f rtsp -g <span class="m">5</span> -an rtsp://localhost:8554/mystream</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
我们可以看到console会出现下面的变化。</p>
<p>
<img src="/images/ffmpeg教程/png9.png" alt="/images/ffmpeg教程/png9.png" title="/images/ffmpeg教程/png9.png" /></p>
<p>
rstp simple server的窗口会发生下面的变化。</p>
<p>
<img src="/images/ffmpeg教程/png10.png" alt="/images/ffmpeg教程/png10.png" title="/images/ffmpeg教程/png10.png" /></p>
</div>
</div>
<div id="outline-container-headline-236" class="outline-3">
<h3 id="headline-236">
检验
</h3>
<div id="outline-text-headline-236" class="outline-text-3">
<div id="outline-container-headline-237" class="outline-4">
<h4 id="headline-237">
获取本机IP
</h4>
<div id="outline-text-headline-237" class="outline-text-4">
<p>
在cmd中使用ipconfig获取本机IP</p>
</div>
</div>
<div id="outline-container-headline-238" class="outline-4">
<h4 id="headline-238">
检测
</h4>
<div id="outline-text-headline-238" class="outline-text-4">
<p>
可以使用VLC播放器测试流地址是否有效。</p>
<p>
<img src="/images/ffmpeg教程/png11.png" alt="/images/ffmpeg教程/png11.png" title="/images/ffmpeg教程/png11.png" /></p>
<p>
填入rtsp://127.0.0.1:8554/mystream。注意此处不能再使用localhost了，而是要用本机的IP。</p>
<p>
<img src="/images/ffmpeg教程/png12.png" alt="/images/ffmpeg教程/png12.png" title="/images/ffmpeg教程/png12.png" /></p>
<p>
在VCL中能看到屏幕就代表我们方案是通过的。</p>
<p>
<img src="/images/ffmpeg教程/png13.png" alt="/images/ffmpeg教程/png13.png" title="/images/ffmpeg教程/png13.png" /></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-239" class="outline-3">
<h3 id="headline-239">
参考链接
</h3>
<div id="outline-text-headline-239" class="outline-text-3">
<p>
<a href="https://blog.csdn.net/wujiesunlirong/article/details/134804329">在Windows操作系统上使用mediamtx和ffmpeg推送录屏视频流</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-240" class="outline-2">
<h2 id="headline-240">
RTSP 和 RTMP原理 &amp; 通过ffmpeg实现将本地摄像头推流到RTSP服务器
</h2>
<div id="outline-text-headline-240" class="outline-text-2">
<div id="outline-container-headline-241" class="outline-3">
<h3 id="headline-241">
流媒体：RTSP 和 RTMP
</h3>
<div id="outline-text-headline-241" class="outline-text-3">
<div id="outline-container-headline-242" class="outline-4">
<h4 id="headline-242">
参考资料
</h4>
<div id="outline-text-headline-242" class="outline-text-4">
<p>
<a href="https://blog.csdn.net/weixin_43025343/article/details/124957360">秒懂流媒体协议 RTMP 与 RTSP</a></p>
<p>
<a href="https://blog.csdn.net/daocaokafei/article/details/127098972">什么是RTMP 和 RTSP？它们之间有什么区别？</a></p>
<p>
<a href="https://www.cnblogs.com/biao-wu/articles/13064243.html">RTSP和RTMP的区别是什么？</a></p>
</div>
</div>
<div id="outline-container-headline-243" class="outline-4">
<h4 id="headline-243">
RTSP 和 RTMP的工作原理
</h4>
<div id="outline-text-headline-243" class="outline-text-4">
<div id="outline-container-headline-244" class="outline-5">
<h5 id="headline-244">
RTSP工作原理
</h5>
<div id="outline-text-headline-244" class="outline-text-5">
<ol>
<li>用户设备向视频流平台发送 RTSP 请求</li>
<li>视频流平台返回可以操作的请求列表，比如播放、暂停等</li>
<li>用户设备向视频流平台发送具体的请求，比如播放</li>
<li>视频流平台解析请求并调用指定机制启动视频流处理</li>
<li>由于 RTSP 依赖于专用服务器，并且依赖于 RTP（底层用到了UDP），因此该协议不支持加密视频内容或重传丢失的数据包。</li>
</ol>
<div id="outline-container-headline-245" class="outline-6">
<h6 id="headline-245">
这里解释一下RTSP中是如何用到UDP和TCP的：
</h6>
<div id="outline-text-headline-245" class="outline-text-6">
<ol>
<li>RTP协议，英文全称：Real-time Transport Protocol，中文就是实时传输协议，它的底层其实就是UDP，这样一来就可以实现低延迟。</li>
<li>
<p>除了RTP协议，为确保流畅和一致的流传输，RTSP 还使用另外两种网络通信协议：</p>
<ol>
<li>TCP 收发控制命令（例如播放或停止请求）：TCP可靠传输，比如用户按下播放或者停止播放的时候，这个是个准确的请求，这个需要保证可靠性，这个时候TCP作用就体现了。</li>
<li>UDP传送音频、视频和数据：UDP是低延迟的协议，那么用于传送音频、视频和数据可以达到非常高效的效果。</li>
</ol>
</li>
</ol>
<p>这里可以通过<a href="https://github.com/aler9/rtsp-simple-server/releases">开源的rtsp服务器</a>可以简单理解：TCP监听端口为8554，UDP监听端口为8000</p>
<p>
<img src="/images/ffmpeg教程/png4.png" alt="/images/ffmpeg教程/png4.png" title="/images/ffmpeg教程/png4.png" /></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-246" class="outline-5">
<h5 id="headline-246">
RTMP工作原理
</h5>
<div id="outline-text-headline-246" class="outline-text-5">
<ol>
<li>摄像头捕获视频</li>
<li>通过编码器将视频流传输到视频平台服务器</li>
<li>视频平台处理视频流</li>
<li>通过CDN分发到离用户最近的服务器上</li>
<li>最后视频流就能成功的到达用户设备</li>
</ol>
<p><img src="/images/ffmpeg教程/png15.png" alt="/images/ffmpeg教程/png15.png" title="/images/ffmpeg教程/png15.png" /></p>
<p>
在视频从摄像头到服务器的过程中，RTMP将大量数据分割成小块并跨多个虚拟通道传输（内容分发网络CDN），在视频源和 RTMP 服务器之间提供了稳定和流畅的视频流。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-247" class="outline-4">
<h4 id="headline-247">
RTSP 和 RTMP的优缺点
</h4>
<div id="outline-text-headline-247" class="outline-text-4">
<div id="outline-container-headline-248" class="outline-5">
<h5 id="headline-248">
RTSP的优缺点
</h5>
<div id="outline-text-headline-248" class="outline-text-5">
<p>
RTSP的优点：</p>
<ol>
<li>轻松自定义流：可以通过结合不同的协议来开发自己的视频流解决方案。</li>
<li>分段流式传输：RTSP 流使观看者能够在下载完成之前访问的视频内容，而不必下载完整的视频以流式传输内容。</li>
</ol>
<p>RTSP的缺点：</p>
<ol>
<li>与 HTTP不兼容：没有简单的解决方案可以在 Web 浏览器中播放 RTSP流，因为 RTSP 旨在通过私有网络流式传输视频，必须借用额外软件。</li>
<li>使用率低：由于视频播放器和流媒体服务并未广泛支持 RTSP 流媒体，因为使用率比较低。</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-249" class="outline-4">
<h4 id="headline-249">
RTMP的优缺点
</h4>
<div id="outline-text-headline-249" class="outline-text-4">
<div id="outline-container-headline-250" class="outline-5">
<h5 id="headline-250">
RTMP的优点：
</h5>
<div id="outline-text-headline-250" class="outline-text-5">
<ol>
<li>低延迟：RTMP使用独占的 1935 端口，无需缓冲，可以实现低延迟。</li>
<li>适应性强：所有 RTMP 服务器都可以录制直播媒体流，同时还允许观众跳过部分广播并在直播开始后加入直播流。</li>
<li>灵活性：RTMP 支持整合文本、视频和音频，支持 MP3 和 AAC 音频流，也支持MP4、FLV 和 F4V 视频。</li>
</ol>
</div>
</div>
<div id="outline-container-headline-251" class="outline-5">
<h5 id="headline-251">
RTMP的缺点：
</h5>
<div id="outline-text-headline-251" class="outline-text-5">
<ol>
<li>HTML5 不支持：标准HTML5 播放器不支持 RTMP 流。</li>
<li>容易受到带宽问题的影响：RTMP 流经常会出现低带宽问题，造成视频中断。</li>
<li>HTTP 不兼容：无法通过 HTTP 流式传输 RTMP，必须需要实现一个特殊的服务器，并使用第三方内容交付网络或使用流媒体视频平台。</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-252" class="outline-4">
<h4 id="headline-252">
RTSP和RTMP的比较
</h4>
<div id="outline-text-headline-252" class="outline-text-4">
<p>
RTMP 和 RTSP协议 都是流媒体协议：</p>
<ol>
<li>RTMP（Real Time Message Protocol 实时消息传递协议） 有 Adobe 公司提出，用来解决多媒体数据传输流的多路复用（Multiplexing）和分包（packetizing）的问题，优势在于低延迟，稳定性高，支持所有摄像头格式，浏览器加载 flash插件就可以直接播放。</li>
<li>RTSP （Real-Time Stream Protocol 实时流协议）由Real Networks 和 Netscape共同提出的，基于文本的多媒体播放控制协议。RTSP定义流格式，流数据经由RTP传输；RTSP实时效果非常好，适合视频聊天，视频监控等方向。</li>
</ol>
<div id="outline-container-headline-253" class="outline-5">
<h5 id="headline-253">
RTMP 和 RTSP协议 的区别：
</h5>
<div id="outline-text-headline-253" class="outline-text-5">
<p>
RTSP虽然实时性最好，但是实现复杂，适合视频聊天和视频监控；</p>
<p>
RTMP强在浏览器支持好，加载flash插件后就能直接播放，所以非常火，相反在浏览器里播放rtsp就很困难了。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-254" class="outline-4">
<h4 id="headline-254">
RTSP和RTMP如何选择
</h4>
<div id="outline-text-headline-254" class="outline-text-4">
<ol>
<li>IP 摄像机选择RTSP：几乎所有 IP 摄像机都支持 RTSP，这是因为 IP 摄像机早在 RTMP 协议创建之前就已经存在，与 RTSP 和 IP 摄像机结合使用时，IP 摄像机本身充当 RTSP 服务器，这意味着要将摄像机连接到 IP 摄像机服务器并广播视频。</li>
<li>物联网设备选择RTSP：RTSP 通常内置在无人机或物联网软件中，从而可以访问视频源，它的好处之一是低延迟，确保视频中没有延迟，这对于无人机来说至关重要。</li>
<li>流媒体应用程序选择RTMP：比如各种短视频软件、视频直播软件等都内置了RTMP，RTMP 是为满足现代流媒体需求而设计的。</li>
</ol>
</div>
</div>
<div id="outline-container-headline-255" class="outline-4">
<h4 id="headline-255">
如何在浏览器上播放RTSP
</h4>
<div id="outline-text-headline-255" class="outline-text-4">
<ol>
<li>直播的协议有：rtmp, http, rtsp等等。最常用的有二种：http, rtmp，当使用http协议的时候视频格式需要是m3u8或flv，下面作详细说明各种环境的优缺点。首先，rtsp不能使用于网页环境（包含PC端和移动端），那么直播只能选择rtmp或http。</li>
<li>rtmp协议只支持flashplayer，也就是只能在PC端（或安卓环境中安装了flashplayer组件，这种环境比较少）安装了flashplayer的情况下使用。按现在的趋势，flashplayer是要逐渐被淘汰掉的。当然，在中国还会存在相对长时间。</li>
<li>http协议的直播分二种格式，m3u8和flv。flv是一种即将被淘汰的直播格式。用来做直播已显的力不从心了。所以综合考虑，m3u8相对的比较好点，优点是支持移动端，并且支持PC端上安装了flashplayer的环境。缺点就如同rtmp一样。flashplayer并不是未来的发展趋势。另外一个缺点就是m3u8是有延迟的。并不能实时，实时传输方面不如rtmp协议。因为 m3u8的直播原理是将直播源不停的压缩成指定时长的ts文件（比如9秒，10秒一个ts文件）并同时实时更新m3u8文件里的列表以达到直播的效果。这样就会有一个至少9,10秒的时间延迟。如果压缩的过小，可能导致客户端网络原因致视频变卡。</li>
<li>实现rtsp转http并使用m3u8格式进行直播 可以参考<a href="https://www.youtube.com/watch?v=rgWVm_j3llo&amp;list=LL">RTSP Webcam to HLS Live Streaming using FFMPEG and XAMPP | PART 1</a></li>
</ol>
<p>具体过程：外接支持rtsp的webcam；使用ffplay命令来播放rtsp流，可以根据参数将实时视频写入到指定文件夹中（分段写入）；xampp开启apache（开启80端口），可以让页面通过保存的m3u8文件实时访问webcam的监控界面。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-256" class="outline-3">
<h3 id="headline-256">
ffmpeg将本地摄像头推流到RTSP服务器
</h3>
<div id="outline-text-headline-256" class="outline-text-3">
<div id="outline-container-headline-257" class="outline-4">
<h4 id="headline-257">
ffmpeg参考资料
</h4>
<div id="outline-text-headline-257" class="outline-text-4">
<p>
<a href="https://ffmpeg.org/ffmpeg-protocols.html">FFmpeg Protocols Documentation</a></p>
<p>
<a href="https://ffmpeg.org/ffmpeg-protocols.html">FFmpeg中文文档</a></p>
<p>
<a href="https://zhuanlan.zhihu.com/p/545070185">FFmpeg流媒体处理-收流与推流</a></p>
<p>
<a href="https://blog.51cto.com/u_3619476/5019788">FFmpeg发送流媒体的命令（UDP，RTP，RTMP）</a></p>
<div id="outline-container-headline-258" class="outline-5">
<h5 id="headline-258">
ffmpeg将本地摄像头推流到RTSP服务器
</h5>
<div id="outline-text-headline-258" class="outline-text-5">
<p>
<a href="https://blog.csdn.net/fkbiubiubiu/article/details/124028614">ffmpeg–使用命令+EasyDarwin推流笔记本摄像头</a></p>
<p>
<a href="https://blog.csdn.net/EthanCo/article/details/125321957">windows环境下，搭建RTSP视频推流服务器</a></p>
<p>
<a href="https://blog.csdn.net/qq_43994782/article/details/118941373">windows环境下python使用ffmpeg rtsp推流</a></p>
<p>
<a href="https://blog.csdn.net/yinshipin007/article/details/125982017">一个RtspServer的设计与实现和RTSP2.0简介</a></p>
<p>
<a href="https://www.youtube.com/watch?v=rgWVm_j3llo&amp;list=LL">RTSP Webcam to HLS Live Streaming using FFMPEG and XAMPP | PART 1</a></p>
<p>
Note：ffmpeg将本地摄像头推流到rtsp的8554端口上（rtsp-simple-server在处理rtsp时，监听的是8554端口，指定其他端口ffmpeg推流会失败)</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-259" class="outline-4">
<h4 id="headline-259">
安装ffmpeg和rtsp-simple-server
</h4>
<div id="outline-text-headline-259" class="outline-text-4">
<p>
大致实现过程：使用rtsp-simple-server作为中转服务器，用于ffmpeg（写客户端）推流，后台服务（读客户端）拉流</p>
<div id="outline-container-headline-260" class="outline-5">
<h5 id="headline-260">
windows安装rtsp-simple-server和ffmpeg
</h5>
<div id="outline-text-headline-260" class="outline-text-5">
<p>
参考<a href="https://blog.csdn.net/EthanCo/article/details/125321957">windows环境下，搭建RTSP视频推流服务器</a>即可（记得修改rtsp-simple-server.yml配置文件中的ip地址）</p>
</div>
</div>
<div id="outline-container-headline-261" class="outline-5">
<h5 id="headline-261">
linux安装rtsp-simple-server和ffmpeg
</h5>
<div id="outline-text-headline-261" class="outline-text-5">
<p>
安装<a href="https://github.com/aler9/rtsp-simple-server/releases/download/v0.20.2/rtsp-simple-server_v0.20.2_linux_amd64.tar.gz">rtsp-simple-server_v0.20.2_linux_amd64.tar.gz</a>（这里以x86 CPU为例），解压后修改rtsp-simple-server.yml配置文件中的ip地址（vim替换命令为%s:/127.0.0.1/192.168.132.100/g），执行./rtsp-simple-server即可启动rtsp服务器。</p>
<p>
如果要想在后台启动rtsp服务器，执行如下命令</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  nohup ./rtsp-simple-server &gt;&gt; rtsp_server.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>  <span class="c1">#非挂起启动命令</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
tail rtsp_server.log  #查看rtsp-simple-server启动日志文件</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ps -aux <span class="p">|</span> grep rtsp_simple_server  <span class="c1">#查看rtsp-simple-server进程</span>
</span></span><span class="line"><span class="cl">  dpf        <span class="m">2116</span>  0.0  0.0  <span class="m">13140</span>  <span class="m">1016</span> pts/0    S+   04:54   0:00 grep --color<span class="o">=</span>auto rtsp_simple_server</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
ffmpeg安装地址如下<a href="https://johnvansickle.com/ffmpeg/">https://johnvansickle.com/ffmpeg/</a>，解压后执行./ffmpeg即可使用ffmpeg，参考<a href="https://blog.csdn.net/weixin_42010722/article/details/126951341">在linux下使用ffmpeg方法</a></p>
<p>
Note：在linux中关于tar.gz，xz，tar的解压操作请自行上网查阅。</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-262" class="outline-4">
<h4 id="headline-262">
将本地摄像头推流到RTSP服务器
</h4>
<div id="outline-text-headline-262" class="outline-text-4">
<p>
大致实现过程：使用rtsp-simple-server作为中转服务器，用于ffmpeg（写客户端）推流，后台服务（读客户端）拉流</p>
<p>
这里以windows系统作为演示，先解压<a href="https://github.com/aler9/rtsp-simple-server/releases">rtsp-simple-server_v0.19.1_windows_amd64.zip</a>，打开rtsp-simple-server.exe监听RTSP下TCP的8554端口，然后通过ffmpeg将指定摄像头采集到的图像帧向该端口进行推流（即多个客户端与服务器端的socket通信）</p>
<div id="outline-container-headline-263" class="outline-5">
<h5 id="headline-263">
写客户端：ffmpeg
</h5>
<div id="outline-text-headline-263" class="outline-text-5">
<p>
ffmpeg推流视频文件到指定ip + 端口上（-stream_loop -1）：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -re -stream_loop -1 -i 你视频的文件名 -c copy -f rtsp rtsp://127.0.0.1:8554/videoFile_test</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
ffmpeg将本地摄像头的视频流推送到指定ip + 端口上，则需要</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  //获取本地摄像头名称
</span></span><span class="line"><span class="cl">  ffmpeg -list_devices <span class="nb">true</span> -f dshow -i dummy  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  //ffmpeg向指定端口推流（我的是Integrated Camera）
</span></span><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;自己的摄像头驱动名称&#34;</span> -vcodec libx264 -preset:v ultrafast -tune:v zerolatency -rtsp_transport tcp -f rtsp rtsp://127.0.0.1:8554/camera_test
</span></span><span class="line"><span class="cl">  //libx264编码
</span></span><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;Integrated Camera&#34;</span> -vcodec libx264 -preset:v ultrafast -tune:v zerolatency -rtsp_transport tcp -f rtsp rtsp://127.0.0.1:8554/camera_test</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-264" class="outline-5">
<h5 id="headline-264">
服务器端：RTSP服务器
</h5>
<div id="outline-text-headline-264" class="outline-text-5">
<p>
初启动效果如下：</p>
<p>
<img src="/images/ffmpeg教程/png4.png" alt="/images/ffmpeg教程/png4.png" title="/images/ffmpeg教程/png4.png" /></p>
<p>
开启两个ffmpeg模拟两个写客户端，完成摄像头采集视频帧的推流和本地视频文件的推流</p>
<p>
该过程会出现两个createby和publishing，在不同文件路径下写入图像帧，可以通过指定进程（ip+端口）来处理（这里新创建了56725和56732两个进程来处理），而RTSP的监听端口仍然是8554，这样可以实现非阻塞通信。</p>
<p>
<img src="/images/ffmpeg教程/png16.png" alt="/images/ffmpeg教程/png16.png" title="/images/ffmpeg教程/png16.png" /></p>
</div>
</div>
<div id="outline-container-headline-265" class="outline-5">
<h5 id="headline-265">
读客户端：读客户端可以通过两种方式来实现
</h5>
<div id="outline-text-headline-265" class="outline-text-5">
<p>
安装VLC，选择流数据播放模式，输入rtsp://127.0.0.1:8554/camera_test，rtsp://127.0.0.1:8554/videoFile_test即可播放；</p>
<p>
<code class="verbatim">通过OBS的虚拟摄像头，将终端打印信息接入到虚拟摄像头中，再通过ffmpeg将虚拟摄像头中的内容推流出来，最后通过VLC拉流查看效果</code></p>
<p>
<img src="/images/ffmpeg教程/png17.png" alt="/images/ffmpeg教程/png17.png" title="/images/ffmpeg教程/png17.png" /></p>
<p>
亦或者使用如下python代码：</p>
<div class="src src-python">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cv2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">capture_video</span><span class="p">(</span><span class="n">rtsp_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">rtsp_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">rtsp_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">capture</span><span class="o">.</span><span class="n">isOpened</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># rtsp_paths = [&#39;rtsp://127.0.0.1:8554/videoFile_test&#39;,&#39;rtsp://127.0.0.1:8554/camera_test&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">rtsp_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rtsp://127.0.0.1:8554/videoFile_test&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">rtsp_path</span> <span class="ow">in</span> <span class="n">rtsp_paths</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">capture_video</span><span class="p">(</span><span class="n">rtsp_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
此时会出现两个createby和reading，即开启两个进程进行视频流的读取</p>
</div>
</div>
<div id="outline-container-headline-266" class="outline-5">
<h5 id="headline-266">
存在问题：视频读取时延大
</h5>
<div id="outline-text-headline-266" class="outline-text-5">
<p>
基于tcp和RTP的rtsp直播延迟很高，一开始延迟只有7s，由于TCP的拥塞控制，导致随着时间推移，延迟越来越高，有14s之多。</p>
<div id="outline-container-headline-267" class="outline-6">
<h6 id="headline-267">
可能原因1：视频编码导致延迟高（亲测效果不明显）
</h6>
<div id="outline-text-headline-267" class="outline-text-6">
<p>
参考<a href="https://blog.csdn.net/yuxinaibiancheng/article/details/119884095">ffmpeg直播解决延时的关键方法</a>，主要原因是使用libx264或者h264对视频进行编码的问题。</p>
<p>
解决方法参考<a href="https://blog.csdn.net/fkbiubiubiu/article/details/124028614">ffmpeg–使用命令+EasyDarwin推流笔记本摄像头</a></p>
<p>
//h264_qsv编码（比libx264编码快点）</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;Integrated Camera&#34;</span> -vcodec h264_qsv -tune:v zerolatency -rtsp_transport tcp -f rtsp rtsp://127.0.0.1:8554/camera_test</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
//不使用编码器，直接推送（但是很模糊）</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;Integrated Camera&#34;</span> -rtsp_transport tcp -f rtsp rtsp://127.0.0.1:8554/camera_test</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-268" class="outline-6">
<h6 id="headline-268">
可能原因2：设置ffmpeg参数（亲测效果不明显）
</h6>
<div id="outline-text-headline-268" class="outline-text-6">
<p>
参考<a href="https://www.cnblogs.com/sk777/p/16831556.html">解决ffmpeg的播放摄像头的延时优化问题(项目案例使用有效)</a></p>
<p>
原参数：</p>
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">-vcodec libx264,
</span></span><span class="line"><span class="cl">-r 25,
</span></span><span class="line"><span class="cl">-video_size 1280x720,</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
优化参数1：</p>
<p>
-tune zerolatency  <em>/设置零延时
-preset ultrafast  /</em>–preset的参数主要调节编码速度和质量的平衡，有ultrafast（转码速度最快，视频往往也最模糊）、superfast、veryfast、faster、fast、medium、slow、slower、veryslow、placebo这10个选项，从快到慢</p>
<p>
优化参数2：</p>
<div class="src src-text">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">-threads 4,
</span></span><span class="line"><span class="cl">-c:a copy,
</span></span><span class="line"><span class="cl">-fflags nobuffer,
</span></span><span class="line"><span class="cl">-max_delay 1,
</span></span><span class="line"><span class="cl">-vprofile baseline,
</span></span><span class="line"><span class="cl">-rtsp_transport tcp,
</span></span><span class="line"><span class="cl">-crf 30,
</span></span><span class="line"><span class="cl">-vsync 2,
</span></span><span class="line"><span class="cl">-f flv</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
ffmpeg完整命令如下：</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;Integrated Camera&#34;</span> -vcodec libx264 -r <span class="m">25</span> -video_size 640x480 -tune:v zerolatency -preset:v ultrafast -threads <span class="m">4</span> -c:a copy -fflags nobuffer -max_delay <span class="m">1</span> -rtsp_transport tcp -crf <span class="m">30</span> -vsync <span class="m">2</span> -f flv -f rtsp rtsp://127.0.0.1:8554/camera_test</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-269" class="outline-6">
<h6 id="headline-269">
可能原因3：tcp连接导致延迟高
</h6>
<div id="outline-text-headline-269" class="outline-text-6">
<p>
参考<a href="https://github.com/aler9/rtsp-simple-server/issues/902">RTSP end to end latency will be increasing when use tcp #902</a></p>
<p>
ffmpeg在通过rtsp实现推流时默认是遵循tcp协议的，目的是为了保证消息可靠传输。对于实时音视频通信，如果要想实现低延迟，要么增加带宽，要么使用UDP进行传输。</p>
</div>
</div>
<div id="outline-container-headline-270" class="outline-6">
<h6 id="headline-270">
原因4：逐帧读取时需要逐帧解码，导致输入和输出速率不匹配导致延迟高（有效 - 抽帧读取）
</h6>
<div id="outline-text-headline-270" class="outline-text-6">
<p>
解决方法：对于读客户端，采用抽帧读取的方法来解决。如果采用逐帧读取并完成解码的方式，会让写客户端不停地推流，而读客户端来不及解码导致缓存区拥塞。</p>
<p>
参考<a href="http://www.yaotu.net/biancheng/21985.html">Opencv—视频跳帧处理，OpenCV笔记：cv2.VideoCapture 完成视频的跳帧输出操作</a></p>
<p>
ffmpeg写客户端命令无需修改：</p>
<p>
//获取本地摄像头名称</p>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -list_devices <span class="nb">true</span> -f dshow -i dummy</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<div class="src src-bash">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  ffmpeg -f dshow -i <span class="nv">video</span><span class="o">=</span><span class="s2">&#34;Integrated Camera&#34;</span> -vcodec libx264 -r <span class="m">25</span> -video_size 640x480 -tune:v zerolatency -preset:v ultrafast -threads <span class="m">4</span> -c:a copy -fflags nobuffer -max_delay <span class="m">1</span> -rtsp_transport tcp -crf <span class="m">30</span> -vsync <span class="m">2</span> -f flv -f rtsp rtsp://127.0.0.1:8554/camera_test</span></span></code></pre></td></tr></table>
</div>
</div>
</div>
<p>
python读客户端代码修改如下：</p>
<div class="src src-python">
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">capture_video</span><span class="p">(</span><span class="n">rtsp_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">rtsp_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">capture</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">rtsp_path</span><span class="p">)</span>  <span class="c1">#不用带cv2.CAP_DSHOW</span>
</span></span><span class="line"><span class="cl">    <span class="n">now_fps</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">capture</span><span class="o">.</span><span class="n">isOpened</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 设置每 10 帧输出一次</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">now_fps</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">now_fps</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 跳帧，仅获取帧但不做解码处理</span>
</span></span><span class="line"><span class="cl">            <span class="n">ret</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">grab</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">now_fps</span> <span class="o">+=</span> <span class="mi">1</span></span></span></code></pre></td></tr></table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-271" class="outline-3">
<h3 id="headline-271">
参考链接
</h3>
<div id="outline-text-headline-271" class="outline-text-3">
<p>
<a href="https://blog.csdn.net/qq_33934427/article/details/128009659">RTSP 和 RTMP原理 &amp; 通过ffmpeg实现将本地摄像头推流到RTSP服务器</a></p>
<p>
<a href="https://blog.csdn.net/zhying719/article/details/107421180">FFMpeg 实现视频编码、解码</a></p>
</div>
</div>
</div>
</div>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/tools/">Tools</a>
        
            <a href="/tags/ffmpeg/">Ffmpeg</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2025 Example Person
    </section>
    
    <section class="powerby">
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
